[0m01:05:59.630264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080091c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b4550>]}


============================== 01:05:59.635136 | fefd9357-4d44-4149-8022-546c8ed0ff5d ==============================
[0m01:05:59.635136 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m01:05:59.635779 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt deps --profiles-dir .', 'log_path': '/Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '.', 'static_parser': 'True', 'debug': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'log_cache_events': 'False'}
[0m01:05:59.807357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fefd9357-4d44-4149-8022-546c8ed0ff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109052c10>]}
[0m01:05:59.831017 [debug] [MainThread]: Set downloads directory='/var/folders/9d/rc17811j07v56khq2t9t7h5m0000gn/T/dbt-downloads-mleyv5ub'
[0m01:05:59.831749 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:06:01.492789 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:06:01.496227 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:06:02.018442 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:06:02.042137 [info ] [MainThread]: Updating lock file in file path: /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/package-lock.yml
[0m01:06:02.045860 [debug] [MainThread]: Set downloads directory='/var/folders/9d/rc17811j07v56khq2t9t7h5m0000gn/T/dbt-downloads-ue46hi39'
[0m01:06:02.050238 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:06:03.389829 [info ] [MainThread]: Installed from version 1.3.3
[0m01:06:03.390243 [info ] [MainThread]: Up to date!
[0m01:06:03.390578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fefd9357-4d44-4149-8022-546c8ed0ff5d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108355490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f5520>]}
[0m01:06:03.394315 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.8565874, "process_in_blocks": "0", "process_kernel_time": 0.338916, "process_mem_max_rss": "109871104", "process_out_blocks": "0", "process_user_time": 1.579328}
[0m01:06:03.394797 [debug] [MainThread]: Command `dbt deps` succeeded at 01:06:03.394692 after 3.86 seconds
[0m01:06:03.395155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080091c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f91c0>]}
[0m01:06:03.395505 [debug] [MainThread]: Flushing usage events
[0m01:06:04.354690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:20.888140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108527280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d58e0>]}


============================== 01:06:20.892560 | 03de8623-a0e7-4c37-a26d-a64f6646a864 ==============================
[0m01:06:20.892560 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m01:06:20.893332 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt seed --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/logs', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'None', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '.'}
[0m01:06:21.513673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa52d00>]}
[0m01:06:21.587603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa90760>]}
[0m01:06:21.588900 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:06:21.724839 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m01:06:21.725673 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:06:21.726034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6910a0>]}
[0m01:06:23.560378 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_positions' in
package 'bain_capital_analytics' (models/staging/_staging.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m01:06:23.560929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba422b0>]}
[0m01:06:23.785970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb0b280>]}
[0m01:06:23.919201 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/manifest.json
[0m01:06:23.921876 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/semantic_manifest.json
[0m01:06:23.946287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bce7f40>]}
[0m01:06:23.946895 [info ] [MainThread]: Found 28 models, 53 data tests, 10 seeds, 614 macros
[0m01:06:23.947236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bca8ac0>]}
[0m01:06:23.949943 [info ] [MainThread]: 
[0m01:06:23.950294 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:06:23.950558 [info ] [MainThread]: 
[0m01:06:23.951041 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:06:23.956668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO'
[0m01:06:24.032017 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO"
[0m01:06:24.032442 [debug] [ThreadPool]: On list_DBT_DEMO: show terse schemas in database DBT_DEMO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "connection_name": "list_DBT_DEMO"} */
[0m01:06:24.032726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:28.731941 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 4.699 seconds
[0m01:06:28.739904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEMO, now list_DBT_DEMO_DEV_raw)
[0m01:06:28.740699 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO_DEV'
[0m01:06:28.756244 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV_raw"
[0m01:06:28.760389 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV"
[0m01:06:28.760798 [debug] [ThreadPool]: On list_DBT_DEMO_DEV_raw: show objects in DBT_DEMO.DEV_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV_raw"} */;
[0m01:06:28.761096 [debug] [ThreadPool]: On list_DBT_DEMO_DEV: show objects in DBT_DEMO.DEV
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV"} */;
[0m01:06:28.761508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:29.167252 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.406 seconds
[0m01:06:34.762642 [debug] [ThreadPool]: SQL status: SUCCESS 45 in 6.001 seconds
[0m01:06:34.775430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd3bf10>]}
[0m01:06:34.780553 [debug] [Thread-1  ]: Began running node seed.bain_capital_analytics.raw_benchmarks
[0m01:06:34.781172 [debug] [Thread-2  ]: Began running node seed.bain_capital_analytics.raw_cashflows
[0m01:06:34.781630 [debug] [Thread-3  ]: Began running node seed.bain_capital_analytics.raw_counterparties
[0m01:06:34.782011 [debug] [Thread-4  ]: Began running node seed.bain_capital_analytics.raw_dates
[0m01:06:34.782524 [info ] [Thread-1  ]: 1 of 10 START seed file DEV_raw.raw_benchmarks ................................. [RUN]
[0m01:06:34.783156 [info ] [Thread-2  ]: 2 of 10 START seed file DEV_raw.raw_cashflows .................................. [RUN]
[0m01:06:34.783762 [info ] [Thread-3  ]: 3 of 10 START seed file DEV_raw.raw_counterparties ............................. [RUN]
[0m01:06:34.784278 [info ] [Thread-4  ]: 4 of 10 START seed file DEV_raw.raw_dates ...................................... [RUN]
[0m01:06:34.784776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV_raw, now seed.bain_capital_analytics.raw_benchmarks)
[0m01:06:34.785190 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV, now seed.bain_capital_analytics.raw_cashflows)
[0m01:06:34.785843 [debug] [Thread-3  ]: Acquiring new snowflake connection 'seed.bain_capital_analytics.raw_counterparties'
[0m01:06:34.786326 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.bain_capital_analytics.raw_dates'
[0m01:06:34.786725 [debug] [Thread-1  ]: Began compiling node seed.bain_capital_analytics.raw_benchmarks
[0m01:06:34.787076 [debug] [Thread-2  ]: Began compiling node seed.bain_capital_analytics.raw_cashflows
[0m01:06:34.787378 [debug] [Thread-3  ]: Began compiling node seed.bain_capital_analytics.raw_counterparties
[0m01:06:34.787702 [debug] [Thread-4  ]: Began compiling node seed.bain_capital_analytics.raw_dates
[0m01:06:34.788016 [debug] [Thread-1  ]: Began executing node seed.bain_capital_analytics.raw_benchmarks
[0m01:06:34.788334 [debug] [Thread-2  ]: Began executing node seed.bain_capital_analytics.raw_cashflows
[0m01:06:34.788639 [debug] [Thread-3  ]: Began executing node seed.bain_capital_analytics.raw_counterparties
[0m01:06:34.788935 [debug] [Thread-4  ]: Began executing node seed.bain_capital_analytics.raw_dates
[0m01:06:34.844881 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:06:34.846798 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:06:34.850261 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:06:34.850609 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m01:06:34.853837 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:06:34.854176 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m01:06:34.854493 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m01:06:34.854791 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:06:34.855097 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m01:06:34.855501 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:06:35.047580 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.191 seconds
[0m01:06:35.048092 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:06:35.048427 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: truncate table "DBT_DEMO"."DEV_RAW"."RAW_CASHFLOWS"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */;
[0m01:06:35.159603 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.304 seconds
[0m01:06:35.160125 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:06:35.160478 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: truncate table "DBT_DEMO"."DEV_RAW"."RAW_BENCHMARKS"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */;
[0m01:06:35.638672 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.783 seconds
[0m01:06:35.640347 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:06:35.641175 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: truncate table "DBT_DEMO"."DEV_RAW"."RAW_COUNTERPARTIES"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */;
[0m01:06:35.847553 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.798 seconds
[0m01:06:35.848996 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:06:35.849610 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m01:06:35.946097 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.785 seconds
[0m01:06:35.947244 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:06:35.947772 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m01:06:36.155581 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.305 seconds
[0m01:06:36.175824 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:06:36.176412 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m01:06:36.228939 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.374 seconds
[0m01:06:36.229778 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:06:36.230196 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: truncate table "DBT_DEMO"."DEV_RAW"."RAW_DATES"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */;
[0m01:06:36.234622 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.286 seconds
[0m01:06:36.237958 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:06:36.238543 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m01:06:36.241064 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.599 seconds
[0m01:06:36.241622 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:06:36.242078 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m01:06:36.371969 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.195 seconds
[0m01:06:36.374674 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:06:36.375246 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: insert into DBT_DEMO.DEV_raw.raw_cashflows (cashflow_id, fund_id, portfolio_id, cashflow_date, cashflow_type, amount, currency, description, investor_id) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%...
[0m01:06:36.429802 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.191 seconds
[0m01:06:36.432407 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:06:36.433065 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: insert into DBT_DEMO.DEV_raw.raw_benchmarks (benchmark_id, benchmark_name, benchmark_date, return_daily, return_mtd, return_ytd, benchmark_level) values
            (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m01:06:36.553306 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.310 seconds
[0m01:06:36.557079 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:06:36.557665 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m01:06:36.741333 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.183 seconds
[0m01:06:36.743413 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:06:36.744171 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: insert into DBT_DEMO.DEV_raw.raw_counterparties (counterparty_id, counterparty_name, counterparty_type, country, credit_rating, is_active) values
            (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analy...
[0m01:06:36.876004 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.645 seconds
[0m01:06:36.877441 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:06:36.878136 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m01:06:37.160563 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.282 seconds
[0m01:06:37.164223 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:06:37.164808 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m01:06:37.357826 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.192 seconds
[0m01:06:37.360014 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:06:37.360756 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: insert into DBT_DEMO.DEV_raw.raw_dates (date_day, is_business_day, is_month_end, is_quarter_end, is_year_end, fiscal_quarter, fiscal_year) values
            (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s)
/* {"app"...
[0m01:06:37.855537 [debug] [Thread-3  ]: SQL status: SUCCESS 10 in 1.111 seconds
[0m01:06:37.856922 [debug] [Thread-2  ]: SQL status: SUCCESS 25 in 1.481 seconds
[0m01:06:37.858000 [debug] [Thread-1  ]: SQL status: SUCCESS 30 in 1.424 seconds
[0m01:06:37.858776 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:06:37.859378 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:06:37.860299 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:06:37.860931 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m01:06:37.861420 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m01:06:37.862043 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m01:06:38.157392 [debug] [Thread-4  ]: SQL status: SUCCESS 15 in 0.796 seconds
[0m01:06:38.158679 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:06:38.159463 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m01:06:38.170692 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.307 seconds
[0m01:06:38.179614 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_benchmarks"
[0m01:06:38.203172 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e8edc0>]}
[0m01:06:38.203792 [info ] [Thread-1  ]: 1 of 10 OK loaded seed file DEV_raw.raw_benchmarks ............................. [[32mINSERT 30[0m in 3.42s]
[0m01:06:38.204303 [debug] [Thread-1  ]: Finished running node seed.bain_capital_analytics.raw_benchmarks
[0m01:06:38.204672 [debug] [Thread-1  ]: Began running node seed.bain_capital_analytics.raw_fund_structures
[0m01:06:38.205211 [info ] [Thread-1  ]: 5 of 10 START seed file DEV_raw.raw_fund_structures ............................ [RUN]
[0m01:06:38.205666 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_benchmarks, now seed.bain_capital_analytics.raw_fund_structures)
[0m01:06:38.206003 [debug] [Thread-1  ]: Began compiling node seed.bain_capital_analytics.raw_fund_structures
[0m01:06:38.206315 [debug] [Thread-1  ]: Began executing node seed.bain_capital_analytics.raw_fund_structures
[0m01:06:38.212975 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:06:38.213447 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m01:06:38.214972 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.352 seconds
[0m01:06:38.215531 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_counterparties"
[0m01:06:38.219505 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11206f220>]}
[0m01:06:38.220275 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file DEV_raw.raw_counterparties ......................... [[32mINSERT 10[0m in 3.43s]
[0m01:06:38.221263 [debug] [Thread-3  ]: Finished running node seed.bain_capital_analytics.raw_counterparties
[0m01:06:38.221679 [debug] [Thread-3  ]: Began running node seed.bain_capital_analytics.raw_instruments
[0m01:06:38.222398 [info ] [Thread-3  ]: 6 of 10 START seed file DEV_raw.raw_instruments ................................ [RUN]
[0m01:06:38.222872 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_counterparties, now seed.bain_capital_analytics.raw_instruments)
[0m01:06:38.223357 [debug] [Thread-3  ]: Began compiling node seed.bain_capital_analytics.raw_instruments
[0m01:06:38.223755 [debug] [Thread-3  ]: Began executing node seed.bain_capital_analytics.raw_instruments
[0m01:06:38.232837 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:06:38.233321 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_instruments: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m01:06:38.234100 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.371 seconds
[0m01:06:38.234735 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_cashflows"
[0m01:06:38.237634 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e83730>]}
[0m01:06:38.238246 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file DEV_raw.raw_cashflows .............................. [[32mINSERT 25[0m in 3.45s]
[0m01:06:38.238773 [debug] [Thread-2  ]: Finished running node seed.bain_capital_analytics.raw_cashflows
[0m01:06:38.239161 [debug] [Thread-2  ]: Began running node seed.bain_capital_analytics.raw_portfolios
[0m01:06:38.239743 [info ] [Thread-2  ]: 7 of 10 START seed file DEV_raw.raw_portfolios ................................. [RUN]
[0m01:06:38.240155 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_cashflows, now seed.bain_capital_analytics.raw_portfolios)
[0m01:06:38.240616 [debug] [Thread-2  ]: Began compiling node seed.bain_capital_analytics.raw_portfolios
[0m01:06:38.241050 [debug] [Thread-2  ]: Began executing node seed.bain_capital_analytics.raw_portfolios
[0m01:06:38.248621 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:06:38.249096 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_portfolios: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m01:06:38.403318 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.189 seconds
[0m01:06:38.403966 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:06:38.404398 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: truncate table "DBT_DEMO"."DEV_RAW"."RAW_FUND_STRUCTURES"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */;
[0m01:06:38.419343 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.185 seconds
[0m01:06:38.419828 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:06:38.420231 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_instruments: truncate table "DBT_DEMO"."DEV_RAW"."RAW_INSTRUMENTS"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */;
[0m01:06:38.444091 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.194 seconds
[0m01:06:38.444909 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:06:38.445480 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_portfolios: truncate table "DBT_DEMO"."DEV_RAW"."RAW_PORTFOLIOS"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */;
[0m01:06:38.464035 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.304 seconds
[0m01:06:38.465320 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_dates"
[0m01:06:38.468962 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112144e20>]}
[0m01:06:38.469633 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file DEV_raw.raw_dates .................................. [[32mINSERT 15[0m in 3.68s]
[0m01:06:38.470252 [debug] [Thread-4  ]: Finished running node seed.bain_capital_analytics.raw_dates
[0m01:06:38.470740 [debug] [Thread-4  ]: Began running node seed.bain_capital_analytics.raw_positions
[0m01:06:38.471438 [info ] [Thread-4  ]: 8 of 10 START seed file DEV_raw.raw_positions .................................. [RUN]
[0m01:06:38.471893 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_dates, now seed.bain_capital_analytics.raw_positions)
[0m01:06:38.472224 [debug] [Thread-4  ]: Began compiling node seed.bain_capital_analytics.raw_positions
[0m01:06:38.472544 [debug] [Thread-4  ]: Began executing node seed.bain_capital_analytics.raw_positions
[0m01:06:38.481107 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:06:38.481545 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_positions: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m01:06:38.662602 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.181 seconds
[0m01:06:38.663736 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:06:38.664370 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_positions: truncate table "DBT_DEMO"."DEV_RAW"."RAW_POSITIONS"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */;
[0m01:06:38.913194 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.492 seconds
[0m01:06:38.914477 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:06:38.915009 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_instruments: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m01:06:38.952620 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.548 seconds
[0m01:06:38.953845 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:06:38.954355 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m01:06:39.063363 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.617 seconds
[0m01:06:39.064603 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:06:39.065140 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_portfolios: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m01:06:39.227372 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.312 seconds
[0m01:06:39.230583 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:06:39.231356 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_instruments: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m01:06:39.256239 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.591 seconds
[0m01:06:39.257243 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:06:39.257683 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_positions: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m01:06:39.272460 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.317 seconds
[0m01:06:39.275124 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:06:39.275739 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m01:06:39.373570 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.308 seconds
[0m01:06:39.376901 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:06:39.377695 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_portfolios: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m01:06:39.409372 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.177 seconds
[0m01:06:39.411538 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:06:39.412128 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_instruments: insert into DBT_DEMO.DEV_raw.raw_instruments (instrument_id, instrument_name, instrument_type, sector, currency, exchange, issuer, maturity_date) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s...
[0m01:06:39.487297 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.211 seconds
[0m01:06:39.488974 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:06:39.489502 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: insert into DBT_DEMO.DEV_raw.raw_fund_structures (fund_id, fund_name, fund_type, vintage_year, committed_capital, management_fee_rate, carry_rate, hurdle_rate, gp_commitment_pct, fund_currency, fund_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} ...
[0m01:06:39.570804 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.192 seconds
[0m01:06:39.573407 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:06:39.574251 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_portfolios: insert into DBT_DEMO.DEV_raw.raw_portfolios (portfolio_id, portfolio_name, strategy, inception_date, fund_id, manager_name, is_active) values
            (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */...
[0m01:06:39.591574 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.333 seconds
[0m01:06:39.594586 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:06:39.595107 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_positions: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m01:06:39.797349 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.202 seconds
[0m01:06:39.798856 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:06:39.799225 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_positions: insert into DBT_DEMO.DEV_raw.raw_positions (position_id, portfolio_id, instrument_id, position_date, quantity, market_value, cost_basis, currency) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%...
[0m01:06:39.953417 [debug] [Thread-3  ]: SQL status: SUCCESS 20 in 0.541 seconds
[0m01:06:39.954901 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:06:39.955502 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_instruments: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m01:06:40.270077 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.314 seconds
[0m01:06:40.272036 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_instruments"
[0m01:06:40.276232 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112042b50>]}
[0m01:06:40.277304 [info ] [Thread-3  ]: 6 of 10 OK loaded seed file DEV_raw.raw_instruments ............................ [[32mINSERT 20[0m in 2.05s]
[0m01:06:40.278215 [debug] [Thread-3  ]: Finished running node seed.bain_capital_analytics.raw_instruments
[0m01:06:40.278826 [debug] [Thread-3  ]: Began running node seed.bain_capital_analytics.raw_trades
[0m01:06:40.279756 [info ] [Thread-3  ]: 9 of 10 START seed file DEV_raw.raw_trades ..................................... [RUN]
[0m01:06:40.280605 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_instruments, now seed.bain_capital_analytics.raw_trades)
[0m01:06:40.281853 [debug] [Thread-3  ]: Began compiling node seed.bain_capital_analytics.raw_trades
[0m01:06:40.282284 [debug] [Thread-3  ]: Began executing node seed.bain_capital_analytics.raw_trades
[0m01:06:40.295601 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:06:40.296097 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_trades: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m01:06:40.494247 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0.919 seconds
[0m01:06:40.496347 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:06:40.496869 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_portfolios: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m01:06:40.497956 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.201 seconds
[0m01:06:40.498683 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:06:40.499134 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_trades: truncate table "DBT_DEMO"."DEV_RAW"."RAW_TRADES"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */;
[0m01:06:40.556847 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 1.067 seconds
[0m01:06:40.558133 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:06:40.558775 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m01:06:40.573347 [debug] [Thread-4  ]: SQL status: SUCCESS 30 in 0.774 seconds
[0m01:06:40.574511 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:06:40.575041 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_positions: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m01:06:40.810255 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.313 seconds
[0m01:06:40.812362 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_portfolios"
[0m01:06:40.817134 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e83730>]}
[0m01:06:40.818125 [info ] [Thread-2  ]: 7 of 10 OK loaded seed file DEV_raw.raw_portfolios ............................. [[32mINSERT 5[0m in 2.58s]
[0m01:06:40.818938 [debug] [Thread-2  ]: Finished running node seed.bain_capital_analytics.raw_portfolios
[0m01:06:40.819511 [debug] [Thread-2  ]: Began running node seed.bain_capital_analytics.raw_valuations
[0m01:06:40.820347 [info ] [Thread-2  ]: 10 of 10 START seed file DEV_raw.raw_valuations ................................ [RUN]
[0m01:06:40.820919 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_portfolios, now seed.bain_capital_analytics.raw_valuations)
[0m01:06:40.821330 [debug] [Thread-2  ]: Began compiling node seed.bain_capital_analytics.raw_valuations
[0m01:06:40.821719 [debug] [Thread-2  ]: Began executing node seed.bain_capital_analytics.raw_valuations
[0m01:06:40.833110 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:06:40.833676 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m01:06:40.869727 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.294 seconds
[0m01:06:40.870826 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.311 seconds
[0m01:06:40.871640 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_positions"
[0m01:06:40.872279 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_fund_structures"
[0m01:06:40.875108 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf16c70>]}
[0m01:06:40.877091 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112144e20>]}
[0m01:06:40.877543 [info ] [Thread-1  ]: 5 of 10 OK loaded seed file DEV_raw.raw_fund_structures ........................ [[32mINSERT 3[0m in 2.67s]
[0m01:06:40.878062 [info ] [Thread-4  ]: 8 of 10 OK loaded seed file DEV_raw.raw_positions .............................. [[32mINSERT 30[0m in 2.41s]
[0m01:06:40.878551 [debug] [Thread-1  ]: Finished running node seed.bain_capital_analytics.raw_fund_structures
[0m01:06:40.878976 [debug] [Thread-4  ]: Finished running node seed.bain_capital_analytics.raw_positions
[0m01:06:41.049771 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.215 seconds
[0m01:06:41.051213 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.552 seconds
[0m01:06:41.052019 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:06:41.052762 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:06:41.053285 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: truncate table "DBT_DEMO"."DEV_RAW"."RAW_VALUATIONS"
  
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */;
[0m01:06:41.053804 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_trades: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m01:06:41.377352 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.323 seconds
[0m01:06:41.383018 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:06:41.383866 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_trades: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m01:06:41.610955 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.226 seconds
[0m01:06:41.613049 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.559 seconds
[0m01:06:41.616252 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:06:41.616937 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:06:41.617466 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_trades: insert into DBT_DEMO.DEV_raw.raw_trades (trade_id, portfolio_id, instrument_id, counterparty_id, trade_date, settlement_date, trade_type, quantity, price, notional_amount, commission, currency, status) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m01:06:41.617973 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m01:06:41.932548 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.312 seconds
[0m01:06:41.937033 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:06:41.937748 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m01:06:42.212253 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.274 seconds
[0m01:06:42.214514 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:06:42.215046 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: insert into DBT_DEMO.DEV_raw.raw_valuations (valuation_id, portfolio_id, valuation_date, gross_asset_value, net_asset_value, total_liabilities, unrealized_pnl, realized_pnl, valuation_method) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m01:06:42.219709 [debug] [Thread-3  ]: SQL status: SUCCESS 30 in 0.601 seconds
[0m01:06:42.220739 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:06:42.221572 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_trades: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m01:06:42.546947 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.324 seconds
[0m01:06:42.548643 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_trades"
[0m01:06:42.553050 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d4c40>]}
[0m01:06:42.554018 [info ] [Thread-3  ]: 9 of 10 OK loaded seed file DEV_raw.raw_trades ................................. [[32mINSERT 30[0m in 2.27s]
[0m01:06:42.554836 [debug] [Thread-3  ]: Finished running node seed.bain_capital_analytics.raw_trades
[0m01:06:42.972936 [debug] [Thread-2  ]: SQL status: SUCCESS 21 in 0.757 seconds
[0m01:06:42.974093 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:06:42.974652 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m01:06:43.287403 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.312 seconds
[0m01:06:43.289112 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_valuations"
[0m01:06:43.293386 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03de8623-a0e7-4c37-a26d-a64f6646a864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e83730>]}
[0m01:06:43.294323 [info ] [Thread-2  ]: 10 of 10 OK loaded seed file DEV_raw.raw_valuations ............................ [[32mINSERT 21[0m in 2.47s]
[0m01:06:43.295103 [debug] [Thread-2  ]: Finished running node seed.bain_capital_analytics.raw_valuations
[0m01:06:43.296904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:43.297302 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_fund_structures' was left open.
[0m01:06:43.297657 [debug] [MainThread]: On seed.bain_capital_analytics.raw_fund_structures: Close
[0m01:06:43.655766 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_valuations' was left open.
[0m01:06:43.656712 [debug] [MainThread]: On seed.bain_capital_analytics.raw_valuations: Close
[0m01:06:43.964199 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_trades' was left open.
[0m01:06:43.965107 [debug] [MainThread]: On seed.bain_capital_analytics.raw_trades: Close
[0m01:06:44.813391 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_positions' was left open.
[0m01:06:44.813830 [debug] [MainThread]: On seed.bain_capital_analytics.raw_positions: Close
[0m01:06:45.123529 [info ] [MainThread]: 
[0m01:06:45.124494 [info ] [MainThread]: Finished running 10 seeds in 0 hours 0 minutes and 21.17 seconds (21.17s).
[0m01:06:45.127410 [debug] [MainThread]: Command end result
[0m01:06:45.177369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/manifest.json
[0m01:06:45.179441 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/semantic_manifest.json
[0m01:06:45.185706 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/run_results.json
[0m01:06:45.186016 [info ] [MainThread]: 
[0m01:06:45.186380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:06:45.186681 [info ] [MainThread]: 
[0m01:06:45.186974 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m01:06:45.187438 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:06:45.189817 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 24.38765, "process_in_blocks": "0", "process_kernel_time": 0.619308, "process_mem_max_rss": "196673536", "process_out_blocks": "0", "process_user_time": 5.515967}
[0m01:06:45.190165 [debug] [MainThread]: Command `dbt seed` succeeded at 01:06:45.190095 after 24.39 seconds
[0m01:06:45.190482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108527280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a65e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be71c40>]}
[0m01:06:45.190808 [debug] [MainThread]: Flushing usage events
[0m01:06:46.312042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:07:04.446927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf729a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf727c0>]}


============================== 01:07:04.451656 | 09509d6f-2ec2-48e2-bef7-1c199140b742 ==============================
[0m01:07:04.451656 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m01:07:04.452201 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'profiles_dir': '.', 'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_path': '/Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/logs', 'quiet': 'False', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m01:07:05.048405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3dc820>]}
[0m01:07:05.125676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e492220>]}
[0m01:07:05.127304 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:07:05.262549 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m01:07:05.455616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:07:05.456074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:07:05.520367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f516130>]}
[0m01:07:05.705400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/manifest.json
[0m01:07:05.707542 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/semantic_manifest.json
[0m01:07:05.731131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3eeb20>]}
[0m01:07:05.731763 [info ] [MainThread]: Found 28 models, 53 data tests, 10 seeds, 614 macros
[0m01:07:05.732104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf07550>]}
[0m01:07:05.734919 [info ] [MainThread]: 
[0m01:07:05.735243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:07:05.735501 [info ] [MainThread]: 
[0m01:07:05.735969 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:07:05.742475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO'
[0m01:07:05.803518 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO"
[0m01:07:05.804017 [debug] [ThreadPool]: On list_DBT_DEMO: show terse schemas in database DBT_DEMO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "connection_name": "list_DBT_DEMO"} */
[0m01:07:05.804304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:10.417077 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 4.613 seconds
[0m01:07:10.425430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEMO, now list_DBT_DEMO_DEV)
[0m01:07:10.426362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO_DEV_raw'
[0m01:07:10.448929 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV"
[0m01:07:10.452137 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV_raw"
[0m01:07:10.452517 [debug] [ThreadPool]: On list_DBT_DEMO_DEV: show objects in DBT_DEMO.DEV
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV"} */;
[0m01:07:10.452821 [debug] [ThreadPool]: On list_DBT_DEMO_DEV_raw: show objects in DBT_DEMO.DEV_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV_raw"} */;
[0m01:07:10.453232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:10.694325 [debug] [ThreadPool]: SQL status: SUCCESS 45 in 0.241 seconds
[0m01:07:14.102020 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 3.649 seconds
[0m01:07:14.107998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf412b0>]}
[0m01:07:14.113688 [debug] [Thread-1  ]: Began running node model.bain_capital_analytics.stg_benchmarks
[0m01:07:14.114465 [debug] [Thread-2  ]: Began running node model.bain_capital_analytics.stg_cashflows
[0m01:07:14.114932 [debug] [Thread-3  ]: Began running node model.bain_capital_analytics.stg_counterparties
[0m01:07:14.116122 [debug] [Thread-4  ]: Began running node model.bain_capital_analytics.stg_dates
[0m01:07:14.116594 [info ] [Thread-1  ]: 1 of 28 START sql view model DEV.stg_benchmarks ................................ [RUN]
[0m01:07:14.117156 [info ] [Thread-2  ]: 2 of 28 START sql view model DEV.stg_cashflows ................................. [RUN]
[0m01:07:14.118113 [info ] [Thread-3  ]: 3 of 28 START sql view model DEV.stg_counterparties ............................ [RUN]
[0m01:07:14.118844 [info ] [Thread-4  ]: 4 of 28 START sql view model DEV.stg_dates ..................................... [RUN]
[0m01:07:14.119546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV, now model.bain_capital_analytics.stg_benchmarks)
[0m01:07:14.120088 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV_raw, now model.bain_capital_analytics.stg_cashflows)
[0m01:07:14.120714 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.bain_capital_analytics.stg_counterparties'
[0m01:07:14.121269 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.bain_capital_analytics.stg_dates'
[0m01:07:14.121659 [debug] [Thread-1  ]: Began compiling node model.bain_capital_analytics.stg_benchmarks
[0m01:07:14.122030 [debug] [Thread-2  ]: Began compiling node model.bain_capital_analytics.stg_cashflows
[0m01:07:14.122412 [debug] [Thread-3  ]: Began compiling node model.bain_capital_analytics.stg_counterparties
[0m01:07:14.122769 [debug] [Thread-4  ]: Began compiling node model.bain_capital_analytics.stg_dates
[0m01:07:14.131996 [debug] [Thread-1  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_benchmarks"
[0m01:07:14.134939 [debug] [Thread-2  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_cashflows"
[0m01:07:14.137923 [debug] [Thread-3  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_counterparties"
[0m01:07:14.140564 [debug] [Thread-4  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_dates"
[0m01:07:14.142002 [debug] [Thread-2  ]: Began executing node model.bain_capital_analytics.stg_cashflows
[0m01:07:14.148147 [debug] [Thread-3  ]: Began executing node model.bain_capital_analytics.stg_counterparties
[0m01:07:14.153941 [debug] [Thread-1  ]: Began executing node model.bain_capital_analytics.stg_benchmarks
[0m01:07:14.154308 [debug] [Thread-4  ]: Began executing node model.bain_capital_analytics.stg_dates
[0m01:07:14.196219 [debug] [Thread-1  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_benchmarks"
[0m01:07:14.199467 [debug] [Thread-4  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_dates"
[0m01:07:14.203053 [debug] [Thread-3  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_counterparties"
[0m01:07:14.195985 [debug] [Thread-2  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_cashflows"
[0m01:07:14.205371 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.stg_benchmarks"
[0m01:07:14.206149 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.stg_counterparties"
[0m01:07:14.207179 [debug] [Thread-4  ]: Using snowflake connection "model.bain_capital_analytics.stg_dates"
[0m01:07:14.207532 [debug] [Thread-1  ]: On model.bain_capital_analytics.stg_benchmarks: create or replace   view DBT_DEMO.DEV.stg_benchmarks
  
  
  
  
  as (
    select distinct
    benchmark_id,
    benchmark_name,
    cast(benchmark_date as date) as benchmark_date,
    cast(return_daily as numeric(18,8)) as return_daily,
    cast(return_mtd as numeric(18,8)) as return_mtd,
    cast(return_ytd as numeric(18,8)) as return_ytd,
    cast(benchmark_level as numeric(18,4)) as benchmark_level,
    -- Anti-pattern: duplicated fiscal quarter logic
    case
        when extract(month from cast(benchmark_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(benchmark_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(benchmark_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(benchmark_date as date)) between 10 and 12 then 'Q2'
    end as benchmark_fiscal_quarter
from DBT_DEMO.DEV_raw.raw_benchmarks
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_benchmarks"} */;
[0m01:07:14.208619 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.stg_cashflows"
[0m01:07:14.208972 [debug] [Thread-3  ]: On model.bain_capital_analytics.stg_counterparties: create or replace   view DBT_DEMO.DEV.stg_counterparties
  
  
  
  
  as (
    select distinct
    counterparty_id,
    counterparty_name,
    counterparty_type,
    country,
    credit_rating,
    cast(is_active as boolean) as is_active
from DBT_DEMO.DEV_raw.raw_counterparties
where cast(is_active as boolean) = TRUE
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_counterparties"} */;
[0m01:07:14.209473 [debug] [Thread-4  ]: On model.bain_capital_analytics.stg_dates: create or replace   view DBT_DEMO.DEV.stg_dates
  
  
  
  
  as (
    select
    cast(date_day as date) as date_day,
    cast(is_business_day as boolean) as is_business_day,
    cast(is_month_end as boolean) as is_month_end,
    cast(is_quarter_end as boolean) as is_quarter_end,
    cast(is_year_end as boolean) as is_year_end,
    fiscal_quarter,
    fiscal_year,
    -- Anti-pattern: PostgreSQL-specific date_trunc
    date_trunc('month', cast(date_day as date)) as month_start,
    date_trunc('quarter', cast(date_day as date)) as quarter_start,
    extract(month from cast(date_day as date)) as calendar_month,
    extract(year from cast(date_day as date)) as calendar_year
from DBT_DEMO.DEV_raw.raw_dates
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_dates"} */;
[0m01:07:14.210360 [debug] [Thread-2  ]: On model.bain_capital_analytics.stg_cashflows: create or replace   view DBT_DEMO.DEV.stg_cashflows
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT
-- Anti-pattern: duplicated fiscal quarter logic
select distinct
    cashflow_id,
    fund_id,
    portfolio_id,
    cast(cashflow_date as date) as cashflow_date,
    cashflow_type,
    cast(amount as numeric(18,2)) as amount,
    currency,
    description,
    investor_id,
    -- Anti-pattern: duplicated fiscal quarter logic (same as stg_trades, stg_portfolios)
    case
        when extract(month from cast(cashflow_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(cashflow_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(cashflow_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(cashflow_date as date)) between 10 and 12 then 'Q2'
    end as cashflow_fiscal_quarter,
    -- Anti-pattern: PostgreSQL-specific extract
    extract(year from cast(cashflow_date as date)) as cashflow_year
from DBT_DEMO.DEV_raw.raw_cashflows
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_cashflows"} */;
[0m01:07:14.211014 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:07:14.211709 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:07:14.565592 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.355 seconds
[0m01:07:14.588658 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115590820>]}
[0m01:07:14.589292 [info ] [Thread-1  ]: 1 of 28 OK created sql view model DEV.stg_benchmarks ........................... [[32mSUCCESS 1[0m in 0.47s]
[0m01:07:14.589796 [debug] [Thread-1  ]: Finished running node model.bain_capital_analytics.stg_benchmarks
[0m01:07:14.590146 [debug] [Thread-1  ]: Began running node model.bain_capital_analytics.stg_fund_structures
[0m01:07:14.590633 [info ] [Thread-1  ]: 5 of 28 START sql view model DEV.stg_fund_structures ........................... [RUN]
[0m01:07:14.591070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_benchmarks, now model.bain_capital_analytics.stg_fund_structures)
[0m01:07:14.591399 [debug] [Thread-1  ]: Began compiling node model.bain_capital_analytics.stg_fund_structures
[0m01:07:14.594401 [debug] [Thread-1  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_fund_structures"
[0m01:07:14.595203 [debug] [Thread-1  ]: Began executing node model.bain_capital_analytics.stg_fund_structures
[0m01:07:14.598394 [debug] [Thread-1  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_fund_structures"
[0m01:07:14.599609 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.stg_fund_structures"
[0m01:07:14.599962 [debug] [Thread-1  ]: On model.bain_capital_analytics.stg_fund_structures: create or replace   view DBT_DEMO.DEV.stg_fund_structures
  
  
  
  
  as (
    select distinct
    fund_id,
    fund_name,
    fund_type,
    cast(vintage_year as integer) as vintage_year,
    cast(committed_capital as numeric(18,2)) as committed_capital,
    cast(management_fee_rate as numeric(8,4)) as management_fee_rate,
    cast(carry_rate as numeric(8,4)) as carry_rate,
    cast(hurdle_rate as numeric(8,4)) as hurdle_rate,
    cast(gp_commitment_pct as numeric(8,4)) as gp_commitment_pct,
    fund_currency,
    fund_status
from DBT_DEMO.DEV_raw.raw_fund_structures
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_fund_structures"} */;
[0m01:07:14.687191 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.475 seconds
[0m01:07:14.689474 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115575eb0>]}
[0m01:07:14.690139 [info ] [Thread-2  ]: 2 of 28 OK created sql view model DEV.stg_cashflows ............................ [[32mSUCCESS 1[0m in 0.57s]
[0m01:07:14.690638 [debug] [Thread-2  ]: Finished running node model.bain_capital_analytics.stg_cashflows
[0m01:07:14.690991 [debug] [Thread-2  ]: Began running node model.bain_capital_analytics.stg_instruments
[0m01:07:14.691501 [info ] [Thread-2  ]: 6 of 28 START sql view model DEV.stg_instruments ............................... [RUN]
[0m01:07:14.691963 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_cashflows, now model.bain_capital_analytics.stg_instruments)
[0m01:07:14.692312 [debug] [Thread-2  ]: Began compiling node model.bain_capital_analytics.stg_instruments
[0m01:07:14.697195 [debug] [Thread-2  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_instruments"
[0m01:07:14.698075 [debug] [Thread-2  ]: Began executing node model.bain_capital_analytics.stg_instruments
[0m01:07:14.701160 [debug] [Thread-2  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_instruments"
[0m01:07:14.702479 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.stg_instruments"
[0m01:07:14.702835 [debug] [Thread-2  ]: On model.bain_capital_analytics.stg_instruments: create or replace   view DBT_DEMO.DEV.stg_instruments
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT
select distinct
    instrument_id,
    instrument_name,
    instrument_type,
    sector,
    currency,
    exchange,
    issuer,
    cast(maturity_date as date) as maturity_date,
    -- Anti-pattern: PostgreSQL-specific date subtraction
    case
        when maturity_date is not null
        then datediff(day, current_date, cast(maturity_date as date))
        else null
    end as days_to_maturity,
    case
        when instrument_type in ('equity', 'futures') then 'liquid'
        when instrument_type in ('corporate_bond', 'government_bond', 'sovereign_bond', 'leveraged_loan') then 'semi_liquid'
        when instrument_type in ('private_equity', 'venture_capital', 'real_estate', 'real_estate_debt', 'infrastructure') then 'illiquid'
        else 'other'
    end as liquidity_class
from DBT_DEMO.DEV_raw.raw_instruments
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_instruments"} */;
[0m01:07:15.000184 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.400 seconds
[0m01:07:15.004944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155840a0>]}
[0m01:07:15.006143 [info ] [Thread-1  ]: 5 of 28 OK created sql view model DEV.stg_fund_structures ...................... [[32mSUCCESS 1[0m in 0.41s]
[0m01:07:15.006905 [debug] [Thread-1  ]: Finished running node model.bain_capital_analytics.stg_fund_structures
[0m01:07:15.007444 [debug] [Thread-1  ]: Began running node model.bain_capital_analytics.stg_portfolios
[0m01:07:15.008228 [info ] [Thread-1  ]: 7 of 28 START sql view model DEV.stg_portfolios ................................ [RUN]
[0m01:07:15.008881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_fund_structures, now model.bain_capital_analytics.stg_portfolios)
[0m01:07:15.009385 [debug] [Thread-1  ]: Began compiling node model.bain_capital_analytics.stg_portfolios
[0m01:07:15.015656 [debug] [Thread-1  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_portfolios"
[0m01:07:15.017024 [debug] [Thread-1  ]: Began executing node model.bain_capital_analytics.stg_portfolios
[0m01:07:15.021404 [debug] [Thread-1  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_portfolios"
[0m01:07:15.023281 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.stg_portfolios"
[0m01:07:15.023703 [debug] [Thread-1  ]: On model.bain_capital_analytics.stg_portfolios: create or replace   view DBT_DEMO.DEV.stg_portfolios
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT when source data is already unique
-- Anti-pattern: casting in every model instead of once upstream

select distinct
    cast(portfolio_id as varchar(10)) as portfolio_id,
    cast(portfolio_name as varchar(100)) as portfolio_name,
    cast(strategy as varchar(50)) as strategy,
    cast(inception_date as date) as inception_date,
    cast(fund_id as varchar(10)) as fund_id,
    cast(manager_name as varchar(100)) as manager_name,
    cast(is_active as boolean) as is_active,
    -- Anti-pattern: duplicated fiscal quarter logic (repeated in many models)
    case
        when extract(month from cast(inception_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(inception_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(inception_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(inception_date as date)) between 10 and 12 then 'Q2'
    end as inception_fiscal_quarter
from DBT_DEMO.DEV_raw.raw_portfolios
where cast(is_active as boolean) = TRUE
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_portfolios"} */;
[0m01:07:15.038467 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.335 seconds
[0m01:07:15.041162 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115575eb0>]}
[0m01:07:15.041963 [info ] [Thread-2  ]: 6 of 28 OK created sql view model DEV.stg_instruments .......................... [[32mSUCCESS 1[0m in 0.35s]
[0m01:07:15.042641 [debug] [Thread-2  ]: Finished running node model.bain_capital_analytics.stg_instruments
[0m01:07:15.043848 [debug] [Thread-2  ]: Began running node model.bain_capital_analytics.stg_positions
[0m01:07:15.044358 [info ] [Thread-2  ]: 8 of 28 START sql view model DEV.stg_positions ................................. [RUN]
[0m01:07:15.044816 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_instruments, now model.bain_capital_analytics.stg_positions)
[0m01:07:15.045148 [debug] [Thread-2  ]: Began compiling node model.bain_capital_analytics.stg_positions
[0m01:07:15.049409 [debug] [Thread-2  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_positions"
[0m01:07:15.060539 [debug] [Thread-2  ]: Began executing node model.bain_capital_analytics.stg_positions
[0m01:07:15.066231 [debug] [Thread-2  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_positions"
[0m01:07:15.068095 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.stg_positions"
[0m01:07:15.068851 [debug] [Thread-2  ]: On model.bain_capital_analytics.stg_positions: create or replace   view DBT_DEMO.DEV.stg_positions
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT
-- Anti-pattern: no filtering or partitioning strategy

select distinct
    position_id,
    portfolio_id,
    instrument_id,
    cast(position_date as date) as position_date,
    cast(quantity as numeric(18,4)) as quantity,
    cast(market_value as numeric(18,2)) as market_value,
    cast(cost_basis as numeric(18,2)) as cost_basis,
    currency,
    -- Anti-pattern: computed column that could be done downstream
    cast(market_value as numeric(18,2)) - cast(cost_basis as numeric(18,2)) as unrealized_gain_loss,
    case
        when cast(cost_basis as numeric(18,2)) != 0
        then (cast(market_value as numeric(18,2)) - cast(cost_basis as numeric(18,2))) / abs(cast(cost_basis as numeric(18,2)))
        else 0
    end as unrealized_return_pct
from DBT_DEMO.DEV_raw.raw_positions
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_positions"} */;
[0m01:07:15.301610 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.277 seconds
[0m01:07:15.306248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11570afa0>]}
[0m01:07:15.307385 [info ] [Thread-1  ]: 7 of 28 OK created sql view model DEV.stg_portfolios ........................... [[32mSUCCESS 1[0m in 0.30s]
[0m01:07:15.308158 [debug] [Thread-1  ]: Finished running node model.bain_capital_analytics.stg_portfolios
[0m01:07:15.308683 [debug] [Thread-1  ]: Began running node model.bain_capital_analytics.stg_trades
[0m01:07:15.309518 [info ] [Thread-1  ]: 9 of 28 START sql view model DEV.stg_trades .................................... [RUN]
[0m01:07:15.310444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_portfolios, now model.bain_capital_analytics.stg_trades)
[0m01:07:15.311024 [debug] [Thread-1  ]: Began compiling node model.bain_capital_analytics.stg_trades
[0m01:07:15.317810 [debug] [Thread-1  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_trades"
[0m01:07:15.319327 [debug] [Thread-1  ]: Began executing node model.bain_capital_analytics.stg_trades
[0m01:07:15.323820 [debug] [Thread-1  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_trades"
[0m01:07:15.325874 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.stg_trades"
[0m01:07:15.326264 [debug] [Thread-1  ]: On model.bain_capital_analytics.stg_trades: create or replace   view DBT_DEMO.DEV.stg_trades
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT on already-unique trade_id
-- Anti-pattern: heavy casting repeated everywhere

select distinct
    trade_id,
    portfolio_id,
    instrument_id,
    counterparty_id,
    cast(trade_date as date) as trade_date,
    cast(settlement_date as date) as settlement_date,
    trade_type,
    cast(quantity as numeric(18,4)) as quantity,
    cast(price as numeric(18,6)) as price,
    cast(notional_amount as numeric(18,2)) as notional_amount,
    cast(commission as numeric(18,2)) as commission,
    currency,
    status,
    -- Anti-pattern: duplicated fiscal quarter logic
    case
        when extract(month from cast(trade_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(trade_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(trade_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(trade_date as date)) between 10 and 12 then 'Q2'
    end as trade_fiscal_quarter,
    -- Snowflake: use DATEDIFF instead of date subtraction
    datediff(day, cast(trade_date as date), cast(settlement_date as date)) as settlement_days
from DBT_DEMO.DEV_raw.raw_trades
where status = 'settled'
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_trades"} */;
[0m01:07:15.334591 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.265 seconds
[0m01:07:15.336709 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155f3250>]}
[0m01:07:15.337489 [info ] [Thread-2  ]: 8 of 28 OK created sql view model DEV.stg_positions ............................ [[32mSUCCESS 1[0m in 0.29s]
[0m01:07:15.338017 [debug] [Thread-2  ]: Finished running node model.bain_capital_analytics.stg_positions
[0m01:07:15.338386 [debug] [Thread-2  ]: Began running node model.bain_capital_analytics.stg_valuations
[0m01:07:15.338901 [info ] [Thread-2  ]: 10 of 28 START sql view model DEV.stg_valuations ............................... [RUN]
[0m01:07:15.339460 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_positions, now model.bain_capital_analytics.stg_valuations)
[0m01:07:15.339863 [debug] [Thread-2  ]: Began compiling node model.bain_capital_analytics.stg_valuations
[0m01:07:15.343378 [debug] [Thread-2  ]: Writing injected SQL for node "model.bain_capital_analytics.stg_valuations"
[0m01:07:15.344324 [debug] [Thread-2  ]: Began executing node model.bain_capital_analytics.stg_valuations
[0m01:07:15.347973 [debug] [Thread-2  ]: Writing runtime sql for node "model.bain_capital_analytics.stg_valuations"
[0m01:07:15.349594 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.stg_valuations"
[0m01:07:15.349965 [debug] [Thread-2  ]: On model.bain_capital_analytics.stg_valuations: create or replace   view DBT_DEMO.DEV.stg_valuations
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT
select distinct
    valuation_id,
    portfolio_id,
    cast(valuation_date as date) as valuation_date,
    cast(gross_asset_value as numeric(18,2)) as gross_asset_value,
    cast(net_asset_value as numeric(18,2)) as net_asset_value,
    cast(total_liabilities as numeric(18,2)) as total_liabilities,
    cast(unrealized_pnl as numeric(18,2)) as unrealized_pnl,
    cast(realized_pnl as numeric(18,2)) as realized_pnl,
    valuation_method,
    -- Anti-pattern: duplicated fiscal quarter logic
    case
        when extract(month from cast(valuation_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(valuation_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(valuation_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(valuation_date as date)) between 10 and 12 then 'Q2'
    end as valuation_fiscal_quarter
from DBT_DEMO.DEV_raw.raw_valuations
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_valuations"} */;
[0m01:07:15.614852 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.288 seconds
[0m01:07:15.618739 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115755c70>]}
[0m01:07:15.619866 [info ] [Thread-1  ]: 9 of 28 OK created sql view model DEV.stg_trades ............................... [[32mSUCCESS 1[0m in 0.31s]
[0m01:07:15.620638 [debug] [Thread-1  ]: Finished running node model.bain_capital_analytics.stg_trades
[0m01:07:15.621133 [debug] [Thread-1  ]: Began running node model.bain_capital_analytics.int_cashflow_enriched
[0m01:07:15.621785 [info ] [Thread-1  ]: 11 of 28 START sql view model DEV.int_cashflow_enriched ........................ [RUN]
[0m01:07:15.622335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_trades, now model.bain_capital_analytics.int_cashflow_enriched)
[0m01:07:15.622801 [debug] [Thread-1  ]: Began compiling node model.bain_capital_analytics.int_cashflow_enriched
[0m01:07:15.629971 [debug] [Thread-1  ]: Writing injected SQL for node "model.bain_capital_analytics.int_cashflow_enriched"
[0m01:07:15.631223 [debug] [Thread-1  ]: Began executing node model.bain_capital_analytics.int_cashflow_enriched
[0m01:07:15.638580 [debug] [Thread-1  ]: Dropping relation "DBT_DEMO"."DEV"."INT_CASHFLOW_ENRICHED" because it is of type table
[0m01:07:15.644515 [debug] [Thread-1  ]: Applying DROP to: "DBT_DEMO"."DEV"."INT_CASHFLOW_ENRICHED"
[0m01:07:15.649702 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.int_cashflow_enriched"
[0m01:07:15.650078 [debug] [Thread-1  ]: On model.bain_capital_analytics.int_cashflow_enriched: drop table if exists "DBT_DEMO"."DEV"."INT_CASHFLOW_ENRICHED" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_cashflow_enriched"} */
[0m01:07:15.837958 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.488 seconds
[0m01:07:15.839950 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155f3250>]}
[0m01:07:15.840644 [info ] [Thread-2  ]: 10 of 28 OK created sql view model DEV.stg_valuations .......................... [[32mSUCCESS 1[0m in 0.50s]
[0m01:07:15.841150 [debug] [Thread-2  ]: Finished running node model.bain_capital_analytics.stg_valuations
[0m01:07:15.841503 [debug] [Thread-2  ]: Began running node model.bain_capital_analytics.fact_portfolio_summary
[0m01:07:15.842116 [info ] [Thread-2  ]: 12 of 28 START sql view model DEV.fact_portfolio_summary ....................... [RUN]
[0m01:07:15.842948 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_valuations, now model.bain_capital_analytics.fact_portfolio_summary)
[0m01:07:15.843792 [debug] [Thread-2  ]: Began compiling node model.bain_capital_analytics.fact_portfolio_summary
[0m01:07:15.848380 [debug] [Thread-2  ]: Writing injected SQL for node "model.bain_capital_analytics.fact_portfolio_summary"
[0m01:07:15.849244 [debug] [Thread-2  ]: Began executing node model.bain_capital_analytics.fact_portfolio_summary
[0m01:07:15.852205 [debug] [Thread-2  ]: Dropping relation "DBT_DEMO"."DEV"."FACT_PORTFOLIO_SUMMARY" because it is of type table
[0m01:07:15.855373 [debug] [Thread-2  ]: Applying DROP to: "DBT_DEMO"."DEV"."FACT_PORTFOLIO_SUMMARY"
[0m01:07:15.855990 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.fact_portfolio_summary"
[0m01:07:15.856316 [debug] [Thread-2  ]: On model.bain_capital_analytics.fact_portfolio_summary: drop table if exists "DBT_DEMO"."DEV"."FACT_PORTFOLIO_SUMMARY" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_portfolio_summary"} */
[0m01:07:15.862455 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.212 seconds
[0m01:07:15.863695 [debug] [Thread-1  ]: Writing runtime sql for node "model.bain_capital_analytics.int_cashflow_enriched"
[0m01:07:15.866460 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.int_cashflow_enriched"
[0m01:07:15.866874 [debug] [Thread-1  ]: On model.bain_capital_analytics.int_cashflow_enriched: create or replace   view DBT_DEMO.DEV.int_cashflow_enriched
  
  
  
  
  as (
    -- Pipeline C: Enriched cashflow data with fund and portfolio details
-- Anti-pattern: subquery for dedup instead of QUALIFY
-- Anti-pattern: joins repeated from other intermediate models

with cashflow_with_details as (
    select *
    from (
        select
            cf.*,
            p.portfolio_name,
            p.strategy,
            p.manager_name,
            fs.fund_name,
            fs.fund_type,
            fs.committed_capital,
            fs.management_fee_rate,
            fs.carry_rate,
            fs.hurdle_rate,
            -- Anti-pattern: subquery filter instead of QUALIFY
            row_number() over (
                partition by cf.cashflow_id
                order by cf.cashflow_date desc
            ) as rn
        from DBT_DEMO.DEV.stg_cashflows cf
        inner join DBT_DEMO.DEV.stg_portfolios p
            on cf.portfolio_id = p.portfolio_id
        inner join DBT_DEMO.DEV.stg_fund_structures fs
            on cf.fund_id = fs.fund_id
    ) sub
    where rn = 1
),

-- Anti-pattern: running totals computed here AND again downstream
cashflow_cumulative as (
    select
        *,
        sum(case when cashflow_type = 'capital_call' then amount else 0 end) over (
            partition by fund_id, portfolio_id
            order by cashflow_date
            rows between unbounded preceding and current row
        ) as cumulative_called,
        sum(case when cashflow_type = 'distribution' then amount else 0 end) over (
            partition by fund_id, portfolio_id
            order by cashflow_date
            rows between unbounded preceding and current row
        ) as cumulative_distributed,
        sum(amount) over (
            partition by fund_id, portfolio_id
            order by cashflow_date
            rows between unbounded preceding and current row
        ) as cumulative_net_cashflow
    from cashflow_with_details
)

select
    cashflow_id,
    fund_id,
    fund_name,
    fund_type,
    portfolio_id,
    portfolio_name,
    strategy,
    manager_name,
    cashflow_date,
    cashflow_type,
    amount,
    currency,
    description,
    investor_id,
    cashflow_fiscal_quarter,
    cashflow_year,
    committed_capital,
    management_fee_rate,
    carry_rate,
    hurdle_rate,
    cumulative_called,
    cumulative_distributed,
    cumulative_net_cashflow,
    case
        when committed_capital > 0
        then cumulative_called / committed_capital
        else 0
    end as pct_called
from cashflow_cumulative
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_cashflow_enriched"} */;
[0m01:07:15.881911 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.670 seconds
[0m01:07:15.883805 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f40af70>]}
[0m01:07:15.884403 [info ] [Thread-4  ]: 4 of 28 OK created sql view model DEV.stg_dates ................................ [[32mSUCCESS 1[0m in 1.76s]
[0m01:07:15.884900 [debug] [Thread-4  ]: Finished running node model.bain_capital_analytics.stg_dates
[0m01:07:15.885245 [debug] [Thread-4  ]: Began running node model.bain_capital_analytics.int_portfolio_attribution
[0m01:07:15.885754 [info ] [Thread-4  ]: 13 of 28 START sql view model DEV.int_portfolio_attribution .................... [RUN]
[0m01:07:15.886267 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_dates, now model.bain_capital_analytics.int_portfolio_attribution)
[0m01:07:15.886617 [debug] [Thread-4  ]: Began compiling node model.bain_capital_analytics.int_portfolio_attribution
[0m01:07:15.890250 [debug] [Thread-4  ]: Writing injected SQL for node "model.bain_capital_analytics.int_portfolio_attribution"
[0m01:07:15.891263 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.680 seconds
[0m01:07:15.892875 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155bbf40>]}
[0m01:07:15.893755 [info ] [Thread-3  ]: 3 of 28 OK created sql view model DEV.stg_counterparties ....................... [[32mSUCCESS 1[0m in 1.77s]
[0m01:07:15.894328 [debug] [Thread-3  ]: Finished running node model.bain_capital_analytics.stg_counterparties
[0m01:07:15.894699 [debug] [Thread-3  ]: Began running node model.bain_capital_analytics.int_fund_nav
[0m01:07:15.895037 [debug] [Thread-4  ]: Began executing node model.bain_capital_analytics.int_portfolio_attribution
[0m01:07:15.895496 [info ] [Thread-3  ]: 14 of 28 START sql view model DEV.int_fund_nav ................................. [RUN]
[0m01:07:15.898647 [debug] [Thread-4  ]: Dropping relation "DBT_DEMO"."DEV"."INT_PORTFOLIO_ATTRIBUTION" because it is of type table
[0m01:07:15.899024 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_counterparties, now model.bain_capital_analytics.int_fund_nav)
[0m01:07:15.901362 [debug] [Thread-4  ]: Applying DROP to: "DBT_DEMO"."DEV"."INT_PORTFOLIO_ATTRIBUTION"
[0m01:07:15.901681 [debug] [Thread-3  ]: Began compiling node model.bain_capital_analytics.int_fund_nav
[0m01:07:15.902336 [debug] [Thread-4  ]: Using snowflake connection "model.bain_capital_analytics.int_portfolio_attribution"
[0m01:07:15.905752 [debug] [Thread-3  ]: Writing injected SQL for node "model.bain_capital_analytics.int_fund_nav"
[0m01:07:15.906102 [debug] [Thread-4  ]: On model.bain_capital_analytics.int_portfolio_attribution: drop table if exists "DBT_DEMO"."DEV"."INT_PORTFOLIO_ATTRIBUTION" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_portfolio_attribution"} */
[0m01:07:15.907014 [debug] [Thread-3  ]: Began executing node model.bain_capital_analytics.int_fund_nav
[0m01:07:15.910802 [debug] [Thread-3  ]: Dropping relation "DBT_DEMO"."DEV"."INT_FUND_NAV" because it is of type table
[0m01:07:15.914073 [debug] [Thread-3  ]: Applying DROP to: "DBT_DEMO"."DEV"."INT_FUND_NAV"
[0m01:07:15.914764 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.int_fund_nav"
[0m01:07:15.915091 [debug] [Thread-3  ]: On model.bain_capital_analytics.int_fund_nav: drop table if exists "DBT_DEMO"."DEV"."INT_FUND_NAV" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_fund_nav"} */
[0m01:07:16.078455 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.222 seconds
[0m01:07:16.081391 [debug] [Thread-2  ]: Writing runtime sql for node "model.bain_capital_analytics.fact_portfolio_summary"
[0m01:07:16.084416 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.fact_portfolio_summary"
[0m01:07:16.085049 [debug] [Thread-2  ]: On model.bain_capital_analytics.fact_portfolio_summary: create or replace   view DBT_DEMO.DEV.fact_portfolio_summary
  
  
  
  
  as (
    -- Pipeline A: FACT table - Portfolio summary with positions
-- Anti-pattern: unnecessary DISTINCT on already-unique aggregation
-- Anti-pattern: late filtering (filters at the end instead of upstream)
-- Anti-pattern: materialized as view (should be table)

select distinct
    p.portfolio_id,
    p.portfolio_name,
    p.strategy,
    p.fund_id,
    p.manager_name,
    pos.position_date,
    count(distinct pos.instrument_id) as num_positions,
    sum(pos.market_value) as total_market_value,
    sum(pos.cost_basis) as total_cost_basis,
    sum(pos.unrealized_gain_loss) as total_unrealized_pnl,
    case
        when sum(pos.cost_basis) != 0
        then sum(pos.unrealized_gain_loss) / abs(sum(pos.cost_basis))
        else 0
    end as portfolio_return_pct,
    max(pos.market_value) as largest_position_mv,
    min(pos.market_value) as smallest_position_mv
from DBT_DEMO.DEV.stg_portfolios p
inner join DBT_DEMO.DEV.stg_positions pos
    on p.portfolio_id = pos.portfolio_id
-- Anti-pattern: filter at the end instead of in staging
where p.is_active = TRUE
group by
    p.portfolio_id,
    p.portfolio_name,
    p.strategy,
    p.fund_id,
    p.manager_name,
    pos.position_date
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_portfolio_summary"} */;
[0m01:07:16.136320 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.221 seconds
[0m01:07:16.139065 [debug] [Thread-3  ]: Writing runtime sql for node "model.bain_capital_analytics.int_fund_nav"
[0m01:07:16.143358 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.int_fund_nav"
[0m01:07:16.144071 [debug] [Thread-3  ]: On model.bain_capital_analytics.int_fund_nav: create or replace   view DBT_DEMO.DEV.int_fund_nav
  
  
  
  
  as (
    -- Pipeline C: Fund-level NAV calculation from portfolio valuations
-- Anti-pattern: late aggregation - joins everything then aggregates at the end
-- Anti-pattern: repeated joins to fund_structures and portfolios

with portfolio_valuations as (
    select
        v.portfolio_id,
        v.valuation_date,
        v.net_asset_value,
        v.gross_asset_value,
        v.total_liabilities,
        v.unrealized_pnl,
        v.realized_pnl,
        v.valuation_method,
        p.fund_id,
        p.portfolio_name,
        p.strategy,
        -- Anti-pattern: joining fund_structures again (already done in int_cashflow_enriched)
        fs.fund_name,
        fs.fund_type,
        fs.committed_capital,
        fs.management_fee_rate
    from DBT_DEMO.DEV.stg_valuations v
    inner join DBT_DEMO.DEV.stg_portfolios p
        on v.portfolio_id = p.portfolio_id
    inner join DBT_DEMO.DEV.stg_fund_structures fs
        on p.fund_id = fs.fund_id
),

-- Anti-pattern: aggregation happens here at the end after all joins
fund_level_nav as (
    select
        fund_id,
        fund_name,
        fund_type,
        committed_capital,
        management_fee_rate,
        valuation_date,
        sum(net_asset_value) as fund_nav,
        sum(gross_asset_value) as fund_gav,
        sum(total_liabilities) as fund_total_liabilities,
        sum(unrealized_pnl) as fund_unrealized_pnl,
        sum(realized_pnl) as fund_realized_pnl,
        count(distinct portfolio_id) as num_portfolios
    from portfolio_valuations
    group by
        fund_id, fund_name, fund_type, committed_capital,
        management_fee_rate, valuation_date
),

fund_nav_with_changes as (
    select
        fn.*,
        lag(fn.fund_nav) over (
            partition by fn.fund_id order by fn.valuation_date
        ) as prev_fund_nav,
        case
            when lag(fn.fund_nav) over (
                partition by fn.fund_id order by fn.valuation_date
            ) is not null
            and lag(fn.fund_nav) over (
                partition by fn.fund_id order by fn.valuation_date
            ) != 0
            then (fn.fund_nav - lag(fn.fund_nav) over (
                partition by fn.fund_id order by fn.valuation_date
            )) / lag(fn.fund_nav) over (
                partition by fn.fund_id order by fn.valuation_date
            )
            else null
        end as fund_nav_return,
        fn.fund_nav / nullif(fn.committed_capital, 0) as tvpi_gross
    from fund_level_nav fn
)

select * from fund_nav_with_changes
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_fund_nav"} */;
[0m01:07:16.175281 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.269 seconds
[0m01:07:16.177832 [debug] [Thread-4  ]: Writing runtime sql for node "model.bain_capital_analytics.int_portfolio_attribution"
[0m01:07:16.181590 [debug] [Thread-4  ]: Using snowflake connection "model.bain_capital_analytics.int_portfolio_attribution"
[0m01:07:16.182105 [debug] [Thread-4  ]: On model.bain_capital_analytics.int_portfolio_attribution: create or replace   view DBT_DEMO.DEV.int_portfolio_attribution
  
  
  
  
  as (
    -- Pipeline C: Portfolio performance attribution by sector and instrument type
-- Anti-pattern: deep CTE chain, repeated joins, late aggregation
-- Anti-pattern: same position-instrument-portfolio joins as int_daily_positions

with positions_enriched as (
    -- Anti-pattern: repeating the same 3-way join as int_daily_positions
    select
        pos.position_id,
        pos.portfolio_id,
        pos.instrument_id,
        pos.position_date,
        pos.quantity,
        pos.market_value,
        pos.cost_basis,
        pos.unrealized_gain_loss,
        i.instrument_name,
        i.instrument_type,
        i.sector,
        p.portfolio_name,
        p.strategy,
        p.fund_id
    from DBT_DEMO.DEV.stg_positions pos
    inner join DBT_DEMO.DEV.stg_instruments i
        on pos.instrument_id = i.instrument_id
    inner join DBT_DEMO.DEV.stg_portfolios p
        on pos.portfolio_id = p.portfolio_id
),

-- Anti-pattern: compute portfolio totals in a separate CTE instead of a single pass
portfolio_totals as (
    select
        portfolio_id,
        position_date,
        sum(market_value) as total_portfolio_mv,
        sum(unrealized_gain_loss) as total_portfolio_ugl
    from positions_enriched
    group by portfolio_id, position_date
),

-- Anti-pattern: sector aggregation in yet another CTE
sector_attribution as (
    select
        pe.portfolio_id,
        pe.portfolio_name,
        pe.strategy,
        pe.fund_id,
        pe.position_date,
        pe.sector,
        sum(pe.market_value) as sector_mv,
        sum(pe.unrealized_gain_loss) as sector_ugl,
        count(distinct pe.instrument_id) as num_instruments
    from positions_enriched pe
    group by
        pe.portfolio_id, pe.portfolio_name, pe.strategy,
        pe.fund_id, pe.position_date, pe.sector
),

-- Anti-pattern: joining back to get weights instead of computing in one pass
attribution_with_weights as (
    select
        sa.*,
        pt.total_portfolio_mv,
        pt.total_portfolio_ugl,
        case
            when pt.total_portfolio_mv != 0
            then sa.sector_mv / pt.total_portfolio_mv
            else 0
        end as sector_weight,
        case
            when pt.total_portfolio_ugl != 0
            then sa.sector_ugl / pt.total_portfolio_ugl
            else 0
        end as sector_contribution
    from sector_attribution sa
    inner join portfolio_totals pt
        on sa.portfolio_id = pt.portfolio_id
        and sa.position_date = pt.position_date
)

select * from attribution_with_weights
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_portfolio_attribution"} */;
[0m01:07:16.357795 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.490 seconds
[0m01:07:16.362463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b95fa60>]}
[0m01:07:16.363669 [info ] [Thread-1  ]: 11 of 28 OK created sql view model DEV.int_cashflow_enriched ................... [[32mSUCCESS 1[0m in 0.74s]
[0m01:07:16.364429 [debug] [Thread-1  ]: Finished running node model.bain_capital_analytics.int_cashflow_enriched
[0m01:07:16.364943 [debug] [Thread-1  ]: Began running node model.bain_capital_analytics.int_irr_calculations
[0m01:07:16.365662 [info ] [Thread-1  ]: 15 of 28 START sql view model DEV.int_irr_calculations ......................... [RUN]
[0m01:07:16.366389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_cashflow_enriched, now model.bain_capital_analytics.int_irr_calculations)
[0m01:07:16.366854 [debug] [Thread-1  ]: Began compiling node model.bain_capital_analytics.int_irr_calculations
[0m01:07:16.373894 [debug] [Thread-1  ]: Writing injected SQL for node "model.bain_capital_analytics.int_irr_calculations"
[0m01:07:16.374943 [debug] [Thread-1  ]: Began executing node model.bain_capital_analytics.int_irr_calculations
[0m01:07:16.378785 [debug] [Thread-1  ]: Dropping relation "DBT_DEMO"."DEV"."INT_IRR_CALCULATIONS" because it is of type table
[0m01:07:16.382438 [debug] [Thread-1  ]: Applying DROP to: "DBT_DEMO"."DEV"."INT_IRR_CALCULATIONS"
[0m01:07:16.383135 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.int_irr_calculations"
[0m01:07:16.383467 [debug] [Thread-1  ]: On model.bain_capital_analytics.int_irr_calculations: drop table if exists "DBT_DEMO"."DEV"."INT_IRR_CALCULATIONS" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_irr_calculations"} */
[0m01:07:16.571270 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.426 seconds
[0m01:07:16.575416 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155bbf40>]}
[0m01:07:16.576610 [info ] [Thread-3  ]: 14 of 28 OK created sql view model DEV.int_fund_nav ............................ [[32mSUCCESS 1[0m in 0.68s]
[0m01:07:16.577725 [debug] [Thread-3  ]: Finished running node model.bain_capital_analytics.int_fund_nav
[0m01:07:16.578334 [debug] [Thread-3  ]: Began running node model.bain_capital_analytics.int_valuation_enriched
[0m01:07:16.579138 [info ] [Thread-3  ]: 16 of 28 START sql view model DEV.int_valuation_enriched ....................... [RUN]
[0m01:07:16.579918 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_fund_nav, now model.bain_capital_analytics.int_valuation_enriched)
[0m01:07:16.580482 [debug] [Thread-3  ]: Began compiling node model.bain_capital_analytics.int_valuation_enriched
[0m01:07:16.587320 [debug] [Thread-3  ]: Writing injected SQL for node "model.bain_capital_analytics.int_valuation_enriched"
[0m01:07:16.588557 [debug] [Thread-3  ]: Began executing node model.bain_capital_analytics.int_valuation_enriched
[0m01:07:16.592574 [debug] [Thread-3  ]: Dropping relation "DBT_DEMO"."DEV"."INT_VALUATION_ENRICHED" because it is of type table
[0m01:07:16.595591 [debug] [Thread-3  ]: Applying DROP to: "DBT_DEMO"."DEV"."INT_VALUATION_ENRICHED"
[0m01:07:16.596244 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.int_valuation_enriched"
[0m01:07:16.596569 [debug] [Thread-3  ]: On model.bain_capital_analytics.int_valuation_enriched: drop table if exists "DBT_DEMO"."DEV"."INT_VALUATION_ENRICHED" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_valuation_enriched"} */
[0m01:07:16.603572 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.518 seconds
[0m01:07:16.605412 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4e07c0>]}
[0m01:07:16.605993 [info ] [Thread-2  ]: 12 of 28 OK created sql view model DEV.fact_portfolio_summary .................. [[32mSUCCESS 1[0m in 0.76s]
[0m01:07:16.606478 [debug] [Thread-2  ]: Finished running node model.bain_capital_analytics.fact_portfolio_summary
[0m01:07:16.606821 [debug] [Thread-2  ]: Began running node model.bain_capital_analytics.int_benchmark_returns
[0m01:07:16.607312 [info ] [Thread-2  ]: 17 of 28 START sql view model DEV.int_benchmark_returns ........................ [RUN]
[0m01:07:16.607790 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.fact_portfolio_summary, now model.bain_capital_analytics.int_benchmark_returns)
[0m01:07:16.608126 [debug] [Thread-2  ]: Began compiling node model.bain_capital_analytics.int_benchmark_returns
[0m01:07:16.611852 [debug] [Thread-2  ]: Writing injected SQL for node "model.bain_capital_analytics.int_benchmark_returns"
[0m01:07:16.612776 [debug] [Thread-2  ]: Began executing node model.bain_capital_analytics.int_benchmark_returns
[0m01:07:16.615962 [debug] [Thread-2  ]: Dropping relation "DBT_DEMO"."DEV"."INT_BENCHMARK_RETURNS" because it is of type table
[0m01:07:16.619402 [debug] [Thread-2  ]: Applying DROP to: "DBT_DEMO"."DEV"."INT_BENCHMARK_RETURNS"
[0m01:07:16.620093 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.int_benchmark_returns"
[0m01:07:16.620457 [debug] [Thread-2  ]: On model.bain_capital_analytics.int_benchmark_returns: drop table if exists "DBT_DEMO"."DEV"."INT_BENCHMARK_RETURNS" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_benchmark_returns"} */
[0m01:07:16.622657 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.440 seconds
[0m01:07:16.624457 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f40af70>]}
[0m01:07:16.625013 [info ] [Thread-4  ]: 13 of 28 OK created sql view model DEV.int_portfolio_attribution ............... [[32mSUCCESS 1[0m in 0.74s]
[0m01:07:16.625483 [debug] [Thread-4  ]: Finished running node model.bain_capital_analytics.int_portfolio_attribution
[0m01:07:16.625994 [debug] [Thread-4  ]: Began running node model.bain_capital_analytics.int_daily_positions
[0m01:07:16.626481 [info ] [Thread-4  ]: 18 of 28 START sql view model DEV.int_daily_positions .......................... [RUN]
[0m01:07:16.627222 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_portfolio_attribution, now model.bain_capital_analytics.int_daily_positions)
[0m01:07:16.627614 [debug] [Thread-4  ]: Began compiling node model.bain_capital_analytics.int_daily_positions
[0m01:07:16.631552 [debug] [Thread-4  ]: Writing injected SQL for node "model.bain_capital_analytics.int_daily_positions"
[0m01:07:16.632430 [debug] [Thread-4  ]: Began executing node model.bain_capital_analytics.int_daily_positions
[0m01:07:16.635378 [debug] [Thread-4  ]: Dropping relation "DBT_DEMO"."DEV"."INT_DAILY_POSITIONS" because it is of type table
[0m01:07:16.637753 [debug] [Thread-4  ]: Applying DROP to: "DBT_DEMO"."DEV"."INT_DAILY_POSITIONS"
[0m01:07:16.638378 [debug] [Thread-4  ]: Using snowflake connection "model.bain_capital_analytics.int_daily_positions"
[0m01:07:16.638706 [debug] [Thread-4  ]: On model.bain_capital_analytics.int_daily_positions: drop table if exists "DBT_DEMO"."DEV"."INT_DAILY_POSITIONS" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_daily_positions"} */
[0m01:07:16.668918 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.285 seconds
[0m01:07:16.670161 [debug] [Thread-1  ]: Writing runtime sql for node "model.bain_capital_analytics.int_irr_calculations"
[0m01:07:16.673769 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.int_irr_calculations"
[0m01:07:16.674236 [debug] [Thread-1  ]: On model.bain_capital_analytics.int_irr_calculations: create or replace   view DBT_DEMO.DEV.int_irr_calculations
  
  
  
  
  as (
    -- Pipeline C: Approximate IRR calculation per fund/portfolio
-- Anti-pattern: extremely deep CTE nesting (6 levels)
-- Anti-pattern: PostgreSQL-specific date arithmetic
-- Anti-pattern: complex logic that should be a macro

with cashflow_series as (
    -- CTE level 1: get all cashflows with proper signs
    select
        cf.fund_id,
        cf.portfolio_id,
        cf.cashflow_date,
        cf.cashflow_type,
        case
            when cf.cashflow_type = 'capital_call' then -1 * abs(cf.amount)
            when cf.cashflow_type = 'distribution' then abs(cf.amount)
            when cf.cashflow_type = 'management_fee' then -1 * abs(cf.amount)
            else cf.amount
        end as signed_amount
    from DBT_DEMO.DEV.stg_cashflows cf
),

terminal_values as (
    -- CTE level 2: get latest NAV as terminal cashflow
    select
        v.portfolio_id,
        p.fund_id,
        v.valuation_date as cashflow_date,
        'terminal_value' as cashflow_type,
        v.net_asset_value as signed_amount
    from DBT_DEMO.DEV.stg_valuations v
    inner join DBT_DEMO.DEV.stg_portfolios p
        on v.portfolio_id = p.portfolio_id
    where v.valuation_date = (
        -- Anti-pattern: correlated subquery instead of window function
        select max(v2.valuation_date)
        from DBT_DEMO.DEV.stg_valuations v2
        where v2.portfolio_id = v.portfolio_id
    )
),

all_cashflows as (
    -- CTE level 3: union cashflows and terminal values
    select fund_id, portfolio_id, cashflow_date, cashflow_type, signed_amount
    from cashflow_series
    union all
    select fund_id, portfolio_id, cashflow_date, cashflow_type, signed_amount
    from terminal_values
),

cashflow_with_timing as (
    -- CTE level 4: compute time fractions
    -- Anti-pattern: PostgreSQL date subtraction
    select
        ac.*,
        min(ac.cashflow_date) over (partition by ac.fund_id, ac.portfolio_id) as first_cf_date,
        cast(datediff(day, min(ac.cashflow_date) over (partition by ac.fund_id, ac.portfolio_id), ac.cashflow_date) as numeric) / 365.25 as year_fraction
    from all_cashflows ac
),

-- CTE level 5: compute simple multiples as IRR proxy
portfolio_multiples as (
    select
        fund_id,
        portfolio_id,
        min(cashflow_date) as first_cashflow_date,
        max(cashflow_date) as last_cashflow_date,
        -- Anti-pattern: PostgreSQL date subtraction
        datediff(day, min(cashflow_date), max(cashflow_date)) as investment_days,
        cast(datediff(day, min(cashflow_date), max(cashflow_date)) as numeric) / 365.25 as investment_years,
        sum(case when cashflow_type = 'capital_call' then abs(signed_amount) else 0 end) as total_invested,
        sum(case when cashflow_type = 'distribution' then signed_amount else 0 end) as total_distributed,
        sum(case when cashflow_type = 'terminal_value' then signed_amount else 0 end) as terminal_value,
        sum(signed_amount) as net_cashflow
    from cashflow_with_timing
    group by fund_id, portfolio_id
),

-- CTE level 6: compute IRR approximation
irr_approximation as (
    select
        pm.*,
        case
            when pm.total_invested > 0
            then (pm.total_distributed + pm.terminal_value) / pm.total_invested
            else null
        end as tvpi,
        case
            when pm.total_invested > 0
            then pm.total_distributed / pm.total_invested
            else null
        end as dpi,
        case
            when pm.total_invested > 0
            then pm.terminal_value / pm.total_invested
            else null
        end as rvpi,
        -- Simplified IRR approximation: (TVPI^(1/years)) - 1
        case
            when pm.total_invested > 0 and pm.investment_years > 0
            then power(
                (pm.total_distributed + pm.terminal_value) / pm.total_invested,
                1.0 / pm.investment_years
            ) - 1
            else null
        end as approx_irr
    from portfolio_multiples pm
)

select * from irr_approximation
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_irr_calculations"} */;
[0m01:07:16.811998 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.215 seconds
[0m01:07:16.814878 [debug] [Thread-3  ]: Writing runtime sql for node "model.bain_capital_analytics.int_valuation_enriched"
[0m01:07:16.818251 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.int_valuation_enriched"
[0m01:07:16.818899 [debug] [Thread-3  ]: On model.bain_capital_analytics.int_valuation_enriched: create or replace   view DBT_DEMO.DEV.int_valuation_enriched
  
  
  
  
  as (
    -- Pipeline C: Enriched valuation data
-- Anti-pattern: subquery for dedup instead of QUALIFY
-- Anti-pattern: repeated portfolio join
-- Anti-pattern: PostgreSQL-specific date functions

with valuation_ranked as (
    select *
    from (
        select
            v.*,
            p.portfolio_name,
            p.strategy,
            p.fund_id,
            p.manager_name,
            -- Anti-pattern: subquery dedup instead of QUALIFY
            row_number() over (
                partition by v.portfolio_id, v.valuation_date
                order by v.valuation_id desc
            ) as rn
        from DBT_DEMO.DEV.stg_valuations v
        inner join DBT_DEMO.DEV.stg_portfolios p
            on v.portfolio_id = p.portfolio_id
    ) sub
    where rn = 1
),

valuation_with_changes as (
    select
        vr.*,
        lag(vr.net_asset_value) over (
            partition by vr.portfolio_id order by vr.valuation_date
        ) as prev_nav,
        case
            when lag(vr.net_asset_value) over (
                partition by vr.portfolio_id order by vr.valuation_date
            ) is not null
            and lag(vr.net_asset_value) over (
                partition by vr.portfolio_id order by vr.valuation_date
            ) != 0
            then (vr.net_asset_value - lag(vr.net_asset_value) over (
                partition by vr.portfolio_id order by vr.valuation_date
            )) / lag(vr.net_asset_value) over (
                partition by vr.portfolio_id order by vr.valuation_date
            )
            else null
        end as nav_return_pct,
        -- Snowflake: use DATEDIFF instead of date subtraction
        datediff(day, lag(vr.valuation_date) over (
            partition by vr.portfolio_id order by vr.valuation_date
        ), vr.valuation_date) as days_between_valuations
    from valuation_ranked vr
)

select * from valuation_with_changes
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_valuation_enriched"} */;
[0m01:07:16.829917 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.209 seconds
[0m01:07:16.831779 [debug] [Thread-2  ]: Writing runtime sql for node "model.bain_capital_analytics.int_benchmark_returns"
[0m01:07:16.834730 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.int_benchmark_returns"
[0m01:07:16.835199 [debug] [Thread-2  ]: On model.bain_capital_analytics.int_benchmark_returns: create or replace   view DBT_DEMO.DEV.int_benchmark_returns
  
  
  
  
  as (
    -- Pipeline C: Benchmark returns with rolling calculations
-- Anti-pattern: heavy window functions that could be pre-computed

with benchmark_base as (
    select
        b.benchmark_id,
        b.benchmark_name,
        b.benchmark_date,
        b.return_daily,
        b.return_mtd,
        b.return_ytd,
        b.benchmark_level,
        b.benchmark_fiscal_quarter,
        d.fiscal_year,
        d.is_quarter_end,
        d.is_year_end
    from DBT_DEMO.DEV.stg_benchmarks b
    inner join DBT_DEMO.DEV.stg_dates d
        on b.benchmark_date = d.date_day
),

-- Anti-pattern: compute many overlapping windows
benchmark_with_rolling as (
    select
        bb.*,
        -- rolling 3-month return
        exp(sum(ln(1 + bb.return_mtd)) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 2 preceding and current row
        )) - 1 as rolling_3m_return,
        -- rolling 6-month return
        exp(sum(ln(1 + bb.return_mtd)) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 5 preceding and current row
        )) - 1 as rolling_6m_return,
        -- rolling 12-month return
        exp(sum(ln(1 + bb.return_mtd)) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 11 preceding and current row
        )) - 1 as rolling_12m_return,
        -- Anti-pattern: volatility via window (expensive)
        stddev(bb.return_mtd) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 11 preceding and current row
        ) as rolling_12m_volatility,
        avg(bb.return_mtd) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 11 preceding and current row
        ) as rolling_12m_avg_return,
        lag(bb.benchmark_level) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
        ) as prev_benchmark_level
    from benchmark_base bb
)

select * from benchmark_with_rolling
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_benchmark_returns"} */;
[0m01:07:16.857589 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.219 seconds
[0m01:07:16.859017 [debug] [Thread-4  ]: Writing runtime sql for node "model.bain_capital_analytics.int_daily_positions"
[0m01:07:16.862074 [debug] [Thread-4  ]: Using snowflake connection "model.bain_capital_analytics.int_daily_positions"
[0m01:07:16.862572 [debug] [Thread-4  ]: On model.bain_capital_analytics.int_daily_positions: create or replace   view DBT_DEMO.DEV.int_daily_positions
  
  
  
  
  as (
    -- Pipeline B: Daily position snapshots with PnL calculations
-- Anti-pattern: deep CTE nesting
-- Anti-pattern: repeated joins to same dimension tables

with position_base as (
    select
        pos.position_id,
        pos.portfolio_id,
        pos.instrument_id,
        pos.position_date,
        pos.quantity,
        pos.market_value,
        pos.cost_basis,
        pos.unrealized_gain_loss,
        pos.unrealized_return_pct,
        pos.currency
    from DBT_DEMO.DEV.stg_positions pos
),

-- Anti-pattern: CTE level 2 - join instruments (same join as int_trade_enriched)
position_with_instruments as (
    select
        pb.*,
        i.instrument_name,
        i.instrument_type,
        i.sector,
        i.liquidity_class
    from position_base pb
    inner join DBT_DEMO.DEV.stg_instruments i
        on pb.instrument_id = i.instrument_id
),

-- Anti-pattern: CTE level 3 - join portfolios (same join as int_trade_enriched)
position_with_portfolio as (
    select
        pwi.*,
        p.portfolio_name,
        p.strategy,
        p.fund_id
    from position_with_instruments pwi
    inner join DBT_DEMO.DEV.stg_portfolios p
        on pwi.portfolio_id = p.portfolio_id
),

-- Anti-pattern: CTE level 4 - join dates
position_with_dates as (
    select
        pwp.*,
        d.is_business_day,
        d.is_month_end,
        d.is_quarter_end,
        d.fiscal_quarter,
        d.fiscal_year
    from position_with_portfolio pwp
    inner join DBT_DEMO.DEV.stg_dates d
        on pwp.position_date = d.date_day
),

-- Anti-pattern: CTE level 5 - compute window functions
position_with_analytics as (
    select
        pwd.*,
        -- Anti-pattern: multiple window functions on same partition
        lag(pwd.market_value) over (
            partition by pwd.portfolio_id, pwd.instrument_id
            order by pwd.position_date
        ) as prev_market_value,
        pwd.market_value - coalesce(
            lag(pwd.market_value) over (
                partition by pwd.portfolio_id, pwd.instrument_id
                order by pwd.position_date
            ), pwd.cost_basis
        ) as daily_pnl,
        sum(pwd.market_value) over (
            partition by pwd.portfolio_id, pwd.position_date
        ) as portfolio_total_mv,
        case
            when sum(pwd.market_value) over (partition by pwd.portfolio_id, pwd.position_date) != 0
            then pwd.market_value / sum(pwd.market_value) over (partition by pwd.portfolio_id, pwd.position_date)
            else 0
        end as weight_in_portfolio
    from position_with_dates pwd
)

select * from position_with_analytics
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_daily_positions"} */;
[0m01:07:17.136228 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.461 seconds
[0m01:07:17.141627 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e492c40>]}
[0m01:07:17.142725 [info ] [Thread-1  ]: 15 of 28 OK created sql view model DEV.int_irr_calculations .................... [[32mSUCCESS 1[0m in 0.78s]
[0m01:07:17.143652 [debug] [Thread-1  ]: Finished running node model.bain_capital_analytics.int_irr_calculations
[0m01:07:17.144391 [debug] [Thread-1  ]: Began running node model.bain_capital_analytics.fact_trade_activity
[0m01:07:17.145403 [info ] [Thread-1  ]: 19 of 28 START sql view model DEV.fact_trade_activity .......................... [RUN]
[0m01:07:17.146535 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_irr_calculations, now model.bain_capital_analytics.fact_trade_activity)
[0m01:07:17.146989 [debug] [Thread-1  ]: Began compiling node model.bain_capital_analytics.fact_trade_activity
[0m01:07:17.155544 [debug] [Thread-1  ]: Writing injected SQL for node "model.bain_capital_analytics.fact_trade_activity"
[0m01:07:17.156517 [debug] [Thread-1  ]: Began executing node model.bain_capital_analytics.fact_trade_activity
[0m01:07:17.159751 [debug] [Thread-1  ]: Dropping relation "DBT_DEMO"."DEV"."FACT_TRADE_ACTIVITY" because it is of type table
[0m01:07:17.162561 [debug] [Thread-1  ]: Applying DROP to: "DBT_DEMO"."DEV"."FACT_TRADE_ACTIVITY"
[0m01:07:17.163243 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.fact_trade_activity"
[0m01:07:17.163590 [debug] [Thread-1  ]: On model.bain_capital_analytics.fact_trade_activity: drop table if exists "DBT_DEMO"."DEV"."FACT_TRADE_ACTIVITY" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_trade_activity"} */
[0m01:07:17.204905 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.369 seconds
[0m01:07:17.207287 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115804850>]}
[0m01:07:17.207958 [info ] [Thread-2  ]: 17 of 28 OK created sql view model DEV.int_benchmark_returns ................... [[32mSUCCESS 1[0m in 0.60s]
[0m01:07:17.208508 [debug] [Thread-2  ]: Finished running node model.bain_capital_analytics.int_benchmark_returns
[0m01:07:17.208900 [debug] [Thread-2  ]: Began running node model.bain_capital_analytics.int_trade_enriched
[0m01:07:17.209439 [info ] [Thread-2  ]: 20 of 28 START sql view model DEV.int_trade_enriched ........................... [RUN]
[0m01:07:17.210055 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_benchmark_returns, now model.bain_capital_analytics.int_trade_enriched)
[0m01:07:17.210431 [debug] [Thread-2  ]: Began compiling node model.bain_capital_analytics.int_trade_enriched
[0m01:07:17.214490 [debug] [Thread-2  ]: Writing injected SQL for node "model.bain_capital_analytics.int_trade_enriched"
[0m01:07:17.215173 [debug] [Thread-2  ]: Began executing node model.bain_capital_analytics.int_trade_enriched
[0m01:07:17.217927 [debug] [Thread-2  ]: Dropping relation "DBT_DEMO"."DEV"."INT_TRADE_ENRICHED" because it is of type table
[0m01:07:17.221080 [debug] [Thread-2  ]: Applying DROP to: "DBT_DEMO"."DEV"."INT_TRADE_ENRICHED"
[0m01:07:17.221715 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.int_trade_enriched"
[0m01:07:17.222048 [debug] [Thread-2  ]: On model.bain_capital_analytics.int_trade_enriched: drop table if exists "DBT_DEMO"."DEV"."INT_TRADE_ENRICHED" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_trade_enriched"} */
[0m01:07:17.283121 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.463 seconds
[0m01:07:17.285618 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155bbf40>]}
[0m01:07:17.286418 [info ] [Thread-3  ]: 16 of 28 OK created sql view model DEV.int_valuation_enriched .................. [[32mSUCCESS 1[0m in 0.71s]
[0m01:07:17.287043 [debug] [Thread-3  ]: Finished running node model.bain_capital_analytics.int_valuation_enriched
[0m01:07:17.287465 [debug] [Thread-3  ]: Began running node model.bain_capital_analytics.fact_cashflow_waterfall
[0m01:07:17.288035 [info ] [Thread-3  ]: 21 of 28 START sql view model DEV.fact_cashflow_waterfall ...................... [RUN]
[0m01:07:17.288541 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_valuation_enriched, now model.bain_capital_analytics.fact_cashflow_waterfall)
[0m01:07:17.288872 [debug] [Thread-3  ]: Began compiling node model.bain_capital_analytics.fact_cashflow_waterfall
[0m01:07:17.292744 [debug] [Thread-3  ]: Writing injected SQL for node "model.bain_capital_analytics.fact_cashflow_waterfall"
[0m01:07:17.293703 [debug] [Thread-3  ]: Began executing node model.bain_capital_analytics.fact_cashflow_waterfall
[0m01:07:17.296709 [debug] [Thread-3  ]: Dropping relation "DBT_DEMO"."DEV"."FACT_CASHFLOW_WATERFALL" because it is of type table
[0m01:07:17.299065 [debug] [Thread-3  ]: Applying DROP to: "DBT_DEMO"."DEV"."FACT_CASHFLOW_WATERFALL"
[0m01:07:17.299788 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.fact_cashflow_waterfall"
[0m01:07:17.300116 [debug] [Thread-3  ]: On model.bain_capital_analytics.fact_cashflow_waterfall: drop table if exists "DBT_DEMO"."DEV"."FACT_CASHFLOW_WATERFALL" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_cashflow_waterfall"} */
[0m01:07:17.386916 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.223 seconds
[0m01:07:17.389277 [debug] [Thread-1  ]: Writing runtime sql for node "model.bain_capital_analytics.fact_trade_activity"
[0m01:07:17.392287 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.fact_trade_activity"
[0m01:07:17.392792 [debug] [Thread-1  ]: On model.bain_capital_analytics.fact_trade_activity: create or replace   view DBT_DEMO.DEV.fact_trade_activity
  
  
  
  
  as (
    -- Pipeline B: FACT table - Trade activity detail
-- Anti-pattern: repeats the SAME 3-table join as fact_portfolio_pnl and int_trade_enriched
-- Anti-pattern: could use int_trade_enriched but re-does everything

select
    t.trade_id,
    t.portfolio_id,
    t.instrument_id,
    t.counterparty_id,
    t.trade_date,
    t.settlement_date,
    t.trade_type,
    t.quantity,
    t.price,
    t.notional_amount,
    t.commission,
    t.currency,
    t.settlement_days,
    -- Anti-pattern: re-joining instruments (done in int_trade_enriched)
    i.instrument_name,
    i.instrument_type,
    i.sector,
    i.liquidity_class,
    -- Anti-pattern: re-joining counterparties (done in int_trade_enriched)
    c.counterparty_name,
    c.counterparty_type,
    c.credit_rating,
    -- Anti-pattern: re-joining portfolios (done in int_trade_enriched)
    p.portfolio_name,
    p.strategy,
    p.fund_id,
    p.manager_name,
    -- Anti-pattern: re-joining dates
    d.fiscal_quarter,
    d.fiscal_year,
    d.is_month_end,
    -- Anti-pattern: duplicated fiscal quarter logic
    case
        when month(t.trade_date) between 1 and 3 then 'Q3'
        when month(t.trade_date) between 4 and 6 then 'Q4'
        when month(t.trade_date) between 7 and 9 then 'Q1'
        when month(t.trade_date) between 10 and 12 then 'Q2'
    end as computed_fiscal_quarter,
    -- Anti-pattern: window functions recomputed (already in int_trade_enriched)
    sum(t.notional_amount) over (
        partition by t.portfolio_id
        order by t.trade_date
        rows between unbounded preceding and current row
    ) as running_notional,
    count(*) over (
        partition by t.portfolio_id, date_trunc('month', t.trade_date)
    ) as monthly_trade_count,
    sum(t.commission) over (
        partition by t.portfolio_id, date_trunc('month', t.trade_date)
    ) as monthly_commissions
from DBT_DEMO.DEV.stg_trades t
inner join DBT_DEMO.DEV.stg_instruments i
    on t.instrument_id = i.instrument_id
inner join DBT_DEMO.DEV.stg_counterparties c
    on t.counterparty_id = c.counterparty_id
inner join DBT_DEMO.DEV.stg_portfolios p
    on t.portfolio_id = p.portfolio_id
inner join DBT_DEMO.DEV.stg_dates d
    on t.trade_date = d.date_day
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_trade_activity"} */;
[0m01:07:17.446209 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.224 seconds
[0m01:07:17.448896 [debug] [Thread-2  ]: Writing runtime sql for node "model.bain_capital_analytics.int_trade_enriched"
[0m01:07:17.452182 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.int_trade_enriched"
[0m01:07:17.452780 [debug] [Thread-2  ]: On model.bain_capital_analytics.int_trade_enriched: create or replace   view DBT_DEMO.DEV.int_trade_enriched
  
  
  
  
  as (
    -- Pipeline B: Enriched trade data with instrument and counterparty details
-- Anti-pattern: subquery for dedup instead of QUALIFY (Snowflake)
-- Anti-pattern: heavy join that will be repeated in multiple downstream models

with latest_trades as (
    -- Anti-pattern: subquery to filter row_number instead of QUALIFY
    select *
    from (
        select
            t.*,
            i.instrument_name,
            i.instrument_type,
            i.sector,
            i.liquidity_class,
            c.counterparty_name,
            c.counterparty_type,
            c.credit_rating,
            p.portfolio_name,
            p.strategy,
            p.manager_name,
            -- Anti-pattern: duplicated fiscal quarter logic AGAIN
            case
                when extract(month from t.trade_date) between 1 and 3 then 'Q3'
                when extract(month from t.trade_date) between 4 and 6 then 'Q4'
                when extract(month from t.trade_date) between 7 and 9 then 'Q1'
                when extract(month from t.trade_date) between 10 and 12 then 'Q2'
            end as fiscal_quarter,
            row_number() over (
                partition by t.portfolio_id, t.instrument_id, t.trade_date
                order by t.trade_id desc
            ) as rn
        from DBT_DEMO.DEV.stg_trades t
        -- Anti-pattern: these 3 joins are repeated in fact_portfolio_pnl and fact_trade_activity
        inner join DBT_DEMO.DEV.stg_instruments i
            on t.instrument_id = i.instrument_id
        inner join DBT_DEMO.DEV.stg_counterparties c
            on t.counterparty_id = c.counterparty_id
        inner join DBT_DEMO.DEV.stg_portfolios p
            on t.portfolio_id = p.portfolio_id
    ) sub
    where rn = 1
)

select
    trade_id,
    portfolio_id,
    portfolio_name,
    strategy,
    manager_name,
    instrument_id,
    instrument_name,
    instrument_type,
    sector,
    liquidity_class,
    counterparty_id,
    counterparty_name,
    counterparty_type,
    credit_rating,
    trade_date,
    settlement_date,
    trade_type,
    quantity,
    price,
    notional_amount,
    commission,
    currency,
    fiscal_quarter,
    settlement_days,
    -- Anti-pattern: running total computed here AND again in downstream models
    sum(notional_amount) over (
        partition by portfolio_id
        order by trade_date
        rows between unbounded preceding and current row
    ) as cumulative_notional
from latest_trades
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_trade_enriched"} */;
[0m01:07:17.773543 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.910 seconds
[0m01:07:17.778235 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115850fd0>]}
[0m01:07:17.779676 [info ] [Thread-4  ]: 18 of 28 OK created sql view model DEV.int_daily_positions ..................... [[32mSUCCESS 1[0m in 1.15s]
[0m01:07:17.780678 [debug] [Thread-4  ]: Finished running node model.bain_capital_analytics.int_daily_positions
[0m01:07:17.781351 [debug] [Thread-4  ]: Began running node model.bain_capital_analytics.report_portfolio_overview
[0m01:07:17.782129 [info ] [Thread-4  ]: 22 of 28 START sql view model DEV.report_portfolio_overview .................... [RUN]
[0m01:07:17.782936 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_daily_positions, now model.bain_capital_analytics.report_portfolio_overview)
[0m01:07:17.783394 [debug] [Thread-4  ]: Began compiling node model.bain_capital_analytics.report_portfolio_overview
[0m01:07:17.788102 [debug] [Thread-4  ]: Writing injected SQL for node "model.bain_capital_analytics.report_portfolio_overview"
[0m01:07:17.789065 [debug] [Thread-4  ]: Began executing node model.bain_capital_analytics.report_portfolio_overview
[0m01:07:17.793090 [debug] [Thread-4  ]: Dropping relation "DBT_DEMO"."DEV"."REPORT_PORTFOLIO_OVERVIEW" because it is of type table
[0m01:07:17.795578 [debug] [Thread-4  ]: Applying DROP to: "DBT_DEMO"."DEV"."REPORT_PORTFOLIO_OVERVIEW"
[0m01:07:17.796239 [debug] [Thread-4  ]: Using snowflake connection "model.bain_capital_analytics.report_portfolio_overview"
[0m01:07:17.796562 [debug] [Thread-4  ]: On model.bain_capital_analytics.report_portfolio_overview: drop table if exists "DBT_DEMO"."DEV"."REPORT_PORTFOLIO_OVERVIEW" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_portfolio_overview"} */
[0m01:07:17.865576 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.565 seconds
[0m01:07:17.867481 [debug] [Thread-3  ]: Writing runtime sql for node "model.bain_capital_analytics.fact_cashflow_waterfall"
[0m01:07:17.870897 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.fact_cashflow_waterfall"
[0m01:07:17.871449 [debug] [Thread-3  ]: On model.bain_capital_analytics.fact_cashflow_waterfall: create or replace   view DBT_DEMO.DEV.fact_cashflow_waterfall
  
  
  
  
  as (
    -- Pipeline C: FACT table - Cashflow waterfall for PE/fund reporting
-- Anti-pattern: deep CTEs, repeated joins, late aggregation
-- Anti-pattern: PostgreSQL-specific date functions

with enriched_cashflows as (
    select
        ce.cashflow_id,
        ce.fund_id,
        ce.fund_name,
        ce.fund_type,
        ce.portfolio_id,
        ce.portfolio_name,
        ce.cashflow_date,
        ce.cashflow_type,
        ce.amount,
        ce.investor_id,
        ce.committed_capital,
        ce.management_fee_rate,
        ce.carry_rate,
        ce.hurdle_rate,
        ce.cumulative_called,
        ce.cumulative_distributed,
        ce.cumulative_net_cashflow,
        ce.pct_called,
        -- Anti-pattern: duplicated fiscal quarter logic
        case
            when month(ce.cashflow_date) between 1 and 3 then 'Q3'
            when month(ce.cashflow_date) between 4 and 6 then 'Q4'
            when month(ce.cashflow_date) between 7 and 9 then 'Q1'
            when month(ce.cashflow_date) between 10 and 12 then 'Q2'
        end as fiscal_quarter,
        -- Anti-pattern: PostgreSQL extract
        year(ce.cashflow_date) as calendar_year
    from DBT_DEMO.DEV.int_cashflow_enriched ce
),

-- Anti-pattern: re-joining valuations when int_valuation_enriched already has this
waterfall_with_nav as (
    select
        ecf.*,
        v.net_asset_value,
        v.gross_asset_value,
        v.unrealized_pnl as nav_unrealized_pnl,
        v.realized_pnl as nav_realized_pnl
    from enriched_cashflows ecf
    left join DBT_DEMO.DEV.stg_valuations v
        on ecf.portfolio_id = v.portfolio_id
        and ecf.cashflow_date = v.valuation_date
),

-- Anti-pattern: computing carry/waterfall in a CTE chain instead of a macro
waterfall_calculations as (
    select
        wn.*,
        -- Simplified carry calculation
        case
            when wn.cumulative_distributed > wn.cumulative_called * (1 + wn.hurdle_rate)
            then (wn.cumulative_distributed - wn.cumulative_called * (1 + wn.hurdle_rate)) * wn.carry_rate
            else 0
        end as estimated_carry,
        wn.cumulative_called * wn.management_fee_rate as annual_mgmt_fee,
        case
            when wn.cumulative_called > 0
            then wn.cumulative_distributed / wn.cumulative_called
            else 0
        end as dpi,
        case
            when wn.cumulative_called > 0 and wn.net_asset_value is not null
            then (wn.cumulative_distributed + wn.net_asset_value) / wn.cumulative_called
            else null
        end as tvpi
    from waterfall_with_nav wn
)

select * from waterfall_calculations
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_cashflow_waterfall"} */;
[0m01:07:17.952410 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.559 seconds
[0m01:07:17.955349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e492c40>]}
[0m01:07:17.956169 [info ] [Thread-1  ]: 19 of 28 OK created sql view model DEV.fact_trade_activity ..................... [[32mSUCCESS 1[0m in 0.81s]
[0m01:07:17.956739 [debug] [Thread-1  ]: Finished running node model.bain_capital_analytics.fact_trade_activity
[0m01:07:17.957149 [debug] [Thread-1  ]: Began running node model.bain_capital_analytics.fact_fund_performance
[0m01:07:17.957729 [info ] [Thread-1  ]: 23 of 28 START sql view model DEV.fact_fund_performance ........................ [RUN]
[0m01:07:17.958269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.fact_trade_activity, now model.bain_capital_analytics.fact_fund_performance)
[0m01:07:17.958673 [debug] [Thread-1  ]: Began compiling node model.bain_capital_analytics.fact_fund_performance
[0m01:07:17.963670 [debug] [Thread-1  ]: Writing injected SQL for node "model.bain_capital_analytics.fact_fund_performance"
[0m01:07:17.964627 [debug] [Thread-1  ]: Began executing node model.bain_capital_analytics.fact_fund_performance
[0m01:07:17.967683 [debug] [Thread-1  ]: Dropping relation "DBT_DEMO"."DEV"."FACT_FUND_PERFORMANCE" because it is of type table
[0m01:07:17.970034 [debug] [Thread-1  ]: Applying DROP to: "DBT_DEMO"."DEV"."FACT_FUND_PERFORMANCE"
[0m01:07:17.970728 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.fact_fund_performance"
[0m01:07:17.971048 [debug] [Thread-1  ]: On model.bain_capital_analytics.fact_fund_performance: drop table if exists "DBT_DEMO"."DEV"."FACT_FUND_PERFORMANCE" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_fund_performance"} */
[0m01:07:18.002599 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.206 seconds
[0m01:07:18.004220 [debug] [Thread-4  ]: Writing runtime sql for node "model.bain_capital_analytics.report_portfolio_overview"
[0m01:07:18.006203 [debug] [Thread-4  ]: Using snowflake connection "model.bain_capital_analytics.report_portfolio_overview"
[0m01:07:18.006587 [debug] [Thread-4  ]: On model.bain_capital_analytics.report_portfolio_overview: create or replace   view DBT_DEMO.DEV.report_portfolio_overview
  
  
  
  
  as (
    -- Pipeline A: REPORT table - Portfolio overview for management reporting
-- Anti-pattern: re-aggregates from fact instead of using fact directly in some cases
-- Anti-pattern: subquery instead of QUALIFY for latest date

select
    fps.portfolio_id,
    fps.portfolio_name,
    fps.strategy,
    fps.manager_name,
    fps.position_date as reporting_date,
    fps.num_positions,
    fps.total_market_value,
    fps.total_cost_basis,
    fps.total_unrealized_pnl,
    fps.portfolio_return_pct,
    fps.largest_position_mv,
    fps.smallest_position_mv,
    -- Anti-pattern: duplicated fiscal quarter logic AGAIN
    case
        when month(fps.position_date) between 1 and 3 then 'Q3'
        when month(fps.position_date) between 4 and 6 then 'Q4'
        when month(fps.position_date) between 7 and 9 then 'Q1'
        when month(fps.position_date) between 10 and 12 then 'Q2'
    end as fiscal_quarter,
    case
        when month(fps.position_date) >= 7
        then year(fps.position_date) + 1
        else year(fps.position_date)
    end as fiscal_year
from DBT_DEMO.DEV.fact_portfolio_summary fps
where fps.position_date = (
    -- Anti-pattern: correlated subquery instead of window function / QUALIFY
    select max(fps2.position_date)
    from DBT_DEMO.DEV.fact_portfolio_summary fps2
    where fps2.portfolio_id = fps.portfolio_id
)
order by fps.total_market_value desc
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_portfolio_overview"} */;
[0m01:07:18.207126 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.754 seconds
[0m01:07:18.211434 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115777190>]}
[0m01:07:18.212613 [info ] [Thread-2  ]: 20 of 28 OK created sql view model DEV.int_trade_enriched ...................... [[32mSUCCESS 1[0m in 1.00s]
[0m01:07:18.213305 [debug] [Thread-2  ]: Finished running node model.bain_capital_analytics.int_trade_enriched
[0m01:07:18.213779 [debug] [Thread-2  ]: Began running node model.bain_capital_analytics.report_lp_quarterly
[0m01:07:18.214401 [info ] [Thread-2  ]: 24 of 28 START sql view model DEV.report_lp_quarterly .......................... [RUN]
[0m01:07:18.214936 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_trade_enriched, now model.bain_capital_analytics.report_lp_quarterly)
[0m01:07:18.215316 [debug] [Thread-2  ]: Began compiling node model.bain_capital_analytics.report_lp_quarterly
[0m01:07:18.224245 [debug] [Thread-2  ]: Writing injected SQL for node "model.bain_capital_analytics.report_lp_quarterly"
[0m01:07:18.226534 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.255 seconds
[0m01:07:18.228894 [debug] [Thread-1  ]: Writing runtime sql for node "model.bain_capital_analytics.fact_fund_performance"
[0m01:07:18.230562 [debug] [Thread-2  ]: Began executing node model.bain_capital_analytics.report_lp_quarterly
[0m01:07:18.233270 [debug] [Thread-1  ]: Using snowflake connection "model.bain_capital_analytics.fact_fund_performance"
[0m01:07:18.236797 [debug] [Thread-2  ]: Dropping relation "DBT_DEMO"."DEV"."REPORT_LP_QUARTERLY" because it is of type table
[0m01:07:18.237268 [debug] [Thread-1  ]: On model.bain_capital_analytics.fact_fund_performance: create or replace   view DBT_DEMO.DEV.fact_fund_performance
  
  
  
  
  as (
    -- Pipeline C: FACT table - Fund-level performance metrics
-- Anti-pattern: late aggregation - joins everything then aggregates
-- Anti-pattern: re-joins fund_structures (already in int_fund_nav, int_cashflow_enriched)
-- Anti-pattern: materialized as view (should be table)

with fund_nav_data as (
    select
        fn.fund_id,
        fn.fund_name,
        fn.fund_type,
        fn.committed_capital,
        fn.valuation_date,
        fn.fund_nav,
        fn.fund_gav,
        fn.fund_total_liabilities,
        fn.fund_unrealized_pnl,
        fn.fund_realized_pnl,
        fn.fund_nav_return,
        fn.tvpi_gross,
        fn.num_portfolios
    from DBT_DEMO.DEV.int_fund_nav fn
),

fund_cashflows as (
    -- Anti-pattern: re-aggregating cashflows that are already in int_cashflow_enriched
    select
        cf.fund_id,
        cf.cashflow_date,
        sum(case when cf.cashflow_type = 'capital_call' then cf.amount else 0 end) as period_calls,
        sum(case when cf.cashflow_type = 'distribution' then cf.amount else 0 end) as period_distributions,
        sum(case when cf.cashflow_type = 'management_fee' then cf.amount else 0 end) as period_fees,
        sum(cf.amount) as period_net_cashflow
    from DBT_DEMO.DEV.stg_cashflows cf
    group by cf.fund_id, cf.cashflow_date
),

fund_irr as (
    select
        irr.fund_id,
        sum(irr.total_invested) as fund_total_invested,
        sum(irr.total_distributed) as fund_total_distributed,
        sum(irr.terminal_value) as fund_terminal_value,
        -- Anti-pattern: averaging portfolio IRRs as proxy for fund IRR (incorrect but intentional)
        avg(irr.approx_irr) as fund_approx_irr,
        avg(irr.tvpi) as fund_tvpi,
        avg(irr.dpi) as fund_dpi
    from DBT_DEMO.DEV.int_irr_calculations irr
    group by irr.fund_id
),

-- Anti-pattern: joining everything together at the end
combined as (
    select
        fn.fund_id,
        fn.fund_name,
        fn.fund_type,
        fn.committed_capital,
        fn.valuation_date,
        fn.fund_nav,
        fn.fund_gav,
        fn.fund_total_liabilities,
        fn.fund_unrealized_pnl,
        fn.fund_realized_pnl,
        fn.fund_nav_return,
        fn.tvpi_gross,
        fn.num_portfolios,
        coalesce(fc.period_calls, 0) as period_calls,
        coalesce(fc.period_distributions, 0) as period_distributions,
        coalesce(fc.period_fees, 0) as period_fees,
        coalesce(fc.period_net_cashflow, 0) as period_net_cashflow,
        fi.fund_total_invested,
        fi.fund_total_distributed,
        fi.fund_approx_irr,
        fi.fund_tvpi,
        fi.fund_dpi
    from fund_nav_data fn
    left join fund_cashflows fc
        on fn.fund_id = fc.fund_id
        and fn.valuation_date = fc.cashflow_date
    left join fund_irr fi
        on fn.fund_id = fi.fund_id
)

select * from combined
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_fund_performance"} */;
[0m01:07:18.239803 [debug] [Thread-2  ]: Applying DROP to: "DBT_DEMO"."DEV"."REPORT_LP_QUARTERLY"
[0m01:07:18.240847 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.report_lp_quarterly"
[0m01:07:18.241262 [debug] [Thread-2  ]: On model.bain_capital_analytics.report_lp_quarterly: drop table if exists "DBT_DEMO"."DEV"."REPORT_LP_QUARTERLY" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_lp_quarterly"} */
[0m01:07:18.562699 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.321 seconds
[0m01:07:18.566112 [debug] [Thread-2  ]: Writing runtime sql for node "model.bain_capital_analytics.report_lp_quarterly"
[0m01:07:18.568045 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.561 seconds
[0m01:07:18.570907 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115850fd0>]}
[0m01:07:18.575642 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.report_lp_quarterly"
[0m01:07:18.577031 [debug] [Thread-2  ]: On model.bain_capital_analytics.report_lp_quarterly: create or replace   view DBT_DEMO.DEV.report_lp_quarterly
  
  
  
  
  as (
    -- Pipeline C: REPORT table - LP quarterly reporting
-- Anti-pattern: massive query, duplicated logic, no reuse of intermediates
-- Anti-pattern: PostgreSQL-specific date_trunc
-- Anti-pattern: re-aggregation of data already aggregated upstream

with quarterly_cashflows as (
    -- Anti-pattern: re-aggregating cashflows by quarter (already in int_cashflow_enriched)
    select
        cf.fund_id,
        cf.portfolio_id,
        -- Anti-pattern: PostgreSQL-specific date_trunc
        date_trunc('quarter', cf.cashflow_date) as quarter_start,
        cf.cashflow_fiscal_quarter as fiscal_quarter,
        cf.cashflow_year,
        sum(case when cf.cashflow_type = 'capital_call' then cf.amount else 0 end) as quarter_calls,
        sum(case when cf.cashflow_type = 'distribution' then cf.amount else 0 end) as quarter_distributions,
        sum(case when cf.cashflow_type = 'management_fee' then cf.amount else 0 end) as quarter_fees,
        sum(cf.amount) as quarter_net
    from DBT_DEMO.DEV.stg_cashflows cf
    group by
        cf.fund_id, cf.portfolio_id,
        date_trunc('quarter', cf.cashflow_date),
        cf.cashflow_fiscal_quarter, cf.cashflow_year
),

quarterly_valuations as (
    -- Anti-pattern: re-querying valuations with subquery for quarter-end
    select *
    from (
        select
            v.portfolio_id,
            v.valuation_date,
            v.net_asset_value,
            v.gross_asset_value,
            v.unrealized_pnl,
            v.realized_pnl,
            v.valuation_method,
            -- Anti-pattern: subquery dedup instead of QUALIFY
            row_number() over (
                partition by v.portfolio_id, date_trunc('quarter', v.valuation_date)
                order by v.valuation_date desc
            ) as rn
        from DBT_DEMO.DEV.stg_valuations v
    ) sub
    where rn = 1
),

-- Anti-pattern: re-joining fund structures (done in multiple places)
fund_details as (
    select
        fs.fund_id,
        fs.fund_name,
        fs.fund_type,
        fs.committed_capital,
        fs.management_fee_rate,
        fs.carry_rate,
        fs.hurdle_rate,
        fs.vintage_year,
        fs.gp_commitment_pct
    from DBT_DEMO.DEV.stg_fund_structures fs
),

-- Anti-pattern: joining everything at the end
lp_report as (
    select
        fd.fund_id,
        fd.fund_name,
        fd.fund_type,
        fd.vintage_year,
        fd.committed_capital,
        fd.management_fee_rate,
        fd.carry_rate,
        fd.hurdle_rate,
        fd.gp_commitment_pct,
        qc.portfolio_id,
        p.portfolio_name,
        p.strategy,
        qc.quarter_start,
        qc.fiscal_quarter,
        qc.cashflow_year,
        qc.quarter_calls,
        qc.quarter_distributions,
        qc.quarter_fees,
        qc.quarter_net,
        qv.net_asset_value as quarter_end_nav,
        qv.gross_asset_value as quarter_end_gav,
        qv.unrealized_pnl,
        qv.realized_pnl,
        qv.valuation_method,
        -- Anti-pattern: IRR re-joined from separate calculation
        irr.approx_irr,
        irr.tvpi,
        irr.dpi,
        irr.rvpi
    from quarterly_cashflows qc
    inner join fund_details fd
        on qc.fund_id = fd.fund_id
    inner join DBT_DEMO.DEV.stg_portfolios p
        on qc.portfolio_id = p.portfolio_id
    left join quarterly_valuations qv
        on qc.portfolio_id = qv.portfolio_id
        and date_trunc('quarter', qv.valuation_date) = qc.quarter_start
    left join DBT_DEMO.DEV.int_irr_calculations irr
        on qc.fund_id = irr.fund_id
        and qc.portfolio_id = irr.portfolio_id
)

select
    *,
    -- Anti-pattern: computed columns in final select
    case
        when committed_capital > 0
        then quarter_calls / committed_capital
        else 0
    end as quarterly_drawdown_rate,
    case
        when quarter_end_nav is not null and committed_capital > 0
        then quarter_end_nav / committed_capital
        else null
    end as nav_to_commitment_ratio
from lp_report
order by fund_id, portfolio_id, quarter_start
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_lp_quarterly"} */;
[0m01:07:18.576486 [info ] [Thread-4  ]: 22 of 28 OK created sql view model DEV.report_portfolio_overview ............... [[32mSUCCESS 1[0m in 0.79s]
[0m01:07:18.578017 [debug] [Thread-4  ]: Finished running node model.bain_capital_analytics.report_portfolio_overview
[0m01:07:18.578645 [debug] [Thread-4  ]: Began running node model.bain_capital_analytics.fact_portfolio_attribution
[0m01:07:18.579267 [info ] [Thread-4  ]: 25 of 28 START sql view model DEV.fact_portfolio_attribution ................... [RUN]
[0m01:07:18.579866 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.report_portfolio_overview, now model.bain_capital_analytics.fact_portfolio_attribution)
[0m01:07:18.580215 [debug] [Thread-4  ]: Began compiling node model.bain_capital_analytics.fact_portfolio_attribution
[0m01:07:18.584204 [debug] [Thread-4  ]: Writing injected SQL for node "model.bain_capital_analytics.fact_portfolio_attribution"
[0m01:07:18.585348 [debug] [Thread-4  ]: Began executing node model.bain_capital_analytics.fact_portfolio_attribution
[0m01:07:18.588400 [debug] [Thread-4  ]: Dropping relation "DBT_DEMO"."DEV"."FACT_PORTFOLIO_ATTRIBUTION" because it is of type table
[0m01:07:18.591913 [debug] [Thread-4  ]: Applying DROP to: "DBT_DEMO"."DEV"."FACT_PORTFOLIO_ATTRIBUTION"
[0m01:07:18.685470 [debug] [Thread-4  ]: Using snowflake connection "model.bain_capital_analytics.fact_portfolio_attribution"
[0m01:07:18.686090 [debug] [Thread-4  ]: On model.bain_capital_analytics.fact_portfolio_attribution: drop table if exists "DBT_DEMO"."DEV"."FACT_PORTFOLIO_ATTRIBUTION" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_portfolio_attribution"} */
[0m01:07:18.760742 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.889 seconds
[0m01:07:18.762625 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a38e50>]}
[0m01:07:18.763199 [info ] [Thread-3  ]: 21 of 28 OK created sql view model DEV.fact_cashflow_waterfall ................. [[32mSUCCESS 1[0m in 1.47s]
[0m01:07:18.763683 [debug] [Thread-3  ]: Finished running node model.bain_capital_analytics.fact_cashflow_waterfall
[0m01:07:18.764021 [debug] [Thread-3  ]: Began running node model.bain_capital_analytics.fact_portfolio_pnl
[0m01:07:18.764463 [info ] [Thread-3  ]: 26 of 28 START sql view model DEV.fact_portfolio_pnl ........................... [RUN]
[0m01:07:18.764858 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.fact_cashflow_waterfall, now model.bain_capital_analytics.fact_portfolio_pnl)
[0m01:07:18.765171 [debug] [Thread-3  ]: Began compiling node model.bain_capital_analytics.fact_portfolio_pnl
[0m01:07:18.769208 [debug] [Thread-3  ]: Writing injected SQL for node "model.bain_capital_analytics.fact_portfolio_pnl"
[0m01:07:18.769889 [debug] [Thread-3  ]: Began executing node model.bain_capital_analytics.fact_portfolio_pnl
[0m01:07:18.772639 [debug] [Thread-3  ]: Dropping relation "DBT_DEMO"."DEV"."FACT_PORTFOLIO_PNL" because it is of type table
[0m01:07:18.774938 [debug] [Thread-3  ]: Applying DROP to: "DBT_DEMO"."DEV"."FACT_PORTFOLIO_PNL"
[0m01:07:18.775530 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.fact_portfolio_pnl"
[0m01:07:18.775842 [debug] [Thread-3  ]: On model.bain_capital_analytics.fact_portfolio_pnl: drop table if exists "DBT_DEMO"."DEV"."FACT_PORTFOLIO_PNL" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_portfolio_pnl"} */
[0m01:07:18.959490 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.273 seconds
[0m01:07:18.962689 [debug] [Thread-4  ]: Writing runtime sql for node "model.bain_capital_analytics.fact_portfolio_attribution"
[0m01:07:18.966467 [debug] [Thread-4  ]: Using snowflake connection "model.bain_capital_analytics.fact_portfolio_attribution"
[0m01:07:18.967098 [debug] [Thread-4  ]: On model.bain_capital_analytics.fact_portfolio_attribution: create or replace   view DBT_DEMO.DEV.fact_portfolio_attribution
  
  
  
  
  as (
    -- Pipeline C: FACT table - Portfolio attribution with benchmark comparison
-- Anti-pattern: re-joins data that's already in intermediate models
-- Anti-pattern: repeated computation of sector weights

with attribution as (
    select
        pa.portfolio_id,
        pa.portfolio_name,
        pa.strategy,
        pa.fund_id,
        pa.position_date,
        pa.sector,
        pa.sector_mv,
        pa.sector_ugl,
        pa.num_instruments,
        pa.total_portfolio_mv,
        pa.total_portfolio_ugl,
        pa.sector_weight,
        pa.sector_contribution
    from DBT_DEMO.DEV.int_portfolio_attribution pa
),

-- Anti-pattern: re-joining benchmarks (could be done in intermediate)
attribution_with_benchmark as (
    select
        a.*,
        bm.benchmark_name,
        bm.return_mtd as benchmark_return,
        bm.rolling_3m_return as benchmark_3m_return,
        bm.rolling_12m_return as benchmark_12m_return
    from attribution a
    left join DBT_DEMO.DEV.int_benchmark_returns bm
        on a.position_date = bm.benchmark_date
        and bm.benchmark_id = 'BM_SP500'
),

-- Anti-pattern: computing alpha in yet another CTE
attribution_with_alpha as (
    select
        ab.*,
        -- Simplified active return
        case
            when ab.total_portfolio_mv != 0
            then (ab.sector_ugl / ab.total_portfolio_mv) - coalesce(ab.benchmark_return, 0) * ab.sector_weight
            else 0
        end as sector_active_return,
        -- Anti-pattern: re-computing portfolio-level return here
        case
            when ab.total_portfolio_mv != 0
            then ab.total_portfolio_ugl / ab.total_portfolio_mv
            else 0
        end as portfolio_return
    from attribution_with_benchmark ab
)

select * from attribution_with_alpha
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_portfolio_attribution"} */;
[0m01:07:19.058368 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.282 seconds
[0m01:07:19.061826 [debug] [Thread-3  ]: Writing runtime sql for node "model.bain_capital_analytics.fact_portfolio_pnl"
[0m01:07:19.066634 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.fact_portfolio_pnl"
[0m01:07:19.067315 [debug] [Thread-3  ]: On model.bain_capital_analytics.fact_portfolio_pnl: create or replace   view DBT_DEMO.DEV.fact_portfolio_pnl
  
  
  
  
  as (
    -- Pipeline B: FACT table - Portfolio PnL by date
-- Anti-pattern: repeats the same heavy 3-table join as int_trade_enriched
-- Anti-pattern: late aggregation after expensive joins
-- Anti-pattern: materialized as view (should be table/incremental)

with trade_pnl as (
    -- Anti-pattern: re-joining trades to instruments and portfolios
    -- (same join already done in int_trade_enriched)
    select
        t.portfolio_id,
        t.trade_date,
        t.instrument_id,
        t.trade_type,
        t.notional_amount,
        t.commission,
        i.instrument_name,
        i.instrument_type,
        i.sector,
        p.portfolio_name,
        p.strategy,
        p.fund_id,
        d.fiscal_quarter,
        d.fiscal_year,
        d.is_month_end,
        d.is_quarter_end
    from DBT_DEMO.DEV.stg_trades t
    inner join DBT_DEMO.DEV.stg_instruments i
        on t.instrument_id = i.instrument_id
    inner join DBT_DEMO.DEV.stg_portfolios p
        on t.portfolio_id = p.portfolio_id
    inner join DBT_DEMO.DEV.stg_dates d
        on t.trade_date = d.date_day
),

position_pnl as (
    select
        dp.portfolio_id,
        dp.position_date,
        dp.portfolio_name,
        dp.strategy,
        dp.fund_id,
        dp.fiscal_quarter,
        dp.fiscal_year,
        sum(dp.daily_pnl) as position_daily_pnl,
        sum(dp.market_value) as total_market_value,
        count(distinct dp.instrument_id) as num_positions
    from DBT_DEMO.DEV.int_daily_positions dp
    group by
        dp.portfolio_id, dp.position_date, dp.portfolio_name,
        dp.strategy, dp.fund_id, dp.fiscal_quarter, dp.fiscal_year
),

-- Anti-pattern: aggregating trades separately then joining back
trade_activity as (
    select
        portfolio_id,
        trade_date,
        sum(notional_amount) as total_traded_notional,
        sum(commission) as total_commissions,
        count(*) as num_trades
    from trade_pnl
    group by portfolio_id, trade_date
)

select
    pp.portfolio_id,
    pp.portfolio_name,
    pp.strategy,
    pp.fund_id,
    pp.position_date as pnl_date,
    pp.fiscal_quarter,
    pp.fiscal_year,
    pp.position_daily_pnl,
    pp.total_market_value,
    pp.num_positions,
    coalesce(ta.total_traded_notional, 0) as total_traded_notional,
    coalesce(ta.total_commissions, 0) as total_commissions,
    coalesce(ta.num_trades, 0) as num_trades,
    -- Anti-pattern: running total recomputed here (already in int_trade_enriched)
    sum(pp.position_daily_pnl) over (
        partition by pp.portfolio_id
        order by pp.position_date
        rows between unbounded preceding and current row
    ) as cumulative_pnl
from position_pnl pp
left join trade_activity ta
    on pp.portfolio_id = ta.portfolio_id
    and pp.position_date = ta.trade_date
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_portfolio_pnl"} */;
[0m01:07:19.232026 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.992 seconds
[0m01:07:19.236246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158a73a0>]}
[0m01:07:19.240544 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.663 seconds
[0m01:07:19.243820 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159f88b0>]}
[0m01:07:19.799133 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.831 seconds
[0m01:07:19.804251 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115850fd0>]}
[0m01:07:19.911184 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.843 seconds
[0m01:07:19.915651 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115963c10>]}
[0m01:07:24.077675 [debug] [Thread-1  ]: An error was encountered while trying to send an event
[0m01:07:24.079230 [info ] [Thread-2  ]: 24 of 28 OK created sql view model DEV.report_lp_quarterly ..................... [[32mSUCCESS 1[0m in 1.03s]
[0m01:07:24.080328 [info ] [Thread-4  ]: 25 of 28 OK created sql view model DEV.fact_portfolio_attribution .............. [[32mSUCCESS 1[0m in 1.22s]
[0m01:07:24.081216 [info ] [Thread-3  ]: 26 of 28 OK created sql view model DEV.fact_portfolio_pnl ...................... [[32mSUCCESS 1[0m in 1.15s]
[0m01:07:24.083154 [info ] [Thread-1  ]: 23 of 28 OK created sql view model DEV.fact_fund_performance ................... [[32mSUCCESS 1[0m in 1.28s]
[0m01:07:24.084172 [debug] [Thread-2  ]: Finished running node model.bain_capital_analytics.report_lp_quarterly
[0m01:07:24.084846 [debug] [Thread-4  ]: Finished running node model.bain_capital_analytics.fact_portfolio_attribution
[0m01:07:24.085457 [debug] [Thread-3  ]: Finished running node model.bain_capital_analytics.fact_portfolio_pnl
[0m01:07:24.086077 [debug] [Thread-1  ]: Finished running node model.bain_capital_analytics.fact_fund_performance
[0m01:07:24.087259 [debug] [Thread-2  ]: Began running node model.bain_capital_analytics.report_daily_pnl
[0m01:07:24.087996 [info ] [Thread-2  ]: 27 of 28 START sql view model DEV.report_daily_pnl ............................. [RUN]
[0m01:07:24.088828 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.report_lp_quarterly, now model.bain_capital_analytics.report_daily_pnl)
[0m01:07:24.089276 [debug] [Thread-3  ]: Began running node model.bain_capital_analytics.report_ic_dashboard
[0m01:07:24.089654 [debug] [Thread-2  ]: Began compiling node model.bain_capital_analytics.report_daily_pnl
[0m01:07:24.090158 [info ] [Thread-3  ]: 28 of 28 START sql view model DEV.report_ic_dashboard .......................... [RUN]
[0m01:07:24.097229 [debug] [Thread-2  ]: Writing injected SQL for node "model.bain_capital_analytics.report_daily_pnl"
[0m01:07:24.097900 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.fact_portfolio_pnl, now model.bain_capital_analytics.report_ic_dashboard)
[0m01:07:24.098511 [debug] [Thread-3  ]: Began compiling node model.bain_capital_analytics.report_ic_dashboard
[0m01:07:24.104639 [debug] [Thread-3  ]: Writing injected SQL for node "model.bain_capital_analytics.report_ic_dashboard"
[0m01:07:24.105326 [debug] [Thread-2  ]: Began executing node model.bain_capital_analytics.report_daily_pnl
[0m01:07:24.108396 [debug] [Thread-2  ]: Dropping relation "DBT_DEMO"."DEV"."REPORT_DAILY_PNL" because it is of type table
[0m01:07:24.110936 [debug] [Thread-2  ]: Applying DROP to: "DBT_DEMO"."DEV"."REPORT_DAILY_PNL"
[0m01:07:24.111641 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.report_daily_pnl"
[0m01:07:24.112004 [debug] [Thread-2  ]: On model.bain_capital_analytics.report_daily_pnl: drop table if exists "DBT_DEMO"."DEV"."REPORT_DAILY_PNL" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_daily_pnl"} */
[0m01:07:24.112465 [debug] [Thread-3  ]: Began executing node model.bain_capital_analytics.report_ic_dashboard
[0m01:07:24.115330 [debug] [Thread-3  ]: Dropping relation "DBT_DEMO"."DEV"."REPORT_IC_DASHBOARD" because it is of type table
[0m01:07:24.117806 [debug] [Thread-3  ]: Applying DROP to: "DBT_DEMO"."DEV"."REPORT_IC_DASHBOARD"
[0m01:07:24.118437 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.report_ic_dashboard"
[0m01:07:24.118777 [debug] [Thread-3  ]: On model.bain_capital_analytics.report_ic_dashboard: drop table if exists "DBT_DEMO"."DEV"."REPORT_IC_DASHBOARD" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_ic_dashboard"} */
[0m01:07:24.520934 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.401 seconds
[0m01:07:24.523273 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.411 seconds
[0m01:07:24.525658 [debug] [Thread-3  ]: Writing runtime sql for node "model.bain_capital_analytics.report_ic_dashboard"
[0m01:07:24.527779 [debug] [Thread-2  ]: Writing runtime sql for node "model.bain_capital_analytics.report_daily_pnl"
[0m01:07:24.531123 [debug] [Thread-2  ]: Using snowflake connection "model.bain_capital_analytics.report_daily_pnl"
[0m01:07:24.534971 [debug] [Thread-3  ]: Using snowflake connection "model.bain_capital_analytics.report_ic_dashboard"
[0m01:07:24.535442 [debug] [Thread-2  ]: On model.bain_capital_analytics.report_daily_pnl: create or replace   view DBT_DEMO.DEV.report_daily_pnl
  
  
  
  
  as (
    -- Pipeline B: REPORT table - Daily PnL report for portfolio managers
-- Anti-pattern: subquery for latest-only instead of QUALIFY
-- Anti-pattern: re-aggregation from fact that's already aggregated

with latest_pnl as (
    select *
    from (
        select
            fpnl.*,
            -- Anti-pattern: subquery dedup instead of QUALIFY
            row_number() over (
                partition by fpnl.portfolio_id
                order by fpnl.pnl_date desc
            ) as rn
        from DBT_DEMO.DEV.fact_portfolio_pnl fpnl
    ) sub
    where rn <= 5  -- last 5 dates per portfolio
),

-- Anti-pattern: re-joining to get benchmark data that should be part of the pipeline
pnl_with_benchmark as (
    select
        lp.*,
        bm.return_mtd as benchmark_return_mtd,
        bm.return_ytd as benchmark_return_ytd,
        bm.benchmark_name
    from latest_pnl lp
    left join DBT_DEMO.DEV.stg_benchmarks bm
        on lp.pnl_date = bm.benchmark_date
        and bm.benchmark_id = 'BM_SP500'
)

select
    portfolio_id,
    portfolio_name,
    strategy,
    pnl_date,
    fiscal_quarter,
    position_daily_pnl,
    cumulative_pnl,
    total_market_value,
    num_positions,
    total_traded_notional,
    total_commissions,
    num_trades,
    benchmark_name,
    benchmark_return_mtd,
    benchmark_return_ytd,
    -- Anti-pattern: computing return inline instead of upstream
    case
        when total_market_value != 0
        then position_daily_pnl / total_market_value
        else 0
    end as daily_return_pct
from pnl_with_benchmark
order by portfolio_id, pnl_date desc
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_daily_pnl"} */;
[0m01:07:24.536036 [debug] [Thread-3  ]: On model.bain_capital_analytics.report_ic_dashboard: create or replace   view DBT_DEMO.DEV.report_ic_dashboard
  
  
  
  
  as (
    -- Pipeline C: REPORT table - Investment Committee dashboard
-- Anti-pattern: massive query joining many sources, no intermediate reuse
-- Anti-pattern: subquery for latest records instead of QUALIFY
-- Anti-pattern: duplicated logic from other reports

with latest_fund_performance as (
    select *
    from (
        select
            fp.*,
            -- Anti-pattern: subquery dedup instead of QUALIFY
            row_number() over (
                partition by fp.fund_id
                order by fp.valuation_date desc
            ) as rn
        from DBT_DEMO.DEV.fact_fund_performance fp
    ) sub
    where rn = 1
),

latest_portfolio_summary as (
    select *
    from (
        select
            ps.*,
            row_number() over (
                partition by ps.portfolio_id
                order by ps.position_date desc
            ) as rn
        from DBT_DEMO.DEV.fact_portfolio_summary ps
    ) sub
    where rn = 1
),

-- Anti-pattern: re-joining fund structures (already in fact_fund_performance)
fund_overview as (
    select
        lfp.fund_id,
        lfp.fund_name,
        lfp.fund_type,
        lfp.committed_capital,
        lfp.valuation_date as latest_valuation_date,
        lfp.fund_nav,
        lfp.fund_gav,
        lfp.fund_nav_return as latest_nav_return,
        lfp.tvpi_gross,
        lfp.fund_approx_irr,
        lfp.fund_tvpi,
        lfp.fund_dpi,
        lfp.num_portfolios,
        lfp.fund_total_invested,
        lfp.fund_total_distributed,
        -- Anti-pattern: re-joining fund structures
        fs.management_fee_rate,
        fs.carry_rate,
        fs.hurdle_rate,
        fs.vintage_year
    from latest_fund_performance lfp
    inner join DBT_DEMO.DEV.stg_fund_structures fs
        on lfp.fund_id = fs.fund_id
),

portfolio_details as (
    select
        lps.portfolio_id,
        lps.portfolio_name,
        lps.strategy,
        lps.fund_id,
        lps.total_market_value,
        lps.total_unrealized_pnl,
        lps.portfolio_return_pct,
        lps.num_positions,
        -- Anti-pattern: re-computing fiscal quarter
        case
            when month(lps.position_date) between 1 and 3 then 'Q3'
            when month(lps.position_date) between 4 and 6 then 'Q4'
            when month(lps.position_date) between 7 and 9 then 'Q1'
            when month(lps.position_date) between 10 and 12 then 'Q2'
        end as reporting_fiscal_quarter
    from latest_portfolio_summary lps
)

select
    fo.fund_id,
    fo.fund_name,
    fo.fund_type,
    fo.vintage_year,
    fo.committed_capital,
    fo.latest_valuation_date,
    fo.fund_nav,
    fo.fund_gav,
    fo.latest_nav_return,
    fo.tvpi_gross,
    fo.fund_approx_irr,
    fo.fund_tvpi,
    fo.fund_dpi,
    fo.num_portfolios,
    fo.fund_total_invested,
    fo.fund_total_distributed,
    fo.management_fee_rate,
    fo.carry_rate,
    fo.hurdle_rate,
    pd.portfolio_id,
    pd.portfolio_name,
    pd.strategy,
    pd.total_market_value as portfolio_mv,
    pd.total_unrealized_pnl as portfolio_unrealized_pnl,
    pd.portfolio_return_pct,
    pd.num_positions as portfolio_num_positions,
    pd.reporting_fiscal_quarter
from fund_overview fo
inner join portfolio_details pd
    on fo.fund_id = pd.fund_id
order by fo.fund_nav desc, pd.total_market_value desc
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_ic_dashboard"} */;
[0m01:07:25.261905 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.725 seconds
[0m01:07:25.270326 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115850fd0>]}
[0m01:07:25.271814 [info ] [Thread-2  ]: 27 of 28 OK created sql view model DEV.report_daily_pnl ........................ [[32mSUCCESS 1[0m in 1.18s]
[0m01:07:25.272580 [debug] [Thread-2  ]: Finished running node model.bain_capital_analytics.report_daily_pnl
[0m01:07:25.294467 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.758 seconds
[0m01:07:25.298069 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09509d6f-2ec2-48e2-bef7-1c199140b742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a7f3a0>]}
[0m01:07:25.299016 [info ] [Thread-3  ]: 28 of 28 OK created sql view model DEV.report_ic_dashboard ..................... [[32mSUCCESS 1[0m in 1.20s]
[0m01:07:25.299995 [debug] [Thread-3  ]: Finished running node model.bain_capital_analytics.report_ic_dashboard
[0m01:07:25.301610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:25.302090 [debug] [MainThread]: Connection 'model.bain_capital_analytics.fact_fund_performance' was left open.
[0m01:07:25.302479 [debug] [MainThread]: On model.bain_capital_analytics.fact_fund_performance: Close
[0m01:07:25.767231 [debug] [MainThread]: Connection 'model.bain_capital_analytics.report_daily_pnl' was left open.
[0m01:07:25.767661 [debug] [MainThread]: On model.bain_capital_analytics.report_daily_pnl: Close
[0m01:07:26.076712 [debug] [MainThread]: Connection 'model.bain_capital_analytics.report_ic_dashboard' was left open.
[0m01:07:26.077715 [debug] [MainThread]: On model.bain_capital_analytics.report_ic_dashboard: Close
[0m01:07:26.412358 [debug] [MainThread]: Connection 'model.bain_capital_analytics.fact_portfolio_attribution' was left open.
[0m01:07:26.413494 [debug] [MainThread]: On model.bain_capital_analytics.fact_portfolio_attribution: Close
[0m01:07:26.725330 [info ] [MainThread]: 
[0m01:07:26.726284 [info ] [MainThread]: Finished running 28 view models in 0 hours 0 minutes and 20.99 seconds (20.99s).
[0m01:07:26.731872 [debug] [MainThread]: Command end result
[0m01:07:26.778424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/manifest.json
[0m01:07:26.780140 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/semantic_manifest.json
[0m01:07:26.787033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/run_results.json
[0m01:07:26.787357 [info ] [MainThread]: 
[0m01:07:26.787697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:07:26.787994 [info ] [MainThread]: 
[0m01:07:26.788279 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=28
[0m01:07:26.790623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.42855, "process_in_blocks": "0", "process_kernel_time": 0.583381, "process_mem_max_rss": "188694528", "process_out_blocks": "0", "process_user_time": 4.023266}
[0m01:07:26.790966 [debug] [MainThread]: Command `dbt run` succeeded at 01:07:26.790900 after 22.43 seconds
[0m01:07:26.791284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ff280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ff220>]}
[0m01:07:26.791610 [debug] [MainThread]: Flushing usage events
[0m01:07:28.373952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:11:06.030950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb30250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbdda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbdd820>]}


============================== 01:11:06.035788 | 07db962e-6b8b-4b6a-a753-d7debcdd9bff ==============================
[0m01:11:06.035788 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m01:11:06.036322 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt seed --profiles-dir . --full-refresh', 'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True', 'profiles_dir': '.', 'version_check': 'True', 'log_path': '/Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/logs', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False'}
[0m01:11:06.639107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0775b0>]}
[0m01:11:06.715418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e063280>]}
[0m01:11:06.717339 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:11:06.853308 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m01:11:07.049397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:11:07.050431 [debug] [MainThread]: Partial parsing: updated file: bain_capital_analytics://seeds/raw_trades.csv
[0m01:11:07.050812 [debug] [MainThread]: Partial parsing: updated file: bain_capital_analytics://seeds/raw_benchmarks.csv
[0m01:11:07.379670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec58dc0>]}
[0m01:11:07.506205 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/manifest.json
[0m01:11:07.508802 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/semantic_manifest.json
[0m01:11:07.531013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2cd160>]}
[0m01:11:07.531596 [info ] [MainThread]: Found 28 models, 53 data tests, 10 seeds, 614 macros
[0m01:11:07.531933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efc48b0>]}
[0m01:11:07.534557 [info ] [MainThread]: 
[0m01:11:07.534893 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:11:07.535160 [info ] [MainThread]: 
[0m01:11:07.535658 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:11:07.540736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO'
[0m01:11:07.600225 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO"
[0m01:11:07.600739 [debug] [ThreadPool]: On list_DBT_DEMO: show terse schemas in database DBT_DEMO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "connection_name": "list_DBT_DEMO"} */
[0m01:11:07.601041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:11.437426 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.836 seconds
[0m01:11:11.445424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEMO, now list_DBT_DEMO_DEV_raw)
[0m01:11:11.446223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO_DEV'
[0m01:11:11.468401 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV_raw"
[0m01:11:11.471387 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV"
[0m01:11:11.471709 [debug] [ThreadPool]: On list_DBT_DEMO_DEV_raw: show objects in DBT_DEMO.DEV_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV_raw"} */;
[0m01:11:11.471999 [debug] [ThreadPool]: On list_DBT_DEMO_DEV: show objects in DBT_DEMO.DEV
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV"} */;
[0m01:11:11.472369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:11.775240 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.303 seconds
[0m01:11:13.114335 [debug] [ThreadPool]: SQL status: SUCCESS 45 in 1.642 seconds
[0m01:11:13.127483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbac370>]}
[0m01:11:13.132354 [debug] [Thread-1  ]: Began running node seed.bain_capital_analytics.raw_benchmarks
[0m01:11:13.132978 [debug] [Thread-2  ]: Began running node seed.bain_capital_analytics.raw_cashflows
[0m01:11:13.133397 [debug] [Thread-3  ]: Began running node seed.bain_capital_analytics.raw_counterparties
[0m01:11:13.133969 [info ] [Thread-1  ]: 1 of 10 START seed file DEV_raw.raw_benchmarks ................................. [RUN]
[0m01:11:13.134408 [debug] [Thread-4  ]: Began running node seed.bain_capital_analytics.raw_dates
[0m01:11:13.134892 [info ] [Thread-2  ]: 2 of 10 START seed file DEV_raw.raw_cashflows .................................. [RUN]
[0m01:11:13.135392 [info ] [Thread-3  ]: 3 of 10 START seed file DEV_raw.raw_counterparties ............................. [RUN]
[0m01:11:13.135938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV_raw, now seed.bain_capital_analytics.raw_benchmarks)
[0m01:11:13.136393 [info ] [Thread-4  ]: 4 of 10 START seed file DEV_raw.raw_dates ...................................... [RUN]
[0m01:11:13.136931 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV, now seed.bain_capital_analytics.raw_cashflows)
[0m01:11:13.137349 [debug] [Thread-3  ]: Acquiring new snowflake connection 'seed.bain_capital_analytics.raw_counterparties'
[0m01:11:13.137681 [debug] [Thread-1  ]: Began compiling node seed.bain_capital_analytics.raw_benchmarks
[0m01:11:13.138073 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.bain_capital_analytics.raw_dates'
[0m01:11:13.138382 [debug] [Thread-2  ]: Began compiling node seed.bain_capital_analytics.raw_cashflows
[0m01:11:13.138677 [debug] [Thread-3  ]: Began compiling node seed.bain_capital_analytics.raw_counterparties
[0m01:11:13.138987 [debug] [Thread-1  ]: Began executing node seed.bain_capital_analytics.raw_benchmarks
[0m01:11:13.139283 [debug] [Thread-4  ]: Began compiling node seed.bain_capital_analytics.raw_dates
[0m01:11:13.139575 [debug] [Thread-2  ]: Began executing node seed.bain_capital_analytics.raw_cashflows
[0m01:11:13.139866 [debug] [Thread-3  ]: Began executing node seed.bain_capital_analytics.raw_counterparties
[0m01:11:13.152732 [debug] [Thread-4  ]: Began executing node seed.bain_capital_analytics.raw_dates
[0m01:11:13.188876 [debug] [Thread-1  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_BENCHMARKS"
[0m01:11:13.189946 [debug] [Thread-2  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_CASHFLOWS"
[0m01:11:13.192718 [debug] [Thread-3  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_COUNTERPARTIES"
[0m01:11:13.199110 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:11:13.199830 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:11:13.203090 [debug] [Thread-4  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_DATES"
[0m01:11:13.203747 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:11:13.204095 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_BENCHMARKS" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m01:11:13.204424 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_CASHFLOWS" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m01:11:13.205009 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:11:13.205334 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_COUNTERPARTIES" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m01:11:13.206116 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_DATES" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m01:11:13.206507 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:11:13.206908 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m01:11:13.488215 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.283 seconds
[0m01:11:13.495287 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:11:13.495676 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: create table DBT_DEMO.DEV_raw.raw_benchmarks (benchmark_id text,benchmark_name text,benchmark_date date,return_daily float8,return_mtd float8,return_ytd float8,benchmark_level float8)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m01:11:13.510561 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.305 seconds
[0m01:11:13.512080 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:11:13.512416 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: create table DBT_DEMO.DEV_raw.raw_cashflows (cashflow_id text,fund_id text,portfolio_id text,cashflow_date date,cashflow_type text,amount integer,currency text,description text,investor_id text)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m01:11:13.757423 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.261 seconds
[0m01:11:13.779039 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:11:13.779685 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m01:11:13.792126 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.279 seconds
[0m01:11:13.794860 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:11:13.795271 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m01:11:13.968733 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.173 seconds
[0m01:11:13.971618 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:11:13.972359 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: insert into DBT_DEMO.DEV_raw.raw_cashflows (cashflow_id, fund_id, portfolio_id, cashflow_date, cashflow_type, amount, currency, description, investor_id) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%...
[0m01:11:13.993427 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.213 seconds
[0m01:11:13.996180 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:11:13.996928 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: insert into DBT_DEMO.DEV_raw.raw_benchmarks (benchmark_id, benchmark_name, benchmark_date, return_daily, return_mtd, return_ytd, benchmark_level) values
            (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m01:11:14.537784 [debug] [Thread-1  ]: SQL status: SUCCESS 35 in 0.540 seconds
[0m01:11:14.538954 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m01:11:14.539479 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_benchmarks: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m01:11:14.558540 [debug] [Thread-2  ]: SQL status: SUCCESS 25 in 0.585 seconds
[0m01:11:14.559903 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m01:11:14.560512 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_cashflows: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m01:11:14.845967 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.306 seconds
[0m01:11:14.854078 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_benchmarks"
[0m01:11:14.884975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb9a0d0>]}
[0m01:11:14.885613 [info ] [Thread-1  ]: 1 of 10 OK loaded seed file DEV_raw.raw_benchmarks ............................. [[32mCREATE 35[0m in 1.75s]
[0m01:11:14.886129 [debug] [Thread-1  ]: Finished running node seed.bain_capital_analytics.raw_benchmarks
[0m01:11:14.886487 [debug] [Thread-1  ]: Began running node seed.bain_capital_analytics.raw_fund_structures
[0m01:11:14.886976 [info ] [Thread-1  ]: 5 of 10 START seed file DEV_raw.raw_fund_structures ............................ [RUN]
[0m01:11:14.887382 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_benchmarks, now seed.bain_capital_analytics.raw_fund_structures)
[0m01:11:14.887695 [debug] [Thread-1  ]: Began compiling node seed.bain_capital_analytics.raw_fund_structures
[0m01:11:14.887990 [debug] [Thread-1  ]: Began executing node seed.bain_capital_analytics.raw_fund_structures
[0m01:11:14.894607 [debug] [Thread-1  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_FUND_STRUCTURES"
[0m01:11:14.895308 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:11:14.895660 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_FUND_STRUCTURES" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m01:11:14.896540 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.335 seconds
[0m01:11:14.897311 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_cashflows"
[0m01:11:14.900371 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbac370>]}
[0m01:11:14.900910 [info ] [Thread-2  ]: 2 of 10 OK loaded seed file DEV_raw.raw_cashflows .............................. [[32mCREATE 25[0m in 1.76s]
[0m01:11:14.901384 [debug] [Thread-2  ]: Finished running node seed.bain_capital_analytics.raw_cashflows
[0m01:11:14.901718 [debug] [Thread-2  ]: Began running node seed.bain_capital_analytics.raw_instruments
[0m01:11:14.902127 [info ] [Thread-2  ]: 6 of 10 START seed file DEV_raw.raw_instruments ................................ [RUN]
[0m01:11:14.902536 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_cashflows, now seed.bain_capital_analytics.raw_instruments)
[0m01:11:14.903118 [debug] [Thread-2  ]: Began compiling node seed.bain_capital_analytics.raw_instruments
[0m01:11:14.903535 [debug] [Thread-2  ]: Began executing node seed.bain_capital_analytics.raw_instruments
[0m01:11:14.909771 [debug] [Thread-2  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_INSTRUMENTS"
[0m01:11:14.911274 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:11:14.911675 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_instruments: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_INSTRUMENTS" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m01:11:14.995268 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.788 seconds
[0m01:11:14.997270 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:11:14.997669 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: create table DBT_DEMO.DEV_raw.raw_dates (date_day date,is_business_day boolean,is_month_end boolean,is_quarter_end boolean,is_year_end boolean,fiscal_quarter text,fiscal_year text)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m01:11:15.011565 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.805 seconds
[0m01:11:15.013123 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:11:15.013551 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: create table DBT_DEMO.DEV_raw.raw_counterparties (counterparty_id text,counterparty_name text,counterparty_type text,country text,credit_rating text,is_active boolean)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m01:11:15.103585 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.191 seconds
[0m01:11:15.107390 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:11:15.108095 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_instruments: create table DBT_DEMO.DEV_raw.raw_instruments (instrument_id text,instrument_name text,instrument_type text,sector text,currency text,exchange text,issuer text,maturity_date date)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m01:11:15.109336 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.213 seconds
[0m01:11:15.111861 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:11:15.112597 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: create table DBT_DEMO.DEV_raw.raw_fund_structures (fund_id text,fund_name text,fund_type text,vintage_year integer,committed_capital integer,management_fee_rate float8,carry_rate float8,hurdle_rate float8,gp_commitment_pct float8,fund_currency text,fund_status text)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m01:11:15.287360 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.289 seconds
[0m01:11:15.291167 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:11:15.292042 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m01:11:15.328654 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.315 seconds
[0m01:11:15.332126 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:11:15.333007 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m01:11:15.401475 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.288 seconds
[0m01:11:15.402830 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.294 seconds
[0m01:11:15.405130 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:11:15.408053 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:11:15.408768 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m01:11:15.409176 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_instruments: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m01:11:15.474286 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.181 seconds
[0m01:11:15.476308 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:11:15.476863 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: insert into DBT_DEMO.DEV_raw.raw_dates (date_day, is_business_day, is_month_end, is_quarter_end, is_year_end, fiscal_quarter, fiscal_year) values
            (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s)
/* {"app"...
[0m01:11:15.520615 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.187 seconds
[0m01:11:15.522591 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:11:15.523263 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: insert into DBT_DEMO.DEV_raw.raw_counterparties (counterparty_id, counterparty_name, counterparty_type, country, credit_rating, is_active) values
            (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analy...
[0m01:11:15.588890 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.179 seconds
[0m01:11:15.590437 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:11:15.590990 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: insert into DBT_DEMO.DEV_raw.raw_fund_structures (fund_id, fund_name, fund_type, vintage_year, committed_capital, management_fee_rate, carry_rate, hurdle_rate, gp_commitment_pct, fund_currency, fund_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} ...
[0m01:11:15.609613 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.200 seconds
[0m01:11:15.611434 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:11:15.612022 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_instruments: insert into DBT_DEMO.DEV_raw.raw_instruments (instrument_id, instrument_name, instrument_type, sector, currency, exchange, issuer, maturity_date) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s...
[0m01:11:15.986083 [debug] [Thread-4  ]: SQL status: SUCCESS 15 in 0.509 seconds
[0m01:11:15.986991 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m01:11:15.987550 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_dates: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m01:11:16.162948 [debug] [Thread-3  ]: SQL status: SUCCESS 10 in 0.639 seconds
[0m01:11:16.163842 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m01:11:16.164241 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_counterparties: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m01:11:16.199847 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.608 seconds
[0m01:11:16.200390 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m01:11:16.200732 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_fund_structures: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m01:11:16.382844 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.395 seconds
[0m01:11:16.383842 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_dates"
[0m01:11:16.386878 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153f3bb0>]}
[0m01:11:16.387475 [info ] [Thread-4  ]: 4 of 10 OK loaded seed file DEV_raw.raw_dates .................................. [[32mCREATE 15[0m in 3.25s]
[0m01:11:16.388020 [debug] [Thread-4  ]: Finished running node seed.bain_capital_analytics.raw_dates
[0m01:11:16.388411 [debug] [Thread-4  ]: Began running node seed.bain_capital_analytics.raw_portfolios
[0m01:11:16.388961 [info ] [Thread-4  ]: 7 of 10 START seed file DEV_raw.raw_portfolios ................................. [RUN]
[0m01:11:16.389403 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_dates, now seed.bain_capital_analytics.raw_portfolios)
[0m01:11:16.389759 [debug] [Thread-4  ]: Began compiling node seed.bain_capital_analytics.raw_portfolios
[0m01:11:16.390104 [debug] [Thread-4  ]: Began executing node seed.bain_capital_analytics.raw_portfolios
[0m01:11:16.396817 [debug] [Thread-4  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_PORTFOLIOS"
[0m01:11:16.397612 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:11:16.397967 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_portfolios: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_PORTFOLIOS" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m01:11:16.431176 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.267 seconds
[0m01:11:16.431863 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_counterparties"
[0m01:11:16.434185 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153b8280>]}
[0m01:11:16.434687 [info ] [Thread-3  ]: 3 of 10 OK loaded seed file DEV_raw.raw_counterparties ......................... [[32mCREATE 10[0m in 3.30s]
[0m01:11:16.435170 [debug] [Thread-3  ]: Finished running node seed.bain_capital_analytics.raw_counterparties
[0m01:11:16.435517 [debug] [Thread-3  ]: Began running node seed.bain_capital_analytics.raw_positions
[0m01:11:16.435983 [info ] [Thread-3  ]: 8 of 10 START seed file DEV_raw.raw_positions .................................. [RUN]
[0m01:11:16.436350 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_counterparties, now seed.bain_capital_analytics.raw_positions)
[0m01:11:16.436663 [debug] [Thread-3  ]: Began compiling node seed.bain_capital_analytics.raw_positions
[0m01:11:16.436965 [debug] [Thread-3  ]: Began executing node seed.bain_capital_analytics.raw_positions
[0m01:11:16.444794 [debug] [Thread-3  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_POSITIONS"
[0m01:11:16.445476 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:11:16.445813 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_positions: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_POSITIONS" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m01:11:16.480165 [debug] [Thread-2  ]: SQL status: SUCCESS 20 in 0.868 seconds
[0m01:11:16.480738 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m01:11:16.481075 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_instruments: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m01:11:16.509765 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.309 seconds
[0m01:11:16.510372 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_fund_structures"
[0m01:11:16.512445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c60b490>]}
[0m01:11:16.512911 [info ] [Thread-1  ]: 5 of 10 OK loaded seed file DEV_raw.raw_fund_structures ........................ [[32mCREATE 3[0m in 1.63s]
[0m01:11:16.513576 [debug] [Thread-1  ]: Finished running node seed.bain_capital_analytics.raw_fund_structures
[0m01:11:16.513969 [debug] [Thread-1  ]: Began running node seed.bain_capital_analytics.raw_trades
[0m01:11:16.514450 [info ] [Thread-1  ]: 9 of 10 START seed file DEV_raw.raw_trades ..................................... [RUN]
[0m01:11:16.515074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_fund_structures, now seed.bain_capital_analytics.raw_trades)
[0m01:11:16.515413 [debug] [Thread-1  ]: Began compiling node seed.bain_capital_analytics.raw_trades
[0m01:11:16.515729 [debug] [Thread-1  ]: Began executing node seed.bain_capital_analytics.raw_trades
[0m01:11:16.525190 [debug] [Thread-1  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_TRADES"
[0m01:11:16.525866 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:11:16.526186 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_trades: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_TRADES" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m01:11:16.622712 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.224 seconds
[0m01:11:16.624480 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:11:16.624871 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_portfolios: create table DBT_DEMO.DEV_raw.raw_portfolios (portfolio_id text,portfolio_name text,strategy text,inception_date date,fund_id text,manager_name text,is_active boolean)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m01:11:16.681598 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.235 seconds
[0m01:11:16.684006 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:11:16.684439 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_positions: create table DBT_DEMO.DEV_raw.raw_positions (position_id text,portfolio_id text,instrument_id text,position_date date,quantity integer,market_value integer,cost_basis integer,currency text)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m01:11:16.732834 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.206 seconds
[0m01:11:16.736095 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:11:16.736659 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_trades: create table DBT_DEMO.DEV_raw.raw_trades (trade_id text,portfolio_id text,instrument_id text,counterparty_id text,trade_date date,settlement_date date,trade_type text,quantity integer,price float8,notional_amount integer,commission float8,currency text,status text)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m01:11:16.813410 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.332 seconds
[0m01:11:16.815131 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_instruments"
[0m01:11:16.820162 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154c3100>]}
[0m01:11:16.821130 [info ] [Thread-2  ]: 6 of 10 OK loaded seed file DEV_raw.raw_instruments ............................ [[32mCREATE 20[0m in 1.92s]
[0m01:11:16.821880 [debug] [Thread-2  ]: Finished running node seed.bain_capital_analytics.raw_instruments
[0m01:11:16.822426 [debug] [Thread-2  ]: Began running node seed.bain_capital_analytics.raw_valuations
[0m01:11:16.823285 [info ] [Thread-2  ]: 10 of 10 START seed file DEV_raw.raw_valuations ................................ [RUN]
[0m01:11:16.823949 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_instruments, now seed.bain_capital_analytics.raw_valuations)
[0m01:11:16.824379 [debug] [Thread-2  ]: Began compiling node seed.bain_capital_analytics.raw_valuations
[0m01:11:16.824794 [debug] [Thread-2  ]: Began executing node seed.bain_capital_analytics.raw_valuations
[0m01:11:16.835980 [debug] [Thread-2  ]: Applying DROP to: "DBT_DEMO"."DEV_RAW"."RAW_VALUATIONS"
[0m01:11:16.837972 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:11:16.838365 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: drop table if exists "DBT_DEMO"."DEV_RAW"."RAW_VALUATIONS" cascade
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m01:11:16.895461 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.270 seconds
[0m01:11:16.898659 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:11:16.899620 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_portfolios: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m01:11:16.941571 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.257 seconds
[0m01:11:16.944767 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:11:16.945230 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_positions: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m01:11:17.031227 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.192 seconds
[0m01:11:17.035503 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:11:17.036411 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: create table DBT_DEMO.DEV_raw.raw_valuations (valuation_id text,portfolio_id text,valuation_date date,gross_asset_value integer,net_asset_value integer,total_liabilities integer,unrealized_pnl integer,realized_pnl integer,valuation_method text)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m01:11:17.091658 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.191 seconds
[0m01:11:17.093378 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.356 seconds
[0m01:11:17.094366 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:11:17.098515 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:11:17.099054 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_portfolios: insert into DBT_DEMO.DEV_raw.raw_portfolios (portfolio_id, portfolio_name, strategy, inception_date, fund_id, manager_name, is_active) values
            (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */...
[0m01:11:17.099459 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_trades: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m01:11:17.142324 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.197 seconds
[0m01:11:17.144499 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:11:17.145216 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_positions: insert into DBT_DEMO.DEV_raw.raw_positions (position_id, portfolio_id, instrument_id, position_date, quantity, market_value, cost_basis, currency) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%...
[0m01:11:17.304535 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.204 seconds
[0m01:11:17.308722 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:11:17.309332 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_trades: insert into DBT_DEMO.DEV_raw.raw_trades (trade_id, portfolio_id, instrument_id, counterparty_id, trade_date, settlement_date, trade_type, quantity, price, notional_amount, commission, currency, status) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m01:11:17.441375 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.404 seconds
[0m01:11:17.444831 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:11:17.445442 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m01:11:17.568743 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0.469 seconds
[0m01:11:17.570044 [debug] [Thread-4  ]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m01:11:17.570699 [debug] [Thread-4  ]: On seed.bain_capital_analytics.raw_portfolios: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m01:11:17.633573 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.187 seconds
[0m01:11:17.636090 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:11:17.636666 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: insert into DBT_DEMO.DEV_raw.raw_valuations (valuation_id, portfolio_id, valuation_date, gross_asset_value, net_asset_value, total_liabilities, unrealized_pnl, realized_pnl, valuation_method) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m01:11:17.789653 [debug] [Thread-3  ]: SQL status: SUCCESS 30 in 0.643 seconds
[0m01:11:17.790831 [debug] [Thread-3  ]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m01:11:17.791323 [debug] [Thread-3  ]: On seed.bain_capital_analytics.raw_positions: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m01:11:17.795697 [debug] [Thread-1  ]: SQL status: SUCCESS 40 in 0.486 seconds
[0m01:11:17.796561 [debug] [Thread-1  ]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m01:11:17.797277 [debug] [Thread-1  ]: On seed.bain_capital_analytics.raw_trades: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m01:11:18.015444 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.444 seconds
[0m01:11:18.017421 [debug] [Thread-4  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_portfolios"
[0m01:11:18.021490 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153f3bb0>]}
[0m01:11:18.022133 [info ] [Thread-4  ]: 7 of 10 OK loaded seed file DEV_raw.raw_portfolios ............................. [[32mCREATE 5[0m in 1.63s]
[0m01:11:18.022712 [debug] [Thread-4  ]: Finished running node seed.bain_capital_analytics.raw_portfolios
[0m01:11:18.099774 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.308 seconds
[0m01:11:18.101310 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_positions"
[0m01:11:18.106632 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153b8280>]}
[0m01:11:18.107586 [info ] [Thread-3  ]: 8 of 10 OK loaded seed file DEV_raw.raw_positions .............................. [[32mCREATE 30[0m in 1.67s]
[0m01:11:18.108345 [debug] [Thread-3  ]: Finished running node seed.bain_capital_analytics.raw_positions
[0m01:11:18.127343 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.329 seconds
[0m01:11:18.128764 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_trades"
[0m01:11:18.133818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115531610>]}
[0m01:11:18.134889 [info ] [Thread-1  ]: 9 of 10 OK loaded seed file DEV_raw.raw_trades ................................. [[32mCREATE 40[0m in 1.62s]
[0m01:11:18.135638 [debug] [Thread-1  ]: Finished running node seed.bain_capital_analytics.raw_trades
[0m01:11:18.265964 [debug] [Thread-2  ]: SQL status: SUCCESS 21 in 0.628 seconds
[0m01:11:18.267540 [debug] [Thread-2  ]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m01:11:18.268186 [debug] [Thread-2  ]: On seed.bain_capital_analytics.raw_valuations: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "bain_capital_analytics_snowflake", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m01:11:18.736120 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.467 seconds
[0m01:11:18.737701 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_valuations"
[0m01:11:18.742152 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07db962e-6b8b-4b6a-a753-d7debcdd9bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115575a30>]}
[0m01:11:18.742945 [info ] [Thread-2  ]: 10 of 10 OK loaded seed file DEV_raw.raw_valuations ............................ [[32mCREATE 21[0m in 1.92s]
[0m01:11:18.743594 [debug] [Thread-2  ]: Finished running node seed.bain_capital_analytics.raw_valuations
[0m01:11:18.745343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:18.745740 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_trades' was left open.
[0m01:11:18.746066 [debug] [MainThread]: On seed.bain_capital_analytics.raw_trades: Close
[0m01:11:19.176908 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_valuations' was left open.
[0m01:11:19.177890 [debug] [MainThread]: On seed.bain_capital_analytics.raw_valuations: Close
[0m01:11:19.497251 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_positions' was left open.
[0m01:11:19.498378 [debug] [MainThread]: On seed.bain_capital_analytics.raw_positions: Close
[0m01:11:19.817800 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_portfolios' was left open.
[0m01:11:19.818817 [debug] [MainThread]: On seed.bain_capital_analytics.raw_portfolios: Close
[0m01:11:20.215308 [info ] [MainThread]: 
[0m01:11:20.216297 [info ] [MainThread]: Finished running 10 seeds in 0 hours 0 minutes and 12.68 seconds (12.68s).
[0m01:11:20.218839 [debug] [MainThread]: Command end result
[0m01:11:20.269417 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/manifest.json
[0m01:11:20.271731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/semantic_manifest.json
[0m01:11:20.278680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/nedazarei/Documents/turintech/sample-dbt/snowflake2/target/run_results.json
[0m01:11:20.279001 [info ] [MainThread]: 
[0m01:11:20.279380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:20.279674 [info ] [MainThread]: 
[0m01:11:20.279974 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m01:11:20.283224 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 14.338863, "process_in_blocks": "0", "process_kernel_time": 0.607636, "process_mem_max_rss": "190447616", "process_out_blocks": "0", "process_user_time": 3.870929}
[0m01:11:20.283602 [debug] [MainThread]: Command `dbt seed` succeeded at 01:11:20.283523 after 14.34 seconds
[0m01:11:20.283969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb30250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e063280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f15abb0>]}
[0m01:11:20.284329 [debug] [MainThread]: Flushing usage events
[0m01:11:21.603783 [debug] [MainThread]: An error was encountered while trying to flush usage events
