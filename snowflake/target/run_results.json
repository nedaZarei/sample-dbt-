{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-02-04T10:56:46.437168Z", "invocation_id": "16ed20fe-f94e-461d-87b2-7d0f3308569a", "invocation_started_at": "2026-02-04T10:56:37.399316Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:40.631966Z", "completed_at": "2026-02-04T10:56:40.703872Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:40.724875Z", "completed_at": "2026-02-04T10:56:41.058738Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.436521053314209, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b09-0003-1e32000c9146"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.stg_cashflows", "compiled": true, "compiled_code": "select distinct\n    cashflow_id,\n    fund_id,\n    portfolio_id,\n    cast(cashflow_date as date) as cashflow_date,\n    cashflow_type,\n    cast(amount as numeric(18,2)) as amount,\n    currency,\n    description,\n    investor_id,\n    case\n        when extract(month from cast(cashflow_date as date)) between 1 and 3 then 'Q3'\n        when extract(month from cast(cashflow_date as date)) between 4 and 6 then 'Q4'\n        when extract(month from cast(cashflow_date as date)) between 7 and 9 then 'Q1'\n        when extract(month from cast(cashflow_date as date)) between 10 and 12 then 'Q2'\n    end as cashflow_fiscal_quarter,\n    extract(year from cast(cashflow_date as date)) as cashflow_year\nfrom DBT_DEMO.DEV_raw.raw_cashflows", "relation_name": "DBT_DEMO.DEV.stg_cashflows", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:40.624895Z", "completed_at": "2026-02-04T10:56:40.703594Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:40.704532Z", "completed_at": "2026-02-04T10:56:41.067059Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4452180862426758, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b0e-0003-1e32000ca192"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.stg_benchmarks", "compiled": true, "compiled_code": "select distinct\n    benchmark_id,\n    benchmark_name,\n    cast(benchmark_date as date) as benchmark_date,\n    cast(return_daily as numeric(18,8)) as return_daily,\n    cast(return_mtd as numeric(18,8)) as return_mtd,\n    cast(return_ytd as numeric(18,8)) as return_ytd,\n    cast(benchmark_level as numeric(18,4)) as benchmark_level,\n    case\n        when extract(month from cast(benchmark_date as date)) between 1 and 3 then 'Q3'\n        when extract(month from cast(benchmark_date as date)) between 4 and 6 then 'Q4'\n        when extract(month from cast(benchmark_date as date)) between 7 and 9 then 'Q1'\n        when extract(month from cast(benchmark_date as date)) between 10 and 12 then 'Q2'\n    end as benchmark_fiscal_quarter\nfrom DBT_DEMO.DEV_raw.raw_benchmarks", "relation_name": "DBT_DEMO.DEV.stg_benchmarks", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:41.072983Z", "completed_at": "2026-02-04T10:56:41.078398Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:41.078918Z", "completed_at": "2026-02-04T10:56:41.376231Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3046889305114746, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b27-0003-1e32000d60c6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.stg_instruments", "compiled": true, "compiled_code": "select distinct\n    instrument_id,\n    instrument_name,\n    instrument_type,\n    sector,\n    currency,\n    exchange,\n    issuer,\n    cast(maturity_date as date) as maturity_date,\n    case\n        when maturity_date is not null\n        then datediff('day', current_date, cast(maturity_date as date))\n        else null\n    end as days_to_maturity,\n    case\n        when instrument_type in ('equity', 'futures') then 'liquid'\n        when instrument_type in ('corporate_bond', 'government_bond', 'sovereign_bond', 'leveraged_loan') then 'semi_liquid'\n        when instrument_type in ('private_equity', 'venture_capital', 'real_estate', 'real_estate_debt', 'infrastructure') then 'illiquid'\n        else 'other'\n    end as liquidity_class\nfrom DBT_DEMO.DEV_raw.raw_instruments", "relation_name": "DBT_DEMO.DEV.stg_instruments", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:41.076234Z", "completed_at": "2026-02-04T10:56:41.078666Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:41.081084Z", "completed_at": "2026-02-04T10:56:41.403039Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.32741498947143555, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7a2f-0003-1e32000b31f6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.stg_portfolios", "compiled": true, "compiled_code": "select distinct\n    cast(portfolio_id as varchar(10)) as portfolio_id,\n    cast(portfolio_name as varchar(100)) as portfolio_name,\n    cast(strategy as varchar(50)) as strategy,\n    cast(inception_date as date) as inception_date,\n    cast(fund_id as varchar(10)) as fund_id,\n    cast(manager_name as varchar(100)) as manager_name,\n    cast(is_active as boolean) as is_active,\n    case\n        when extract(month from cast(inception_date as date)) between 1 and 3 then 'Q3'\n        when extract(month from cast(inception_date as date)) between 4 and 6 then 'Q4'\n        when extract(month from cast(inception_date as date)) between 7 and 9 then 'Q1'\n        when extract(month from cast(inception_date as date)) between 10 and 12 then 'Q2'\n    end as inception_fiscal_quarter\nfrom DBT_DEMO.DEV_raw.raw_portfolios\nwhere cast(is_active as boolean) = true", "relation_name": "DBT_DEMO.DEV.stg_portfolios", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:41.379748Z", "completed_at": "2026-02-04T10:56:41.383428Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:41.383787Z", "completed_at": "2026-02-04T10:56:41.654619Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.27577686309814453, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7ab6-0003-1e32000bf16e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.stg_positions", "compiled": true, "compiled_code": "select distinct\n    position_id,\n    portfolio_id,\n    instrument_id,\n    cast(position_date as date) as position_date,\n    cast(quantity as numeric(18,4)) as quantity,\n    cast(market_value as numeric(18,2)) as market_value,\n    cast(cost_basis as numeric(18,2)) as cost_basis,\n    currency,\n    cast(market_value as numeric(18,2)) - cast(cost_basis as numeric(18,2)) as unrealized_gain_loss,\n    case\n        when cast(cost_basis as numeric(18,2)) != 0\n        then (cast(market_value as numeric(18,2)) - cast(cost_basis as numeric(18,2))) / abs(cast(cost_basis as numeric(18,2)))\n        else 0\n    end as unrealized_return_pct\nfrom DBT_DEMO.DEV_raw.raw_positions", "relation_name": "DBT_DEMO.DEV.stg_positions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:41.405915Z", "completed_at": "2026-02-04T10:56:41.408495Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:41.408731Z", "completed_at": "2026-02-04T10:56:41.682127Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2769021987915039, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b09-0003-1e32000c914a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.stg_valuations", "compiled": true, "compiled_code": "select distinct\n    valuation_id,\n    portfolio_id,\n    cast(valuation_date as date) as valuation_date,\n    cast(gross_asset_value as numeric(18,2)) as gross_asset_value,\n    cast(net_asset_value as numeric(18,2)) as net_asset_value,\n    cast(total_liabilities as numeric(18,2)) as total_liabilities,\n    cast(unrealized_pnl as numeric(18,2)) as unrealized_pnl,\n    cast(realized_pnl as numeric(18,2)) as realized_pnl,\n    valuation_method,\n    case\n        when extract(month from cast(valuation_date as date)) between 1 and 3 then 'Q3'\n        when extract(month from cast(valuation_date as date)) between 4 and 6 then 'Q4'\n        when extract(month from cast(valuation_date as date)) between 7 and 9 then 'Q1'\n        when extract(month from cast(valuation_date as date)) between 10 and 12 then 'Q2'\n    end as valuation_fiscal_quarter\nfrom DBT_DEMO.DEV_raw.raw_valuations", "relation_name": "DBT_DEMO.DEV.stg_valuations", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:41.658229Z", "completed_at": "2026-02-04T10:56:41.662592Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:41.662937Z", "completed_at": "2026-02-04T10:56:42.093308Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4359321594238281, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b0e-0003-1e32000ca196"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.fact_portfolio_summary", "compiled": true, "compiled_code": "-- Pipeline A: FACT table - Portfolio summary with positions\n\nselect distinct\n    p.portfolio_id,\n    p.portfolio_name,\n    p.strategy,\n    p.fund_id,\n    p.manager_name,\n    pos.position_date,\n    count(distinct pos.instrument_id) as num_positions,\n    sum(pos.market_value) as total_market_value,\n    sum(pos.cost_basis) as total_cost_basis,\n    sum(pos.unrealized_gain_loss) as total_unrealized_pnl,\n    case\n        when sum(pos.cost_basis) != 0\n        then sum(pos.unrealized_gain_loss) / abs(sum(pos.cost_basis))\n        else 0\n    end as portfolio_return_pct,\n    max(pos.market_value) as largest_position_mv,\n    min(pos.market_value) as smallest_position_mv\nfrom DBT_DEMO.DEV.stg_portfolios p\ninner join DBT_DEMO.DEV.stg_positions pos\n    on p.portfolio_id = pos.portfolio_id\nwhere p.is_active = true\ngroup by\n    p.portfolio_id,\n    p.portfolio_name,\n    p.strategy,\n    p.fund_id,\n    p.manager_name,\n    pos.position_date", "relation_name": "DBT_DEMO.DEV.fact_portfolio_summary", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:40.701195Z", "completed_at": "2026-02-04T10:56:40.709880Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:40.728976Z", "completed_at": "2026-02-04T10:56:42.291131Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.6684296131134033, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7a2f-0003-1e32000b31fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.stg_fund_structures", "compiled": true, "compiled_code": "select distinct\n    fund_id,\n    fund_name,\n    fund_type,\n    cast(vintage_year as integer) as vintage_year,\n    cast(committed_capital as numeric(18,2)) as committed_capital,\n    cast(management_fee_rate as numeric(8,4)) as management_fee_rate,\n    cast(carry_rate as numeric(8,4)) as carry_rate,\n    cast(hurdle_rate as numeric(8,4)) as hurdle_rate,\n    cast(gp_commitment_pct as numeric(8,4)) as gp_commitment_pct,\n    fund_currency,\n    fund_status\nfrom DBT_DEMO.DEV_raw.raw_fund_structures", "relation_name": "DBT_DEMO.DEV.stg_fund_structures", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:40.635551Z", "completed_at": "2026-02-04T10:56:40.704212Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:40.726947Z", "completed_at": "2026-02-04T10:56:42.303878Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6813948154449463, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7a2f-0003-1e32000b3202"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.stg_dates", "compiled": true, "compiled_code": "select\n    cast(date_day as date) as date_day,\n    cast(is_business_day as boolean) as is_business_day,\n    cast(is_month_end as boolean) as is_month_end,\n    cast(is_quarter_end as boolean) as is_quarter_end,\n    cast(is_year_end as boolean) as is_year_end,\n    fiscal_quarter,\n    fiscal_year,\n    date_trunc('month', cast(date_day as date)) as month_start,\n    date_trunc('quarter', cast(date_day as date)) as quarter_start,\n    extract(month from cast(date_day as date)) as calendar_month,\n    extract(year from cast(date_day as date)) as calendar_year\nfrom DBT_DEMO.DEV_raw.raw_dates", "relation_name": "DBT_DEMO.DEV.stg_dates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:41.684955Z", "completed_at": "2026-02-04T10:56:41.688055Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:41.688286Z", "completed_at": "2026-02-04T10:56:42.466949Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7827348709106445, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7a2f-0003-1e32000b31fa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.int_portfolio_attribution", "compiled": true, "compiled_code": "-- Pipeline C: Portfolio performance attribution by sector and instrument type\n\nwith positions_enriched as (\n    select\n        pos.position_id,\n        pos.portfolio_id,\n        pos.instrument_id,\n        pos.position_date,\n        pos.quantity,\n        pos.market_value,\n        pos.cost_basis,\n        pos.unrealized_gain_loss,\n        i.instrument_name,\n        i.instrument_type,\n        i.sector,\n        p.portfolio_name,\n        p.strategy,\n        p.fund_id\n    from DBT_DEMO.DEV.stg_positions pos\n    inner join DBT_DEMO.DEV.stg_instruments i\n        on pos.instrument_id = i.instrument_id\n    inner join DBT_DEMO.DEV.stg_portfolios p\n        on pos.portfolio_id = p.portfolio_id\n),\n\nportfolio_totals as (\n    select\n        portfolio_id,\n        position_date,\n        sum(market_value) as total_portfolio_mv,\n        sum(unrealized_gain_loss) as total_portfolio_ugl\n    from positions_enriched\n    group by portfolio_id, position_date\n),\n\nsector_attribution as (\n    select\n        pe.portfolio_id,\n        pe.portfolio_name,\n        pe.strategy,\n        pe.fund_id,\n        pe.position_date,\n        pe.sector,\n        sum(pe.market_value) as sector_mv,\n        sum(pe.unrealized_gain_loss) as sector_ugl,\n        count(distinct pe.instrument_id) as num_instruments\n    from positions_enriched pe\n    group by\n        pe.portfolio_id, pe.portfolio_name, pe.strategy,\n        pe.fund_id, pe.position_date, pe.sector\n),\n\nattribution_with_weights as (\n    select\n        sa.*,\n        pt.total_portfolio_mv,\n        pt.total_portfolio_ugl,\n        case\n            when pt.total_portfolio_mv != 0\n            then sa.sector_mv / pt.total_portfolio_mv\n            else 0\n        end as sector_weight,\n        case\n            when pt.total_portfolio_ugl != 0\n            then sa.sector_ugl / pt.total_portfolio_ugl\n            else 0\n        end as sector_contribution\n    from sector_attribution sa\n    inner join portfolio_totals pt\n        on sa.portfolio_id = pt.portfolio_id\n        and sa.position_date = pt.position_date\n)\n\nselect * from attribution_with_weights", "relation_name": "DBT_DEMO.DEV.int_portfolio_attribution", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:42.294342Z", "completed_at": "2026-02-04T10:56:42.296896Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:42.297145Z", "completed_at": "2026-02-04T10:56:42.885924Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.5922510623931885, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b27-0003-1e32000d60ce"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.int_valuation_enriched", "compiled": true, "compiled_code": "-- Pipeline C: Enriched valuation data\n\nwith valuation_ranked as (\n    select\n        v.*,\n        p.portfolio_name,\n        p.strategy,\n        p.fund_id,\n        p.manager_name\n    from DBT_DEMO.DEV.stg_valuations v\n    inner join DBT_DEMO.DEV.stg_portfolios p\n        on v.portfolio_id = p.portfolio_id\n    qualify row_number() over (\n        partition by v.portfolio_id, v.valuation_date\n        order by v.valuation_id desc\n    ) = 1\n),\n\nvaluation_with_changes as (\n    select\n        vr.*,\n        lag(vr.net_asset_value) over (\n            partition by vr.portfolio_id order by vr.valuation_date\n        ) as prev_nav,\n        case\n            when lag(vr.net_asset_value) over (\n                partition by vr.portfolio_id order by vr.valuation_date\n            ) is not null\n            and lag(vr.net_asset_value) over (\n                partition by vr.portfolio_id order by vr.valuation_date\n            ) != 0\n            then (vr.net_asset_value - lag(vr.net_asset_value) over (\n                partition by vr.portfolio_id order by vr.valuation_date\n            )) / lag(vr.net_asset_value) over (\n                partition by vr.portfolio_id order by vr.valuation_date\n            )\n            else null\n        end as nav_return_pct,\n        datediff('day', lag(vr.valuation_date) over (\n            partition by vr.portfolio_id order by vr.valuation_date\n        ), vr.valuation_date) as days_between_valuations\n    from valuation_ranked vr\n)\n\nselect * from valuation_with_changes", "relation_name": "DBT_DEMO.DEV.int_valuation_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:42.097161Z", "completed_at": "2026-02-04T10:56:42.101456Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:42.101746Z", "completed_at": "2026-02-04T10:56:42.887909Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.791632890701294, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b27-0003-1e32000d60ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.int_irr_calculations", "compiled": true, "compiled_code": "-- Pipeline C: Approximate IRR calculation per fund/portfolio\n\nwith cashflow_series as (\n    -- CTE level 1: get all cashflows with proper signs\n    select\n        cf.fund_id,\n        cf.portfolio_id,\n        cf.cashflow_date,\n        cf.cashflow_type,\n        case\n            when cf.cashflow_type = 'capital_call' then -1 * abs(cf.amount)\n            when cf.cashflow_type = 'distribution' then abs(cf.amount)\n            when cf.cashflow_type = 'management_fee' then -1 * abs(cf.amount)\n            else cf.amount\n        end as signed_amount\n    from DBT_DEMO.DEV.stg_cashflows cf\n),\n\nterminal_values as (\n    -- CTE level 2: get latest NAV as terminal cashflow\n    select\n        v.portfolio_id,\n        p.fund_id,\n        v.valuation_date as cashflow_date,\n        'terminal_value' as cashflow_type,\n        v.net_asset_value as signed_amount\n    from DBT_DEMO.DEV.stg_valuations v\n    inner join DBT_DEMO.DEV.stg_portfolios p\n        on v.portfolio_id = p.portfolio_id\n    where v.valuation_date = (\n        select max(v2.valuation_date)\n        from DBT_DEMO.DEV.stg_valuations v2\n        where v2.portfolio_id = v.portfolio_id\n    )\n),\n\nall_cashflows as (\n    -- CTE level 3: union cashflows and terminal values\n    select fund_id, portfolio_id, cashflow_date, cashflow_type, signed_amount\n    from cashflow_series\n    union all\n    select fund_id, portfolio_id, cashflow_date, cashflow_type, signed_amount\n    from terminal_values\n),\n\ncashflow_with_timing as (\n    -- CTE level 4: compute time fractions\n    select\n        ac.*,\n        min(ac.cashflow_date) over (partition by ac.fund_id, ac.portfolio_id) as first_cf_date,\n        cast(datediff('day', min(ac.cashflow_date) over (partition by ac.fund_id, ac.portfolio_id), ac.cashflow_date) as number) / 365.25 as year_fraction\n    from all_cashflows ac\n),\n\n-- CTE level 5: compute simple multiples as IRR proxy\nportfolio_multiples as (\n    select\n        fund_id,\n        portfolio_id,\n        min(cashflow_date) as first_cashflow_date,\n        max(cashflow_date) as last_cashflow_date,\n        datediff('day', min(cashflow_date), max(cashflow_date)) as investment_days,\n        cast(datediff('day', min(cashflow_date), max(cashflow_date)) as number) / 365.25 as investment_years,\n        sum(case when cashflow_type = 'capital_call' then abs(signed_amount) else 0 end) as total_invested,\n        sum(case when cashflow_type = 'distribution' then signed_amount else 0 end) as total_distributed,\n        sum(case when cashflow_type = 'terminal_value' then signed_amount else 0 end) as terminal_value,\n        sum(signed_amount) as net_cashflow\n    from cashflow_with_timing\n    group by fund_id, portfolio_id\n),\n\n-- CTE level 6: compute IRR approximation\nirr_approximation as (\n    select\n        pm.*,\n        case\n            when pm.total_invested > 0\n            then (pm.total_distributed + pm.terminal_value) / pm.total_invested\n            else null\n        end as tvpi,\n        case\n            when pm.total_invested > 0\n            then pm.total_distributed / pm.total_invested\n            else null\n        end as dpi,\n        case\n            when pm.total_invested > 0\n            then pm.terminal_value / pm.total_invested\n            else null\n        end as rvpi,\n        -- Simplified IRR approximation: (TVPI^(1/years)) - 1\n        case\n            when pm.total_invested > 0 and pm.investment_years > 0\n            then power(\n                (pm.total_distributed + pm.terminal_value) / pm.total_invested,\n                1.0 / pm.investment_years\n            ) - 1\n            else null\n        end as approx_irr\n    from portfolio_multiples pm\n)\n\nselect * from irr_approximation", "relation_name": "DBT_DEMO.DEV.int_irr_calculations", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:42.306986Z", "completed_at": "2026-02-04T10:56:42.310328Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:42.311458Z", "completed_at": "2026-02-04T10:56:42.962733Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6563870906829834, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7ab6-0003-1e32000bf176"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.int_cashflow_enriched", "compiled": true, "compiled_code": "-- Pipeline C: Enriched cashflow data with fund and portfolio details\n\nwith cashflow_with_details as (\n    select\n        cf.*,\n        p.portfolio_name,\n        p.strategy,\n        p.manager_name,\n        fs.fund_name,\n        fs.fund_type,\n        fs.committed_capital,\n        fs.management_fee_rate,\n        fs.carry_rate,\n        fs.hurdle_rate\n    from DBT_DEMO.DEV.stg_cashflows cf\n    inner join DBT_DEMO.DEV.stg_portfolios p\n        on cf.portfolio_id = p.portfolio_id\n    inner join DBT_DEMO.DEV.stg_fund_structures fs\n        on cf.fund_id = fs.fund_id\n    qualify row_number() over (\n        partition by cf.cashflow_id\n        order by cf.cashflow_date desc\n    ) = 1\n),\n\ncashflow_cumulative as (\n    select\n        *,\n        sum(case when cashflow_type = 'capital_call' then amount else 0 end) over (\n            partition by fund_id, portfolio_id\n            order by cashflow_date\n            rows between unbounded preceding and current row\n        ) as cumulative_called,\n        sum(case when cashflow_type = 'distribution' then amount else 0 end) over (\n            partition by fund_id, portfolio_id\n            order by cashflow_date\n            rows between unbounded preceding and current row\n        ) as cumulative_distributed,\n        sum(amount) over (\n            partition by fund_id, portfolio_id\n            order by cashflow_date\n            rows between unbounded preceding and current row\n        ) as cumulative_net_cashflow\n    from cashflow_with_details\n)\n\nselect\n    cashflow_id,\n    fund_id,\n    fund_name,\n    fund_type,\n    portfolio_id,\n    portfolio_name,\n    strategy,\n    manager_name,\n    cashflow_date,\n    cashflow_type,\n    amount,\n    currency,\n    description,\n    investor_id,\n    cashflow_fiscal_quarter,\n    cashflow_year,\n    committed_capital,\n    management_fee_rate,\n    carry_rate,\n    hurdle_rate,\n    cumulative_called,\n    cumulative_distributed,\n    cumulative_net_cashflow,\n    case\n        when committed_capital > 0\n        then cumulative_called / committed_capital\n        else 0\n    end as pct_called\nfrom cashflow_cumulative", "relation_name": "DBT_DEMO.DEV.int_cashflow_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:42.470837Z", "completed_at": "2026-02-04T10:56:42.476110Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:42.476435Z", "completed_at": "2026-02-04T10:56:43.142366Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6724190711975098, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7ab6-0003-1e32000bf17a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.int_fund_nav", "compiled": true, "compiled_code": "-- Pipeline C: Fund-level NAV calculation from portfolio valuations\n\nwith portfolio_valuations as (\n    select\n        v.portfolio_id,\n        v.valuation_date,\n        v.net_asset_value,\n        v.gross_asset_value,\n        v.total_liabilities,\n        v.unrealized_pnl,\n        v.realized_pnl,\n        v.valuation_method,\n        p.fund_id,\n        p.portfolio_name,\n        p.strategy,\n        fs.fund_name,\n        fs.fund_type,\n        fs.committed_capital,\n        fs.management_fee_rate\n    from DBT_DEMO.DEV.stg_valuations v\n    inner join DBT_DEMO.DEV.stg_portfolios p\n        on v.portfolio_id = p.portfolio_id\n    inner join DBT_DEMO.DEV.stg_fund_structures fs\n        on p.fund_id = fs.fund_id\n),\n\nfund_level_nav as (\n    select\n        fund_id,\n        fund_name,\n        fund_type,\n        committed_capital,\n        management_fee_rate,\n        valuation_date,\n        sum(net_asset_value) as fund_nav,\n        sum(gross_asset_value) as fund_gav,\n        sum(total_liabilities) as fund_total_liabilities,\n        sum(unrealized_pnl) as fund_unrealized_pnl,\n        sum(realized_pnl) as fund_realized_pnl,\n        count(distinct portfolio_id) as num_portfolios\n    from portfolio_valuations\n    group by\n        fund_id, fund_name, fund_type, committed_capital,\n        management_fee_rate, valuation_date\n),\n\nfund_nav_with_changes as (\n    select\n        fn.*,\n        lag(fn.fund_nav) over (\n            partition by fn.fund_id order by fn.valuation_date\n        ) as prev_fund_nav,\n        case\n            when lag(fn.fund_nav) over (\n                partition by fn.fund_id order by fn.valuation_date\n            ) is not null\n            and lag(fn.fund_nav) over (\n                partition by fn.fund_id order by fn.valuation_date\n            ) != 0\n            then (fn.fund_nav - lag(fn.fund_nav) over (\n                partition by fn.fund_id order by fn.valuation_date\n            )) / lag(fn.fund_nav) over (\n                partition by fn.fund_id order by fn.valuation_date\n            )\n            else null\n        end as fund_nav_return,\n        fn.fund_nav / nullif(fn.committed_capital, 0) as tvpi_gross\n    from fund_level_nav fn\n)\n\nselect * from fund_nav_with_changes", "relation_name": "DBT_DEMO.DEV.int_fund_nav", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:42.894075Z", "completed_at": "2026-02-04T10:56:42.904056Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:42.904388Z", "completed_at": "2026-02-04T10:56:43.566337Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.6740076541900635, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b0e-0003-1e32000ca19a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.int_benchmark_returns", "compiled": true, "compiled_code": "-- Pipeline C: Benchmark returns with rolling calculations\n\nwith benchmark_base as (\n    select\n        b.benchmark_id,\n        b.benchmark_name,\n        b.benchmark_date,\n        b.return_daily,\n        b.return_mtd,\n        b.return_ytd,\n        b.benchmark_level,\n        b.benchmark_fiscal_quarter,\n        d.fiscal_year,\n        d.is_quarter_end,\n        d.is_year_end\n    from DBT_DEMO.DEV.stg_benchmarks b\n    inner join DBT_DEMO.DEV.stg_dates d\n        on b.benchmark_date = d.date_day\n),\n\nbenchmark_with_rolling as (\n    select\n        bb.*,\n        -- rolling 3-month return\n        exp(sum(ln(1 + bb.return_mtd)) over (\n            partition by bb.benchmark_id\n            order by bb.benchmark_date\n            rows between 2 preceding and current row\n        )) - 1 as rolling_3m_return,\n        -- rolling 6-month return\n        exp(sum(ln(1 + bb.return_mtd)) over (\n            partition by bb.benchmark_id\n            order by bb.benchmark_date\n            rows between 5 preceding and current row\n        )) - 1 as rolling_6m_return,\n        -- rolling 12-month return\n        exp(sum(ln(1 + bb.return_mtd)) over (\n            partition by bb.benchmark_id\n            order by bb.benchmark_date\n            rows between 11 preceding and current row\n        )) - 1 as rolling_12m_return,\n        stddev(bb.return_mtd) over (\n            partition by bb.benchmark_id\n            order by bb.benchmark_date\n            rows between 11 preceding and current row\n        ) as rolling_12m_volatility,\n        avg(bb.return_mtd) over (\n            partition by bb.benchmark_id\n            order by bb.benchmark_date\n            rows between 11 preceding and current row\n        ) as rolling_12m_avg_return,\n        lag(bb.benchmark_level) over (\n            partition by bb.benchmark_id\n            order by bb.benchmark_date\n        ) as prev_benchmark_level\n    from benchmark_base bb\n)\n\nselect * from benchmark_with_rolling", "relation_name": "DBT_DEMO.DEV.int_benchmark_returns", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:42.965728Z", "completed_at": "2026-02-04T10:56:42.968703Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:42.968937Z", "completed_at": "2026-02-04T10:56:43.721615Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7566699981689453, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b09-0003-1e32000c915a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.fact_cashflow_waterfall", "compiled": true, "compiled_code": "-- Pipeline C: FACT table - Cashflow waterfall for PE/fund reporting\n\nwith enriched_cashflows as (\n    select\n        ce.cashflow_id,\n        ce.fund_id,\n        ce.fund_name,\n        ce.fund_type,\n        ce.portfolio_id,\n        ce.portfolio_name,\n        ce.cashflow_date,\n        ce.cashflow_type,\n        ce.amount,\n        ce.investor_id,\n        ce.committed_capital,\n        ce.management_fee_rate,\n        ce.carry_rate,\n        ce.hurdle_rate,\n        ce.cumulative_called,\n        ce.cumulative_distributed,\n        ce.cumulative_net_cashflow,\n        ce.pct_called,\n        case\n            when extract(month from ce.cashflow_date) between 1 and 3 then 'Q3'\n            when extract(month from ce.cashflow_date) between 4 and 6 then 'Q4'\n            when extract(month from ce.cashflow_date) between 7 and 9 then 'Q1'\n            when extract(month from ce.cashflow_date) between 10 and 12 then 'Q2'\n        end as fiscal_quarter,\n        extract(year from ce.cashflow_date) as calendar_year\n    from DBT_DEMO.DEV.int_cashflow_enriched ce\n),\n\nwaterfall_with_nav as (\n    select\n        ecf.*,\n        v.net_asset_value,\n        v.gross_asset_value,\n        v.unrealized_pnl as nav_unrealized_pnl,\n        v.realized_pnl as nav_realized_pnl\n    from enriched_cashflows ecf\n    left join DBT_DEMO.DEV.stg_valuations v\n        on ecf.portfolio_id = v.portfolio_id\n        and ecf.cashflow_date = v.valuation_date\n),\n\nwaterfall_calculations as (\n    select\n        wn.*,\n        -- Simplified carry calculation\n        case\n            when wn.cumulative_distributed > wn.cumulative_called * (1 + wn.hurdle_rate)\n            then (wn.cumulative_distributed - wn.cumulative_called * (1 + wn.hurdle_rate)) * wn.carry_rate\n            else 0\n        end as estimated_carry,\n        wn.cumulative_called * wn.management_fee_rate as annual_mgmt_fee,\n        case\n            when wn.cumulative_called > 0\n            then wn.cumulative_distributed / wn.cumulative_called\n            else 0\n        end as dpi,\n        case\n            when wn.cumulative_called > 0 and wn.net_asset_value is not null\n            then (wn.cumulative_distributed + wn.net_asset_value) / wn.cumulative_called\n            else null\n        end as tvpi\n    from waterfall_with_nav wn\n)\n\nselect * from waterfall_calculations", "relation_name": "DBT_DEMO.DEV.fact_cashflow_waterfall", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:42.899441Z", "completed_at": "2026-02-04T10:56:42.909182Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:42.909741Z", "completed_at": "2026-02-04T10:56:43.890762Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.9971158504486084, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b0e-0003-1e32000ca19e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.report_lp_quarterly", "compiled": true, "compiled_code": "-- Pipeline C: REPORT table - LP quarterly reporting\n\nwith quarterly_cashflows as (\n    select\n        cf.fund_id,\n        cf.portfolio_id,\n        trunc(cf.cashflow_date, 'quarter') as quarter_start,\n        cf.cashflow_fiscal_quarter as fiscal_quarter,\n        cf.cashflow_year,\n        sum(case when cf.cashflow_type = 'capital_call' then cf.amount else 0 end) as quarter_calls,\n        sum(case when cf.cashflow_type = 'distribution' then cf.amount else 0 end) as quarter_distributions,\n        sum(case when cf.cashflow_type = 'management_fee' then cf.amount else 0 end) as quarter_fees,\n        sum(cf.amount) as quarter_net\n    from DBT_DEMO.DEV.stg_cashflows cf\n    group by\n        cf.fund_id, cf.portfolio_id,\n        trunc(cf.cashflow_date, 'quarter'),\n        cf.cashflow_fiscal_quarter, cf.cashflow_year\n),\n\nquarterly_valuations as (\n    select\n        v.portfolio_id,\n        v.valuation_date,\n        v.net_asset_value,\n        v.gross_asset_value,\n        v.unrealized_pnl,\n        v.realized_pnl,\n        v.valuation_method\n    from DBT_DEMO.DEV.stg_valuations v\n    qualify row_number() over (\n        partition by v.portfolio_id, trunc(v.valuation_date, 'quarter')\n        order by v.valuation_date desc\n    ) = 1\n),\n\nfund_details as (\n    select\n        fs.fund_id,\n        fs.fund_name,\n        fs.fund_type,\n        fs.committed_capital,\n        fs.management_fee_rate,\n        fs.carry_rate,\n        fs.hurdle_rate,\n        fs.vintage_year,\n        fs.gp_commitment_pct\n    from DBT_DEMO.DEV.stg_fund_structures fs\n),\n\nlp_report as (\n    select\n        fd.fund_id,\n        fd.fund_name,\n        fd.fund_type,\n        fd.vintage_year,\n        fd.committed_capital,\n        fd.management_fee_rate,\n        fd.carry_rate,\n        fd.hurdle_rate,\n        fd.gp_commitment_pct,\n        qc.portfolio_id,\n        p.portfolio_name,\n        p.strategy,\n        qc.quarter_start,\n        qc.fiscal_quarter,\n        qc.cashflow_year,\n        qc.quarter_calls,\n        qc.quarter_distributions,\n        qc.quarter_fees,\n        qc.quarter_net,\n        qv.net_asset_value as quarter_end_nav,\n        qv.gross_asset_value as quarter_end_gav,\n        qv.unrealized_pnl,\n        qv.realized_pnl,\n        qv.valuation_method,\n        irr.approx_irr,\n        irr.tvpi,\n        irr.dpi,\n        irr.rvpi\n    from quarterly_cashflows qc\n    inner join fund_details fd\n        on qc.fund_id = fd.fund_id\n    inner join DBT_DEMO.DEV.stg_portfolios p\n        on qc.portfolio_id = p.portfolio_id\n    left join quarterly_valuations qv\n        on qc.portfolio_id = qv.portfolio_id\n        and trunc(qv.valuation_date, 'quarter') = qc.quarter_start\n    left join DBT_DEMO.DEV.int_irr_calculations irr\n        on qc.fund_id = irr.fund_id\n        and qc.portfolio_id = irr.portfolio_id\n)\n\nselect\n    *,\n    case\n        when committed_capital > 0\n        then quarter_calls / committed_capital\n        else 0\n    end as quarterly_drawdown_rate,\n    case\n        when quarter_end_nav is not null and committed_capital > 0\n        then quarter_end_nav / committed_capital\n        else null\n    end as nav_to_commitment_ratio\nfrom lp_report\norder by fund_id, portfolio_id, quarter_start", "relation_name": "DBT_DEMO.DEV.report_lp_quarterly", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:43.144700Z", "completed_at": "2026-02-04T10:56:43.147549Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:43.147785Z", "completed_at": "2026-02-04T10:56:44.121421Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.977424144744873, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7b0e-0003-1e32000ca1a2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.fact_fund_performance", "compiled": true, "compiled_code": "-- Pipeline C: FACT table - Fund-level performance metrics\n\nwith fund_nav_data as (\n    select\n        fn.fund_id,\n        fn.fund_name,\n        fn.fund_type,\n        fn.committed_capital,\n        fn.valuation_date,\n        fn.fund_nav,\n        fn.fund_gav,\n        fn.fund_total_liabilities,\n        fn.fund_unrealized_pnl,\n        fn.fund_realized_pnl,\n        fn.fund_nav_return,\n        fn.tvpi_gross,\n        fn.num_portfolios\n    from DBT_DEMO.DEV.int_fund_nav fn\n),\n\nfund_cashflows as (\n    select\n        cf.fund_id,\n        cf.cashflow_date,\n        sum(case when cf.cashflow_type = 'capital_call' then cf.amount else 0 end) as period_calls,\n        sum(case when cf.cashflow_type = 'distribution' then cf.amount else 0 end) as period_distributions,\n        sum(case when cf.cashflow_type = 'management_fee' then cf.amount else 0 end) as period_fees,\n        sum(cf.amount) as period_net_cashflow\n    from DBT_DEMO.DEV.stg_cashflows cf\n    group by cf.fund_id, cf.cashflow_date\n),\n\nfund_irr as (\n    select\n        irr.fund_id,\n        sum(irr.total_invested) as fund_total_invested,\n        sum(irr.total_distributed) as fund_total_distributed,\n        sum(irr.terminal_value) as fund_terminal_value,\n        avg(irr.approx_irr) as fund_approx_irr,\n        avg(irr.tvpi) as fund_tvpi,\n        avg(irr.dpi) as fund_dpi\n    from DBT_DEMO.DEV.int_irr_calculations irr\n    group by irr.fund_id\n),\n\ncombined as (\n    select\n        fn.fund_id,\n        fn.fund_name,\n        fn.fund_type,\n        fn.committed_capital,\n        fn.valuation_date,\n        fn.fund_nav,\n        fn.fund_gav,\n        fn.fund_total_liabilities,\n        fn.fund_unrealized_pnl,\n        fn.fund_realized_pnl,\n        fn.fund_nav_return,\n        fn.tvpi_gross,\n        fn.num_portfolios,\n        coalesce(fc.period_calls, 0) as period_calls,\n        coalesce(fc.period_distributions, 0) as period_distributions,\n        coalesce(fc.period_fees, 0) as period_fees,\n        coalesce(fc.period_net_cashflow, 0) as period_net_cashflow,\n        fi.fund_total_invested,\n        fi.fund_total_distributed,\n        fi.fund_approx_irr,\n        fi.fund_tvpi,\n        fi.fund_dpi\n    from fund_nav_data fn\n    left join fund_cashflows fc\n        on fn.fund_id = fc.fund_id\n        and fn.valuation_date = fc.cashflow_date\n    left join fund_irr fi\n        on fn.fund_id = fi.fund_id\n)\n\nselect * from combined", "relation_name": "DBT_DEMO.DEV.fact_fund_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:43.570452Z", "completed_at": "2026-02-04T10:56:43.576319Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:43.576649Z", "completed_at": "2026-02-04T10:56:44.432246Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.8627629280090332, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7ab6-0003-1e32000bf17e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.fact_portfolio_attribution", "compiled": true, "compiled_code": "-- Pipeline C: FACT table - Portfolio attribution with benchmark comparison\n\nwith attribution as (\n    select\n        pa.portfolio_id,\n        pa.portfolio_name,\n        pa.strategy,\n        pa.fund_id,\n        pa.position_date,\n        pa.sector,\n        pa.sector_mv,\n        pa.sector_ugl,\n        pa.num_instruments,\n        pa.total_portfolio_mv,\n        pa.total_portfolio_ugl,\n        pa.sector_weight,\n        pa.sector_contribution\n    from DBT_DEMO.DEV.int_portfolio_attribution pa\n),\n\nattribution_with_benchmark as (\n    select\n        a.*,\n        bm.benchmark_name,\n        bm.return_mtd as benchmark_return,\n        bm.rolling_3m_return as benchmark_3m_return,\n        bm.rolling_12m_return as benchmark_12m_return\n    from attribution a\n    left join DBT_DEMO.DEV.int_benchmark_returns bm\n        on a.position_date = bm.benchmark_date\n        and bm.benchmark_id = 'BM_SP500'\n),\n\nattribution_with_alpha as (\n    select\n        ab.*,\n        -- Simplified active return\n        case\n            when ab.total_portfolio_mv != 0\n            then (ab.sector_ugl / ab.total_portfolio_mv) - coalesce(ab.benchmark_return, 0) * ab.sector_weight\n            else 0\n        end as sector_active_return,\n        case\n            when ab.total_portfolio_mv != 0\n            then ab.total_portfolio_ugl / ab.total_portfolio_mv\n            else 0\n        end as portfolio_return\n    from attribution_with_benchmark ab\n)\n\nselect * from attribution_with_alpha", "relation_name": "DBT_DEMO.DEV.fact_portfolio_attribution", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T10:56:44.124866Z", "completed_at": "2026-02-04T10:56:44.129167Z"}, {"name": "execute", "started_at": "2026-02-04T10:56:44.129428Z", "completed_at": "2026-02-04T10:56:45.299030Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1749541759490967, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c22f90-0001-7ab6-0003-1e32000bf182"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.bain_capital_analytics.report_ic_dashboard", "compiled": true, "compiled_code": "-- Pipeline C: REPORT table - Investment Committee dashboard\n\nwith latest_fund_performance as (\n    select\n        fp.fund_id,\n        fp.fund_name,\n        fp.fund_type,\n        fp.committed_capital,\n        fp.valuation_date,\n        fp.fund_nav,\n        fp.fund_gav,\n        fp.fund_nav_return,\n        fp.tvpi_gross,\n        fp.fund_approx_irr,\n        fp.fund_tvpi,\n        fp.fund_dpi,\n        fp.num_portfolios,\n        fp.fund_total_invested,\n        fp.fund_total_distributed\n    from DBT_DEMO.DEV.fact_fund_performance fp\n    qualify row_number() over (\n        partition by fp.fund_id\n        order by fp.valuation_date desc\n    ) = 1\n),\n\nlatest_portfolio_summary as (\n    select\n        ps.portfolio_id,\n        ps.portfolio_name,\n        ps.strategy,\n        ps.fund_id,\n        ps.position_date,\n        ps.total_market_value,\n        ps.total_unrealized_pnl,\n        ps.portfolio_return_pct,\n        ps.num_positions\n    from DBT_DEMO.DEV.fact_portfolio_summary ps\n    qualify row_number() over (\n        partition by ps.portfolio_id\n        order by ps.position_date desc\n    ) = 1\n),\n\nfund_overview as (\n    select\n        lfp.fund_id,\n        lfp.fund_name,\n        lfp.fund_type,\n        lfp.committed_capital,\n        lfp.valuation_date as latest_valuation_date,\n        lfp.fund_nav,\n        lfp.fund_gav,\n        lfp.fund_nav_return as latest_nav_return,\n        lfp.tvpi_gross,\n        lfp.fund_approx_irr,\n        lfp.fund_tvpi,\n        lfp.fund_dpi,\n        lfp.num_portfolios,\n        lfp.fund_total_invested,\n        lfp.fund_total_distributed,\n        fs.management_fee_rate,\n        fs.carry_rate,\n        fs.hurdle_rate,\n        fs.vintage_year\n    from latest_fund_performance lfp\n    inner join DBT_DEMO.DEV.stg_fund_structures fs\n        on lfp.fund_id = fs.fund_id\n),\n\nportfolio_details as (\n    select\n        lps.portfolio_id,\n        lps.portfolio_name,\n        lps.strategy,\n        lps.fund_id,\n        lps.total_market_value,\n        lps.total_unrealized_pnl,\n        lps.portfolio_return_pct,\n        lps.num_positions,\n        case\n            when extract(month from lps.position_date) between 1 and 3 then 'Q3'\n            when extract(month from lps.position_date) between 4 and 6 then 'Q4'\n            when extract(month from lps.position_date) between 7 and 9 then 'Q1'\n            when extract(month from lps.position_date) between 10 and 12 then 'Q2'\n        end as reporting_fiscal_quarter\n    from latest_portfolio_summary lps\n)\n\nselect\n    fo.fund_id,\n    fo.fund_name,\n    fo.fund_type,\n    fo.vintage_year,\n    fo.committed_capital,\n    fo.latest_valuation_date,\n    fo.fund_nav,\n    fo.fund_gav,\n    fo.latest_nav_return,\n    fo.tvpi_gross,\n    fo.fund_approx_irr,\n    fo.fund_tvpi,\n    fo.fund_dpi,\n    fo.num_portfolios,\n    fo.fund_total_invested,\n    fo.fund_total_distributed,\n    fo.management_fee_rate,\n    fo.carry_rate,\n    fo.hurdle_rate,\n    pd.portfolio_id,\n    pd.portfolio_name,\n    pd.strategy,\n    pd.total_market_value as portfolio_mv,\n    pd.total_unrealized_pnl as portfolio_unrealized_pnl,\n    pd.portfolio_return_pct,\n    pd.num_positions as portfolio_num_positions,\n    pd.reporting_fiscal_quarter\nfrom fund_overview fo\ninner join portfolio_details pd\n    on fo.fund_id = pd.fund_id\norder by fo.fund_nav desc, pd.total_market_value desc", "relation_name": "DBT_DEMO.DEV.report_ic_dashboard", "batch_results": null}], "elapsed_time": 8.283710241317749, "args": {"require_yaml_configuration_for_mf_time_spines": false, "printer_width": 80, "require_generic_test_arguments_property": true, "source_freshness_run_project_hooks": true, "log_format_file": "debug", "log_path": "/Users/nedazarei/Documents/turintech/sample-dbt/snowflake/logs", "write_json": true, "send_anonymous_usage_stats": true, "use_colors_file": true, "require_resource_names_without_spaces": true, "require_nested_cumulative_type_params": false, "skip_nodes_if_on_run_start_fails": false, "invocation_command": "dbt run --select tag:pipeline_c", "partial_parse_file_diff": true, "log_format": "default", "populate_cache": true, "select": ["tag:pipeline_c"], "strict_mode": false, "vars": {}, "state_modified_compare_vars": false, "validate_macro_args": false, "which": "run", "favor_state": false, "log_level_file": "debug", "use_fast_test_edges": false, "version_check": true, "show_all_deprecations": false, "quiet": false, "require_all_warnings_handled_by_warn_error": false, "require_batched_execution_for_custom_microbatch_strategy": false, "project_dir": "/Users/nedazarei/Documents/turintech/sample-dbt/snowflake", "empty": false, "log_file_max_bytes": 10485760, "cache_selected_only": false, "state_modified_compare_more_unrendered_values": false, "print": true, "partial_parse": true, "defer": false, "require_unique_project_resource_names": false, "static_parser": true, "profiles_dir": "/Users/nedazarei/Documents/turintech/sample-dbt/snowflake", "warn_error_options": {"error": [], "warn": [], "silence": []}, "introspect": true, "macro_debugging": false, "indirect_selection": "eager", "require_explicit_package_overrides_for_builtin_materializations": true, "require_ref_searches_node_package_before_root": false, "show_resource_report": false, "use_colors": true, "exclude": [], "upload_to_artifacts_ingest_api": false, "log_level": "info"}}