[0m00:01:25.708767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109060e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc73fd0>]}


============================== 00:01:25.712707 | e49ef0e2-d3c0-466b-841f-0b67e76a3a33 ==============================
[0m00:01:25.712707 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:01:25.713209 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'invocation_command': 'dbt debug --profiles-dir . --project-dir .', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': 'logs', 'static_parser': 'True', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'empty': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'profiles_dir': '.', 'printer_width': '80', 'fail_fast': 'False'}
[0m00:01:25.728309 [info ] [MainThread]: dbt version: 1.11.4
[0m00:01:25.728659 [info ] [MainThread]: python version: 3.11.14
[0m00:01:25.728904 [info ] [MainThread]: python path: /Users/nedazarei/Documents/turintech/dbtttttt/snowflake3/.venv/bin/python3.11
[0m00:01:25.729112 [info ] [MainThread]: os info: macOS-26.2-arm64-arm-64bit
[0m00:01:27.878340 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m00:01:27.879262 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m00:01:27.879950 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m00:01:27.932353 [info ] [MainThread]: Using profiles dir at .
[0m00:01:27.932999 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m00:01:27.933227 [info ] [MainThread]: Using dbt_project.yml file at ./dbt_project.yml
[0m00:01:27.933950 [info ] [MainThread]: adapter type: snowflake
[0m00:01:27.934150 [info ] [MainThread]: adapter version: 1.11.1
[0m00:01:28.023166 [info ] [MainThread]: Configuration:
[0m00:01:28.023541 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:01:28.023745 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:01:28.023933 [info ] [MainThread]: Required dependencies:
[0m00:01:28.024183 [debug] [MainThread]: Executing "git --help"
[0m00:01:28.057118 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:01:28.057837 [debug] [MainThread]: STDERR: "b''"
[0m00:01:28.058102 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:01:28.058340 [info ] [MainThread]: Connection:
[0m00:01:28.058591 [info ] [MainThread]:   account: PZXTMSC-WP48482
[0m00:01:28.058775 [info ] [MainThread]:   user: NDAWZZ
[0m00:01:28.058953 [info ] [MainThread]:   database: DBT_DEMO
[0m00:01:28.059128 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m00:01:28.059295 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m00:01:28.059466 [info ] [MainThread]:   schema: DEV
[0m00:01:28.059630 [info ] [MainThread]:   authenticator: None
[0m00:01:28.059801 [info ] [MainThread]:   oauth_client_id: None
[0m00:01:28.059964 [info ] [MainThread]:   query_tag: None
[0m00:01:28.060130 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:01:28.060299 [info ] [MainThread]:   host: None
[0m00:01:28.060464 [info ] [MainThread]:   port: None
[0m00:01:28.060628 [info ] [MainThread]:   proxy_host: None
[0m00:01:28.060799 [info ] [MainThread]:   proxy_port: None
[0m00:01:28.060960 [info ] [MainThread]:   protocol: None
[0m00:01:28.061125 [info ] [MainThread]:   connect_retries: 1
[0m00:01:28.061285 [info ] [MainThread]:   connect_timeout: None
[0m00:01:28.061448 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:01:28.061661 [info ] [MainThread]:   retry_all: False
[0m00:01:28.062037 [info ] [MainThread]:   insecure_mode: False
[0m00:01:28.062234 [info ] [MainThread]:   reuse_connections: True
[0m00:01:28.062409 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m00:01:28.062579 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m00:01:28.062997 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m00:01:28.161186 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:01:28.200100 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:01:28.200448 [debug] [MainThread]: On debug: select 1 as id
[0m00:01:28.200659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:01:31.469533 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.269 seconds
[0m00:01:31.470609 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:01:31.471141 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:01:31.480873 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.8286867, "process_in_blocks": "0", "process_kernel_time": 0.363166, "process_mem_max_rss": "161169408", "process_out_blocks": "0", "process_user_time": 1.663044}
[0m00:01:31.481772 [debug] [MainThread]: Command `dbt debug` succeeded at 00:01:31.481611 after 5.83 seconds
[0m00:01:31.482317 [debug] [MainThread]: Connection 'debug' was left open.
[0m00:01:31.482693 [debug] [MainThread]: On debug: Close
[0m00:01:31.975513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbfdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc67b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a9050>]}
[0m00:01:31.976704 [debug] [MainThread]: Flushing usage events
[0m00:01:33.176766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:01:46.360982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b435350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b49fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b49fd50>]}


============================== 00:01:46.364446 | 4ba468f1-6eb8-49c6-921d-b5d0ffe9a62d ==============================
[0m00:01:46.364446 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:01:46.364926 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'log_path': 'logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profiles-dir . --project-dir .', 'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'version_check': 'True', 'use_colors': 'True'}
[0m00:01:46.452785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ba468f1-6eb8-49c6-921d-b5d0ffe9a62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4292d0>]}
[0m00:01:46.464268 [debug] [MainThread]: Set downloads directory='/var/folders/9d/rc17811j07v56khq2t9t7h5m0000gn/T/dbt-downloads-veeljaaz'
[0m00:01:46.464685 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:01:47.068696 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:01:47.071595 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:01:47.467657 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:01:47.484698 [info ] [MainThread]: Updating lock file in file path: /Users/nedazarei/Documents/turintech/dbtttttt/snowflake3/package-lock.yml
[0m00:01:47.487728 [debug] [MainThread]: Set downloads directory='/var/folders/9d/rc17811j07v56khq2t9t7h5m0000gn/T/dbt-downloads-jx2ihpcg'
[0m00:01:47.490853 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:01:48.569628 [info ] [MainThread]: Installed from version 1.3.3
[0m00:01:48.569978 [info ] [MainThread]: Up to date!
[0m00:01:48.570258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ba468f1-6eb8-49c6-921d-b5d0ffe9a62d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a57450>]}
[0m00:01:48.572856 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.2625093, "process_in_blocks": "0", "process_kernel_time": 0.231202, "process_mem_max_rss": "121405440", "process_out_blocks": "0", "process_user_time": 1.1424}
[0m00:01:48.573269 [debug] [MainThread]: Command `dbt deps` succeeded at 00:01:48.573184 after 2.26 seconds
[0m00:01:48.573542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4bca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b49fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072523d0>]}
[0m00:01:48.573803 [debug] [MainThread]: Flushing usage events
[0m00:01:49.897830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:02:47.729363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e34b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e92110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea9410>]}


============================== 00:02:47.732722 | 09fd8071-6b40-4608-9d6a-f94a4463e05e ==============================
[0m00:02:47.732722 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:02:47.733188 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt seed --profiles-dir . --project-dir .', 'empty': 'None', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '.', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': 'logs', 'debug': 'False', 'indirect_selection': 'eager'}
[0m00:02:47.957490 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m00:02:47.957929 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m00:02:47.958178 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m00:02:48.081558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e34550>]}
[0m00:02:48.124924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff6d90>]}
[0m00:02:48.125691 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m00:02:48.229425 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m00:02:48.230102 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:02:48.230373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acf6510>]}
[0m00:02:49.469079 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_positions' in
package 'bain_capital_analytics' (models/staging/_staging.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m00:02:49.469689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c65d0>]}
[0m00:02:49.631217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd7e0d0>]}
[0m00:02:49.719909 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m00:02:49.721956 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m00:02:49.739319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abdc190>]}
[0m00:02:49.739795 [info ] [MainThread]: Found 28 models, 53 data tests, 10 seeds, 644 macros
[0m00:02:49.740060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4f3d0>]}
[0m00:02:49.742585 [info ] [MainThread]: 
[0m00:02:49.742838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:02:49.743024 [info ] [MainThread]: 
[0m00:02:49.743374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:02:49.746988 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO'
[0m00:02:49.790659 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO"
[0m00:02:49.790985 [debug] [ThreadPool]: On list_DBT_DEMO: show terse schemas in database DBT_DEMO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "connection_name": "list_DBT_DEMO"} */
[0m00:02:49.791190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:51.782487 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.991 seconds
[0m00:02:51.788941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEMO, now list_DBT_DEMO_DEV_raw)
[0m00:02:51.789547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO_DEV'
[0m00:02:51.804803 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV_raw"
[0m00:02:51.861062 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV"
[0m00:02:51.861410 [debug] [ThreadPool]: On list_DBT_DEMO_DEV_raw: show objects in DBT_DEMO.DEV_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV_raw"} */;
[0m00:02:51.861640 [debug] [ThreadPool]: On list_DBT_DEMO_DEV: show objects in DBT_DEMO.DEV
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV"} */;
[0m00:02:51.862330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:52.129303 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.267 seconds
[0m00:02:53.436447 [debug] [ThreadPool]: SQL status: SUCCESS 45 in 1.574 seconds
[0m00:02:53.446287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf908d0>]}
[0m00:02:53.451797 [debug] [Thread-2 (]: Began running node seed.bain_capital_analytics.raw_benchmarks
[0m00:02:53.452374 [debug] [Thread-3 (]: Began running node seed.bain_capital_analytics.raw_cashflows
[0m00:02:53.452771 [debug] [Thread-4 (]: Began running node seed.bain_capital_analytics.raw_counterparties
[0m00:02:53.453590 [debug] [Thread-5 (]: Began running node seed.bain_capital_analytics.raw_dates
[0m00:02:53.453264 [info ] [Thread-2 (]: 1 of 10 START seed file DEV_raw.raw_benchmarks ................................. [RUN]
[0m00:02:53.454158 [info ] [Thread-3 (]: 2 of 10 START seed file DEV_raw.raw_cashflows .................................. [RUN]
[0m00:02:53.454602 [info ] [Thread-4 (]: 3 of 10 START seed file DEV_raw.raw_counterparties ............................. [RUN]
[0m00:02:53.455021 [info ] [Thread-5 (]: 4 of 10 START seed file DEV_raw.raw_dates ...................................... [RUN]
[0m00:02:53.455456 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV_raw, now seed.bain_capital_analytics.raw_benchmarks)
[0m00:02:53.455802 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV, now seed.bain_capital_analytics.raw_cashflows)
[0m00:02:53.456166 [debug] [Thread-4 (]: Acquiring new snowflake connection 'seed.bain_capital_analytics.raw_counterparties'
[0m00:02:53.456494 [debug] [Thread-5 (]: Acquiring new snowflake connection 'seed.bain_capital_analytics.raw_dates'
[0m00:02:53.456764 [debug] [Thread-2 (]: Began compiling node seed.bain_capital_analytics.raw_benchmarks
[0m00:02:53.457017 [debug] [Thread-3 (]: Began compiling node seed.bain_capital_analytics.raw_cashflows
[0m00:02:53.457279 [debug] [Thread-4 (]: Began compiling node seed.bain_capital_analytics.raw_counterparties
[0m00:02:53.457522 [debug] [Thread-5 (]: Began compiling node seed.bain_capital_analytics.raw_dates
[0m00:02:53.457778 [debug] [Thread-2 (]: Began executing node seed.bain_capital_analytics.raw_benchmarks
[0m00:02:53.458036 [debug] [Thread-3 (]: Began executing node seed.bain_capital_analytics.raw_cashflows
[0m00:02:53.458280 [debug] [Thread-4 (]: Began executing node seed.bain_capital_analytics.raw_counterparties
[0m00:02:53.458519 [debug] [Thread-5 (]: Began executing node seed.bain_capital_analytics.raw_dates
[0m00:02:53.494990 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m00:02:53.500119 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m00:02:53.502949 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m00:02:53.503216 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_benchmarks: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m00:02:53.504917 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m00:02:53.505182 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_counterparties: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m00:02:53.505422 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_dates: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m00:02:53.505920 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_cashflows: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m00:02:53.506427 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:02:53.507001 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:02:53.717580 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m00:02:53.717959 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m00:02:53.718482 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_cashflows: truncate table "DBT_DEMO"."DEV_RAW"."RAW_CASHFLOWS"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */;
[0m00:02:53.719046 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m00:02:53.719701 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m00:02:53.720220 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_benchmarks: truncate table "DBT_DEMO"."DEV_RAW"."RAW_BENCHMARKS"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */;
[0m00:02:54.564205 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m00:02:54.565769 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m00:02:54.566262 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m00:02:54.566635 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m00:02:54.566926 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_cashflows: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m00:02:54.567194 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_benchmarks: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m00:02:55.033934 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m00:02:55.035221 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m00:02:55.049475 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m00:02:55.050342 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.543 seconds
[0m00:02:55.052015 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m00:02:55.052311 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_cashflows: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m00:02:55.052628 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m00:02:55.052992 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_benchmarks: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m00:02:55.053585 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_dates: truncate table "DBT_DEMO"."DEV_RAW"."RAW_DATES"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */;
[0m00:02:55.254823 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m00:02:55.255912 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m00:02:55.257666 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m00:02:55.259293 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m00:02:55.259751 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_benchmarks: insert into DBT_DEMO.DEV_raw.raw_benchmarks (benchmark_id, benchmark_name, benchmark_date, return_daily, return_mtd, return_ytd, benchmark_level) values
            (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%...
[0m00:02:55.260152 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_cashflows: insert into DBT_DEMO.DEV_raw.raw_cashflows (cashflow_id, fund_id, portfolio_id, cashflow_date, cashflow_type, amount, currency, description, investor_id) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%...
[0m00:02:55.487273 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.981 seconds
[0m00:02:55.488008 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m00:02:55.488305 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_counterparties: truncate table "DBT_DEMO"."DEV_RAW"."RAW_COUNTERPARTIES"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */;
[0m00:02:56.051465 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.996 seconds
[0m00:02:56.052717 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m00:02:56.053214 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_dates: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m00:02:56.290780 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m00:02:56.292147 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m00:02:56.292924 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_counterparties: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m00:02:56.426451 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m00:02:56.429840 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m00:02:56.430445 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_dates: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m00:02:56.629873 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m00:02:56.632495 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m00:02:56.633249 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_dates: insert into DBT_DEMO.DEV_raw.raw_dates (date_day, is_business_day, is_month_end, is_quarter_end, is_year_end, fiscal_quarter, fiscal_year) values
            (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s)
/* {"app"...
[0m00:02:56.667984 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m00:02:56.670544 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m00:02:56.671011 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_counterparties: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m00:02:56.875358 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m00:02:56.876940 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m00:02:56.877418 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_counterparties: insert into DBT_DEMO.DEV_raw.raw_counterparties (counterparty_id, counterparty_name, counterparty_type, country, credit_rating, is_active) values
            (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cou...
[0m00:02:56.940757 [debug] [Thread-3 (]: SQL status: SUCCESS 25 in 1.679 seconds
[0m00:02:56.942099 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_cashflows"
[0m00:02:56.942798 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_cashflows: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_cashflows"} */
[0m00:02:56.962771 [debug] [Thread-2 (]: SQL status: SUCCESS 30 in 1.702 seconds
[0m00:02:56.964134 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_benchmarks"
[0m00:02:56.964757 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_benchmarks: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_benchmarks"} */
[0m00:02:57.340931 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m00:02:57.348449 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_benchmarks"
[0m00:02:57.370196 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m00:02:57.370804 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_cashflows"
[0m00:02:57.371327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abff590>]}
[0m00:02:57.372636 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be74050>]}
[0m00:02:57.372995 [info ] [Thread-2 (]: 1 of 10 OK loaded seed file DEV_raw.raw_benchmarks ............................. [[32mINSERT 30[0m in 3.91s]
[0m00:02:57.373366 [info ] [Thread-3 (]: 2 of 10 OK loaded seed file DEV_raw.raw_cashflows .............................. [[32mINSERT 25[0m in 3.92s]
[0m00:02:57.373733 [debug] [Thread-2 (]: Finished running node seed.bain_capital_analytics.raw_benchmarks
[0m00:02:57.374047 [debug] [Thread-3 (]: Finished running node seed.bain_capital_analytics.raw_cashflows
[0m00:02:57.374314 [debug] [Thread-2 (]: Began running node seed.bain_capital_analytics.raw_fund_structures
[0m00:02:57.374642 [debug] [Thread-3 (]: Began running node seed.bain_capital_analytics.raw_instruments
[0m00:02:57.375030 [info ] [Thread-2 (]: 5 of 10 START seed file DEV_raw.raw_fund_structures ............................ [RUN]
[0m00:02:57.375363 [info ] [Thread-3 (]: 6 of 10 START seed file DEV_raw.raw_instruments ................................ [RUN]
[0m00:02:57.375664 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_benchmarks, now seed.bain_capital_analytics.raw_fund_structures)
[0m00:02:57.375929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_cashflows, now seed.bain_capital_analytics.raw_instruments)
[0m00:02:57.376173 [debug] [Thread-2 (]: Began compiling node seed.bain_capital_analytics.raw_fund_structures
[0m00:02:57.376398 [debug] [Thread-3 (]: Began compiling node seed.bain_capital_analytics.raw_instruments
[0m00:02:57.376629 [debug] [Thread-2 (]: Began executing node seed.bain_capital_analytics.raw_fund_structures
[0m00:02:57.376864 [debug] [Thread-3 (]: Began executing node seed.bain_capital_analytics.raw_instruments
[0m00:02:57.385205 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m00:02:57.386878 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m00:02:57.387152 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_fund_structures: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m00:02:57.387403 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_instruments: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m00:02:57.671176 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.283 seconds
[0m00:02:57.672295 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m00:02:57.672746 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_instruments: truncate table "DBT_DEMO"."DEV_RAW"."RAW_INSTRUMENTS"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */;
[0m00:02:57.682023 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m00:02:57.682605 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m00:02:57.683006 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_fund_structures: truncate table "DBT_DEMO"."DEV_RAW"."RAW_FUND_STRUCTURES"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */;
[0m00:02:57.900101 [debug] [Thread-5 (]: SQL status: SUCCESS 15 in 1.266 seconds
[0m00:02:57.901580 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_dates"
[0m00:02:57.902143 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_dates: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_dates"} */
[0m00:02:58.044806 [debug] [Thread-4 (]: SQL status: SUCCESS 10 in 1.167 seconds
[0m00:02:58.046183 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_counterparties"
[0m00:02:58.046893 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_counterparties: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_counterparties"} */
[0m00:02:58.304858 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m00:02:58.306240 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m00:02:58.307013 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_instruments: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m00:02:58.323418 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m00:02:58.324472 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_dates"
[0m00:02:58.327488 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c67bfd0>]}
[0m00:02:58.328098 [info ] [Thread-5 (]: 4 of 10 OK loaded seed file DEV_raw.raw_dates .................................. [[32mINSERT 15[0m in 4.87s]
[0m00:02:58.328665 [debug] [Thread-5 (]: Finished running node seed.bain_capital_analytics.raw_dates
[0m00:02:58.329073 [debug] [Thread-5 (]: Began running node seed.bain_capital_analytics.raw_portfolios
[0m00:02:58.329742 [info ] [Thread-5 (]: 7 of 10 START seed file DEV_raw.raw_portfolios ................................. [RUN]
[0m00:02:58.330320 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_dates, now seed.bain_capital_analytics.raw_portfolios)
[0m00:02:58.330679 [debug] [Thread-5 (]: Began compiling node seed.bain_capital_analytics.raw_portfolios
[0m00:02:58.331021 [debug] [Thread-5 (]: Began executing node seed.bain_capital_analytics.raw_portfolios
[0m00:02:58.339855 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m00:02:58.340338 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_portfolios: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m00:02:58.359429 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m00:02:58.359886 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m00:02:58.360217 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_fund_structures: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m00:02:58.421804 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m00:02:58.423678 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_counterparties"
[0m00:02:58.426987 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0cfa90>]}
[0m00:02:58.427488 [info ] [Thread-4 (]: 3 of 10 OK loaded seed file DEV_raw.raw_counterparties ......................... [[32mINSERT 10[0m in 4.97s]
[0m00:02:58.427934 [debug] [Thread-4 (]: Finished running node seed.bain_capital_analytics.raw_counterparties
[0m00:02:58.428256 [debug] [Thread-4 (]: Began running node seed.bain_capital_analytics.raw_positions
[0m00:02:58.428763 [info ] [Thread-4 (]: 8 of 10 START seed file DEV_raw.raw_positions .................................. [RUN]
[0m00:02:58.429148 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_counterparties, now seed.bain_capital_analytics.raw_positions)
[0m00:02:58.429423 [debug] [Thread-4 (]: Began compiling node seed.bain_capital_analytics.raw_positions
[0m00:02:58.429660 [debug] [Thread-4 (]: Began executing node seed.bain_capital_analytics.raw_positions
[0m00:02:58.435254 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m00:02:58.435543 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_positions: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m00:02:58.546230 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m00:02:58.547273 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m00:02:58.547864 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_portfolios: truncate table "DBT_DEMO"."DEV_RAW"."RAW_PORTFOLIOS"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */;
[0m00:02:58.624311 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m00:02:58.625192 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m00:02:58.625625 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_positions: truncate table "DBT_DEMO"."DEV_RAW"."RAW_POSITIONS"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */;
[0m00:02:58.694932 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m00:02:58.697791 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m00:02:58.698218 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_instruments: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m00:02:58.736687 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m00:02:58.739146 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m00:02:58.739581 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_fund_structures: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m00:02:58.900414 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m00:02:58.902611 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m00:02:58.903131 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_instruments: insert into DBT_DEMO.DEV_raw.raw_instruments (instrument_id, instrument_name, instrument_type, sector, currency, exchange, issuer, maturity_date) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s...
[0m00:02:58.920694 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m00:02:58.922004 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m00:02:58.922443 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_fund_structures: insert into DBT_DEMO.DEV_raw.raw_fund_structures (fund_id, fund_name, fund_type, vintage_year, committed_capital, management_fee_rate, carry_rate, hurdle_rate, gp_commitment_pct, fund_currency, fund_status) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */...
[0m00:02:59.161997 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m00:02:59.163658 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m00:02:59.164714 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m00:02:59.165108 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_portfolios: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m00:02:59.165600 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m00:02:59.166374 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_positions: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m00:02:59.500270 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.334 seconds
[0m00:02:59.503160 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m00:02:59.503654 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_portfolios: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m00:02:59.533492 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m00:02:59.537290 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m00:02:59.537925 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_positions: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m00:02:59.649737 [debug] [Thread-3 (]: SQL status: SUCCESS 20 in 0.746 seconds
[0m00:02:59.650784 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_instruments"
[0m00:02:59.651209 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_instruments: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_instruments"} */
[0m00:02:59.688273 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m00:02:59.689820 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m00:02:59.690353 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_portfolios: insert into DBT_DEMO.DEV_raw.raw_portfolios (portfolio_id, portfolio_name, strategy, inception_date, fund_id, manager_name, is_active) values
            (%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s)
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */...
[0m00:02:59.700207 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.777 seconds
[0m00:02:59.701149 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_fund_structures"
[0m00:02:59.701489 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_fund_structures: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_fund_structures"} */
[0m00:02:59.784160 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m00:02:59.787260 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m00:02:59.787721 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_positions: insert into DBT_DEMO.DEV_raw.raw_positions (position_id, portfolio_id, instrument_id, position_date, quantity, market_value, cost_basis, currency) values
            (%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%...
[0m00:03:00.016940 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m00:03:00.018216 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_instruments"
[0m00:03:00.024248 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1a8b10>]}
[0m00:03:00.025078 [info ] [Thread-3 (]: 6 of 10 OK loaded seed file DEV_raw.raw_instruments ............................ [[32mINSERT 20[0m in 2.65s]
[0m00:03:00.025606 [debug] [Thread-3 (]: Finished running node seed.bain_capital_analytics.raw_instruments
[0m00:03:00.025957 [debug] [Thread-3 (]: Began running node seed.bain_capital_analytics.raw_trades
[0m00:03:00.026839 [info ] [Thread-3 (]: 9 of 10 START seed file DEV_raw.raw_trades ..................................... [RUN]
[0m00:03:00.027595 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_instruments, now seed.bain_capital_analytics.raw_trades)
[0m00:03:00.028003 [debug] [Thread-3 (]: Began compiling node seed.bain_capital_analytics.raw_trades
[0m00:03:00.028346 [debug] [Thread-3 (]: Began executing node seed.bain_capital_analytics.raw_trades
[0m00:03:00.036718 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m00:03:00.037030 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_trades: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m00:03:00.038917 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m00:03:00.039559 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_fund_structures"
[0m00:03:00.041620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b26fe50>]}
[0m00:03:00.042022 [info ] [Thread-2 (]: 5 of 10 OK loaded seed file DEV_raw.raw_fund_structures ........................ [[32mINSERT 3[0m in 2.67s]
[0m00:03:00.042408 [debug] [Thread-2 (]: Finished running node seed.bain_capital_analytics.raw_fund_structures
[0m00:03:00.042675 [debug] [Thread-2 (]: Began running node seed.bain_capital_analytics.raw_valuations
[0m00:03:00.043058 [info ] [Thread-2 (]: 10 of 10 START seed file DEV_raw.raw_valuations ................................ [RUN]
[0m00:03:00.043328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.bain_capital_analytics.raw_fund_structures, now seed.bain_capital_analytics.raw_valuations)
[0m00:03:00.043571 [debug] [Thread-2 (]: Began compiling node seed.bain_capital_analytics.raw_valuations
[0m00:03:00.043786 [debug] [Thread-2 (]: Began executing node seed.bain_capital_analytics.raw_valuations
[0m00:03:00.048644 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m00:03:00.048904 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_valuations: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m00:03:00.242971 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m00:03:00.244171 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m00:03:00.244808 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_valuations: truncate table "DBT_DEMO"."DEV_RAW"."RAW_VALUATIONS"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */;
[0m00:03:00.345692 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m00:03:00.346795 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m00:03:00.347256 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_trades: truncate table "DBT_DEMO"."DEV_RAW"."RAW_TRADES"
  
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */;
[0m00:03:00.742408 [debug] [Thread-4 (]: SQL status: SUCCESS 30 in 0.954 seconds
[0m00:03:00.743438 [debug] [Thread-4 (]: Using snowflake connection "seed.bain_capital_analytics.raw_positions"
[0m00:03:00.743860 [debug] [Thread-4 (]: On seed.bain_capital_analytics.raw_positions: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_positions"} */
[0m00:03:00.780763 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 1.090 seconds
[0m00:03:00.782154 [debug] [Thread-5 (]: Using snowflake connection "seed.bain_capital_analytics.raw_portfolios"
[0m00:03:00.782902 [debug] [Thread-5 (]: On seed.bain_capital_analytics.raw_portfolios: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_portfolios"} */
[0m00:03:00.848717 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m00:03:00.850050 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m00:03:00.850771 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_valuations: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m00:03:00.864302 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m00:03:00.865069 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m00:03:00.865567 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_trades: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m00:03:01.160849 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m00:03:01.164835 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m00:03:01.165400 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_trades: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m00:03:01.255756 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m00:03:01.256973 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_positions"
[0m00:03:01.260147 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be3a450>]}
[0m00:03:01.260788 [info ] [Thread-4 (]: 8 of 10 OK loaded seed file DEV_raw.raw_positions .............................. [[32mINSERT 30[0m in 2.83s]
[0m00:03:01.261299 [debug] [Thread-4 (]: Finished running node seed.bain_capital_analytics.raw_positions
[0m00:03:01.363226 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m00:03:01.365094 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_portfolios"
[0m00:03:01.368620 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1edc50>]}
[0m00:03:01.369209 [info ] [Thread-5 (]: 7 of 10 OK loaded seed file DEV_raw.raw_portfolios ............................. [[32mINSERT 5[0m in 3.04s]
[0m00:03:01.369714 [debug] [Thread-5 (]: Finished running node seed.bain_capital_analytics.raw_portfolios
[0m00:03:01.377061 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m00:03:01.379458 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m00:03:01.379891 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_valuations: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m00:03:01.448499 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m00:03:01.451949 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m00:03:01.452510 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_trades: insert into DBT_DEMO.DEV_raw.raw_trades (trade_id, portfolio_id, instrument_id, counterparty_id, trade_date, settlement_date, trade_type, quantity, price, notional_amount, commission, currency, status) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,...
[0m00:03:01.573287 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m00:03:01.575425 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m00:03:01.575928 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_valuations: insert into DBT_DEMO.DEV_raw.raw_valuations (valuation_id, portfolio_id, valuation_date, gross_asset_value, net_asset_value, total_liabilities, unrealized_pnl, realized_pnl, valuation_method) values
            (%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m00:03:02.356585 [debug] [Thread-3 (]: SQL status: SUCCESS 30 in 0.903 seconds
[0m00:03:02.357681 [debug] [Thread-3 (]: Using snowflake connection "seed.bain_capital_analytics.raw_trades"
[0m00:03:02.358280 [debug] [Thread-3 (]: On seed.bain_capital_analytics.raw_trades: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_trades"} */
[0m00:03:02.727850 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m00:03:02.729460 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_trades"
[0m00:03:02.732916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3de10>]}
[0m00:03:02.733844 [info ] [Thread-3 (]: 9 of 10 OK loaded seed file DEV_raw.raw_trades ................................. [[32mINSERT 30[0m in 2.71s]
[0m00:03:02.734638 [debug] [Thread-3 (]: Finished running node seed.bain_capital_analytics.raw_trades
[0m00:03:02.860929 [debug] [Thread-2 (]: SQL status: SUCCESS 21 in 1.284 seconds
[0m00:03:02.862043 [debug] [Thread-2 (]: Using snowflake connection "seed.bain_capital_analytics.raw_valuations"
[0m00:03:02.862500 [debug] [Thread-2 (]: On seed.bain_capital_analytics.raw_valuations: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "seed.bain_capital_analytics.raw_valuations"} */
[0m00:03:04.040385 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.177 seconds
[0m00:03:04.042214 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.bain_capital_analytics.raw_valuations"
[0m00:03:04.045209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09fd8071-6b40-4608-9d6a-f94a4463e05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b26cd10>]}
[0m00:03:04.045699 [info ] [Thread-2 (]: 10 of 10 OK loaded seed file DEV_raw.raw_valuations ............................ [[32mINSERT 21[0m in 4.00s]
[0m00:03:04.046114 [debug] [Thread-2 (]: Finished running node seed.bain_capital_analytics.raw_valuations
[0m00:03:04.047864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:04.048345 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_valuations' was left open.
[0m00:03:04.048643 [debug] [MainThread]: On seed.bain_capital_analytics.raw_valuations: Close
[0m00:03:04.390910 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_trades' was left open.
[0m00:03:04.391695 [debug] [MainThread]: On seed.bain_capital_analytics.raw_trades: Close
[0m00:03:04.707072 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_positions' was left open.
[0m00:03:04.707847 [debug] [MainThread]: On seed.bain_capital_analytics.raw_positions: Close
[0m00:03:05.024829 [debug] [MainThread]: Connection 'seed.bain_capital_analytics.raw_portfolios' was left open.
[0m00:03:05.025636 [debug] [MainThread]: On seed.bain_capital_analytics.raw_portfolios: Close
[0m00:03:05.417585 [info ] [MainThread]: 
[0m00:03:05.418463 [info ] [MainThread]: Finished running 10 seeds in 0 hours 0 minutes and 15.67 seconds (15.67s).
[0m00:03:05.420272 [debug] [MainThread]: Command end result
[0m00:03:05.462757 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m00:03:05.464458 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m00:03:05.468992 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m00:03:05.469251 [info ] [MainThread]: 
[0m00:03:05.469557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:03:05.469780 [info ] [MainThread]: 
[0m00:03:05.470009 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m00:03:05.470417 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:03:05.472663 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 17.79496, "process_in_blocks": "0", "process_kernel_time": 0.420322, "process_mem_max_rss": "180387840", "process_out_blocks": "0", "process_user_time": 3.832179}
[0m00:03:05.472980 [debug] [MainThread]: Command `dbt seed` succeeded at 00:03:05.472918 after 17.80 seconds
[0m00:03:05.473247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e93c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7e3d0>]}
[0m00:03:05.473507 [debug] [MainThread]: Flushing usage events
[0m00:03:06.792074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:05.862068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd498d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdad410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd49350>]}


============================== 00:19:05.866037 | e0060742-5b3a-4d7d-9bff-3f8682648269 ==============================
[0m00:19:05.866037 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:19:05.866505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'log_path': 'logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir . --project-dir .', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'empty': 'False', 'debug': 'False'}
[0m00:19:06.185393 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m00:19:06.185900 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m00:19:06.186144 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m00:19:06.312475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc45710>]}
[0m00:19:06.353848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af0ae90>]}
[0m00:19:06.354790 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m00:19:06.458310 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m00:19:06.610102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:19:06.610454 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:19:06.610664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:19:06.652594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d03c650>]}
[0m00:19:06.736113 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m00:19:06.738273 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m00:19:06.758528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d000b10>]}
[0m00:19:06.758907 [info ] [MainThread]: Found 28 models, 53 data tests, 10 seeds, 644 macros
[0m00:19:06.759191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0a1390>]}
[0m00:19:06.761896 [info ] [MainThread]: 
[0m00:19:06.762142 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:19:06.762329 [info ] [MainThread]: 
[0m00:19:06.762685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:06.766840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO'
[0m00:19:06.812596 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO"
[0m00:19:06.812915 [debug] [ThreadPool]: On list_DBT_DEMO: show terse schemas in database DBT_DEMO
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "connection_name": "list_DBT_DEMO"} */
[0m00:19:06.813126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:08.392642 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.579 seconds
[0m00:19:08.399906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_DEMO, now list_DBT_DEMO_DEV_raw)
[0m00:19:08.407641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO_DEV'
[0m00:19:08.414525 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV_raw"
[0m00:19:08.416443 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV"
[0m00:19:08.416724 [debug] [ThreadPool]: On list_DBT_DEMO_DEV_raw: show objects in DBT_DEMO.DEV_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV_raw"} */;
[0m00:19:08.416991 [debug] [ThreadPool]: On list_DBT_DEMO_DEV: show objects in DBT_DEMO.DEV
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV"} */;
[0m00:19:08.417588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:08.645655 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.228 seconds
[0m00:19:09.864749 [debug] [ThreadPool]: SQL status: SUCCESS 45 in 1.447 seconds
[0m00:19:09.874331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d096410>]}
[0m00:19:09.878845 [debug] [Thread-2 (]: Began running node model.bain_capital_analytics.stg_benchmarks
[0m00:19:09.879223 [debug] [Thread-3 (]: Began running node model.bain_capital_analytics.stg_cashflows
[0m00:19:09.879510 [debug] [Thread-4 (]: Began running node model.bain_capital_analytics.stg_counterparties
[0m00:19:09.879780 [debug] [Thread-5 (]: Began running node model.bain_capital_analytics.stg_dates
[0m00:19:09.880359 [info ] [Thread-2 (]: 1 of 28 START sql view model DEV.stg_benchmarks ................................ [RUN]
[0m00:19:09.880947 [info ] [Thread-3 (]: 2 of 28 START sql view model DEV.stg_cashflows ................................. [RUN]
[0m00:19:09.881613 [info ] [Thread-4 (]: 3 of 28 START sql view model DEV.stg_counterparties ............................ [RUN]
[0m00:19:09.882076 [info ] [Thread-5 (]: 4 of 28 START sql view model DEV.stg_dates ..................................... [RUN]
[0m00:19:09.882535 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV_raw, now model.bain_capital_analytics.stg_benchmarks)
[0m00:19:09.882880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV, now model.bain_capital_analytics.stg_cashflows)
[0m00:19:09.883307 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.bain_capital_analytics.stg_counterparties'
[0m00:19:09.883705 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.bain_capital_analytics.stg_dates'
[0m00:19:09.884035 [debug] [Thread-2 (]: Began compiling node model.bain_capital_analytics.stg_benchmarks
[0m00:19:09.884331 [debug] [Thread-3 (]: Began compiling node model.bain_capital_analytics.stg_cashflows
[0m00:19:09.884621 [debug] [Thread-4 (]: Began compiling node model.bain_capital_analytics.stg_counterparties
[0m00:19:09.884893 [debug] [Thread-5 (]: Began compiling node model.bain_capital_analytics.stg_dates
[0m00:19:09.891611 [debug] [Thread-2 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_benchmarks"
[0m00:19:09.893661 [debug] [Thread-3 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_cashflows"
[0m00:19:09.895517 [debug] [Thread-4 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_counterparties"
[0m00:19:09.897347 [debug] [Thread-5 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_dates"
[0m00:19:09.898397 [debug] [Thread-4 (]: Began executing node model.bain_capital_analytics.stg_counterparties
[0m00:19:09.898657 [debug] [Thread-2 (]: Began executing node model.bain_capital_analytics.stg_benchmarks
[0m00:19:09.898863 [debug] [Thread-5 (]: Began executing node model.bain_capital_analytics.stg_dates
[0m00:19:09.899098 [debug] [Thread-3 (]: Began executing node model.bain_capital_analytics.stg_cashflows
[0m00:19:09.962060 [debug] [Thread-4 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_counterparties"
[0m00:19:09.964423 [debug] [Thread-2 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_benchmarks"
[0m00:19:09.966567 [debug] [Thread-5 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_dates"
[0m00:19:09.968594 [debug] [Thread-3 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_cashflows"
[0m00:19:09.969920 [debug] [Thread-5 (]: Using snowflake connection "model.bain_capital_analytics.stg_dates"
[0m00:19:09.970847 [debug] [Thread-2 (]: Using snowflake connection "model.bain_capital_analytics.stg_benchmarks"
[0m00:19:09.971696 [debug] [Thread-3 (]: Using snowflake connection "model.bain_capital_analytics.stg_cashflows"
[0m00:19:09.971981 [debug] [Thread-5 (]: On model.bain_capital_analytics.stg_dates: create or replace   view DBT_DEMO.DEV.stg_dates
  
  
  
  
  as (
    select
    cast(date_day as date) as date_day,
    cast(is_business_day as boolean) as is_business_day,
    cast(is_month_end as boolean) as is_month_end,
    cast(is_quarter_end as boolean) as is_quarter_end,
    cast(is_year_end as boolean) as is_year_end,
    fiscal_quarter,
    fiscal_year,
    -- Anti-pattern: PostgreSQL-specific date_trunc
    date_trunc('month', cast(date_day as date)) as month_start,
    date_trunc('quarter', cast(date_day as date)) as quarter_start,
    extract(month from cast(date_day as date)) as calendar_month,
    extract(year from cast(date_day as date)) as calendar_year
from DBT_DEMO.DEV_raw.raw_dates
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_dates"} */;
[0m00:19:09.972504 [debug] [Thread-4 (]: Using snowflake connection "model.bain_capital_analytics.stg_counterparties"
[0m00:19:09.972775 [debug] [Thread-2 (]: On model.bain_capital_analytics.stg_benchmarks: create or replace   view DBT_DEMO.DEV.stg_benchmarks
  
  
  
  
  as (
    select distinct
    benchmark_id,
    benchmark_name,
    cast(benchmark_date as date) as benchmark_date,
    cast(return_daily as numeric(18,8)) as return_daily,
    cast(return_mtd as numeric(18,8)) as return_mtd,
    cast(return_ytd as numeric(18,8)) as return_ytd,
    cast(benchmark_level as numeric(18,4)) as benchmark_level,
    -- Anti-pattern: duplicated fiscal quarter logic
    case
        when extract(month from cast(benchmark_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(benchmark_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(benchmark_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(benchmark_date as date)) between 10 and 12 then 'Q2'
    end as benchmark_fiscal_quarter
from DBT_DEMO.DEV_raw.raw_benchmarks
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_benchmarks"} */;
[0m00:19:09.973073 [debug] [Thread-3 (]: On model.bain_capital_analytics.stg_cashflows: create or replace   view DBT_DEMO.DEV.stg_cashflows
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT
-- Anti-pattern: duplicated fiscal quarter logic
select distinct
    cashflow_id,
    fund_id,
    portfolio_id,
    cast(cashflow_date as date) as cashflow_date,
    cashflow_type,
    cast(amount as numeric(18,2)) as amount,
    currency,
    description,
    investor_id,
    -- Anti-pattern: duplicated fiscal quarter logic (same as stg_trades, stg_portfolios)
    case
        when extract(month from cast(cashflow_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(cashflow_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(cashflow_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(cashflow_date as date)) between 10 and 12 then 'Q2'
    end as cashflow_fiscal_quarter,
    -- Anti-pattern: PostgreSQL-specific extract
    extract(year from cast(cashflow_date as date)) as cashflow_year
from DBT_DEMO.DEV_raw.raw_cashflows
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_cashflows"} */;
[0m00:19:09.973344 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:19:09.973578 [debug] [Thread-4 (]: On model.bain_capital_analytics.stg_counterparties: create or replace   view DBT_DEMO.DEV.stg_counterparties
  
  
  
  
  as (
    select distinct
    counterparty_id,
    counterparty_name,
    counterparty_type,
    country,
    credit_rating,
    cast(is_active as boolean) as is_active
from DBT_DEMO.DEV_raw.raw_counterparties
where cast(is_active as boolean) = TRUE
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_counterparties"} */;
[0m00:19:09.975696 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:19:10.323826 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m00:19:10.352550 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeddad0>]}
[0m00:19:10.353221 [info ] [Thread-3 (]: 2 of 28 OK created sql view model DEV.stg_cashflows ............................ [[32mSUCCESS 1[0m in 0.46s]
[0m00:19:10.353643 [debug] [Thread-3 (]: Finished running node model.bain_capital_analytics.stg_cashflows
[0m00:19:10.353930 [debug] [Thread-3 (]: Began running node model.bain_capital_analytics.stg_fund_structures
[0m00:19:10.354324 [info ] [Thread-3 (]: 5 of 28 START sql view model DEV.stg_fund_structures ........................... [RUN]
[0m00:19:10.354674 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_cashflows, now model.bain_capital_analytics.stg_fund_structures)
[0m00:19:10.354931 [debug] [Thread-3 (]: Began compiling node model.bain_capital_analytics.stg_fund_structures
[0m00:19:10.357162 [debug] [Thread-3 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_fund_structures"
[0m00:19:10.357719 [debug] [Thread-3 (]: Began executing node model.bain_capital_analytics.stg_fund_structures
[0m00:19:10.359907 [debug] [Thread-3 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_fund_structures"
[0m00:19:10.360912 [debug] [Thread-3 (]: Using snowflake connection "model.bain_capital_analytics.stg_fund_structures"
[0m00:19:10.361196 [debug] [Thread-3 (]: On model.bain_capital_analytics.stg_fund_structures: create or replace   view DBT_DEMO.DEV.stg_fund_structures
  
  
  
  
  as (
    select distinct
    fund_id,
    fund_name,
    fund_type,
    cast(vintage_year as integer) as vintage_year,
    cast(committed_capital as numeric(18,2)) as committed_capital,
    cast(management_fee_rate as numeric(8,4)) as management_fee_rate,
    cast(carry_rate as numeric(8,4)) as carry_rate,
    cast(hurdle_rate as numeric(8,4)) as hurdle_rate,
    cast(gp_commitment_pct as numeric(8,4)) as gp_commitment_pct,
    fund_currency,
    fund_status
from DBT_DEMO.DEV_raw.raw_fund_structures
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_fund_structures"} */;
[0m00:19:10.640244 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m00:19:10.644447 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb2bd90>]}
[0m00:19:10.645266 [info ] [Thread-2 (]: 1 of 28 OK created sql view model DEV.stg_benchmarks ........................... [[32mSUCCESS 1[0m in 0.76s]
[0m00:19:10.645807 [debug] [Thread-2 (]: Finished running node model.bain_capital_analytics.stg_benchmarks
[0m00:19:10.646207 [debug] [Thread-2 (]: Began running node model.bain_capital_analytics.stg_instruments
[0m00:19:10.646774 [info ] [Thread-2 (]: 6 of 28 START sql view model DEV.stg_instruments ............................... [RUN]
[0m00:19:10.647272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_benchmarks, now model.bain_capital_analytics.stg_instruments)
[0m00:19:10.647629 [debug] [Thread-2 (]: Began compiling node model.bain_capital_analytics.stg_instruments
[0m00:19:10.654968 [debug] [Thread-2 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_instruments"
[0m00:19:10.655872 [debug] [Thread-2 (]: Began executing node model.bain_capital_analytics.stg_instruments
[0m00:19:10.658938 [debug] [Thread-2 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_instruments"
[0m00:19:10.660184 [debug] [Thread-2 (]: Using snowflake connection "model.bain_capital_analytics.stg_instruments"
[0m00:19:10.660541 [debug] [Thread-2 (]: On model.bain_capital_analytics.stg_instruments: create or replace   view DBT_DEMO.DEV.stg_instruments
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT
select distinct
    instrument_id,
    instrument_name,
    instrument_type,
    sector,
    currency,
    exchange,
    issuer,
    cast(maturity_date as date) as maturity_date,
    -- Anti-pattern: PostgreSQL-specific date subtraction
    case
        when maturity_date is not null
        then datediff(day, current_date, cast(maturity_date as date))
        else null
    end as days_to_maturity,
    case
        when instrument_type in ('equity', 'futures') then 'liquid'
        when instrument_type in ('corporate_bond', 'government_bond', 'sovereign_bond', 'leveraged_loan') then 'semi_liquid'
        when instrument_type in ('private_equity', 'venture_capital', 'real_estate', 'real_estate_debt', 'infrastructure') then 'illiquid'
        else 'other'
    end as liquidity_class
from DBT_DEMO.DEV_raw.raw_instruments
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_instruments"} */;
[0m00:19:10.770052 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m00:19:10.773201 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd00ad0>]}
[0m00:19:10.774016 [info ] [Thread-3 (]: 5 of 28 OK created sql view model DEV.stg_fund_structures ...................... [[32mSUCCESS 1[0m in 0.42s]
[0m00:19:10.774587 [debug] [Thread-3 (]: Finished running node model.bain_capital_analytics.stg_fund_structures
[0m00:19:10.774974 [debug] [Thread-3 (]: Began running node model.bain_capital_analytics.stg_portfolios
[0m00:19:10.775493 [info ] [Thread-3 (]: 7 of 28 START sql view model DEV.stg_portfolios ................................ [RUN]
[0m00:19:10.775924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_fund_structures, now model.bain_capital_analytics.stg_portfolios)
[0m00:19:10.776246 [debug] [Thread-3 (]: Began compiling node model.bain_capital_analytics.stg_portfolios
[0m00:19:10.779292 [debug] [Thread-3 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_portfolios"
[0m00:19:10.779910 [debug] [Thread-3 (]: Began executing node model.bain_capital_analytics.stg_portfolios
[0m00:19:10.782297 [debug] [Thread-3 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_portfolios"
[0m00:19:10.783487 [debug] [Thread-3 (]: Using snowflake connection "model.bain_capital_analytics.stg_portfolios"
[0m00:19:10.783766 [debug] [Thread-3 (]: On model.bain_capital_analytics.stg_portfolios: create or replace   view DBT_DEMO.DEV.stg_portfolios
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT when source data is already unique
-- Anti-pattern: casting in every model instead of once upstream

select distinct
    cast(portfolio_id as varchar(10)) as portfolio_id,
    cast(portfolio_name as varchar(100)) as portfolio_name,
    cast(strategy as varchar(50)) as strategy,
    cast(inception_date as date) as inception_date,
    cast(fund_id as varchar(10)) as fund_id,
    cast(manager_name as varchar(100)) as manager_name,
    cast(is_active as boolean) as is_active,
    -- Anti-pattern: duplicated fiscal quarter logic (repeated in many models)
    case
        when extract(month from cast(inception_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(inception_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(inception_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(inception_date as date)) between 10 and 12 then 'Q2'
    end as inception_fiscal_quarter
from DBT_DEMO.DEV_raw.raw_portfolios
where cast(is_active as boolean) = TRUE
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_portfolios"} */;
[0m00:19:10.947380 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m00:19:10.951229 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce5a10>]}
[0m00:19:10.952038 [info ] [Thread-2 (]: 6 of 28 OK created sql view model DEV.stg_instruments .......................... [[32mSUCCESS 1[0m in 0.30s]
[0m00:19:10.952528 [debug] [Thread-2 (]: Finished running node model.bain_capital_analytics.stg_instruments
[0m00:19:10.952929 [debug] [Thread-2 (]: Began running node model.bain_capital_analytics.stg_positions
[0m00:19:10.953471 [info ] [Thread-2 (]: 8 of 28 START sql view model DEV.stg_positions ................................. [RUN]
[0m00:19:10.953928 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_instruments, now model.bain_capital_analytics.stg_positions)
[0m00:19:10.954268 [debug] [Thread-2 (]: Began compiling node model.bain_capital_analytics.stg_positions
[0m00:19:10.958326 [debug] [Thread-2 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_positions"
[0m00:19:10.959064 [debug] [Thread-2 (]: Began executing node model.bain_capital_analytics.stg_positions
[0m00:19:10.962315 [debug] [Thread-2 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_positions"
[0m00:19:10.963601 [debug] [Thread-2 (]: Using snowflake connection "model.bain_capital_analytics.stg_positions"
[0m00:19:10.963936 [debug] [Thread-2 (]: On model.bain_capital_analytics.stg_positions: create or replace   view DBT_DEMO.DEV.stg_positions
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT
-- Anti-pattern: no filtering or partitioning strategy

select distinct
    position_id,
    portfolio_id,
    instrument_id,
    cast(position_date as date) as position_date,
    cast(quantity as numeric(18,4)) as quantity,
    cast(market_value as numeric(18,2)) as market_value,
    cast(cost_basis as numeric(18,2)) as cost_basis,
    currency,
    -- Anti-pattern: computed column that could be done downstream
    cast(market_value as numeric(18,2)) - cast(cost_basis as numeric(18,2)) as unrealized_gain_loss,
    case
        when cast(cost_basis as numeric(18,2)) != 0
        then (cast(market_value as numeric(18,2)) - cast(cost_basis as numeric(18,2))) / abs(cast(cost_basis as numeric(18,2)))
        else 0
    end as unrealized_return_pct
from DBT_DEMO.DEV_raw.raw_positions
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_positions"} */;
[0m00:19:11.047499 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.263 seconds
[0m00:19:11.050660 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cedae10>]}
[0m00:19:11.051490 [info ] [Thread-3 (]: 7 of 28 OK created sql view model DEV.stg_portfolios ........................... [[32mSUCCESS 1[0m in 0.27s]
[0m00:19:11.052045 [debug] [Thread-3 (]: Finished running node model.bain_capital_analytics.stg_portfolios
[0m00:19:11.052477 [debug] [Thread-3 (]: Began running node model.bain_capital_analytics.stg_trades
[0m00:19:11.053109 [info ] [Thread-3 (]: 9 of 28 START sql view model DEV.stg_trades .................................... [RUN]
[0m00:19:11.053695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_portfolios, now model.bain_capital_analytics.stg_trades)
[0m00:19:11.054013 [debug] [Thread-3 (]: Began compiling node model.bain_capital_analytics.stg_trades
[0m00:19:11.058285 [debug] [Thread-3 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_trades"
[0m00:19:11.059129 [debug] [Thread-3 (]: Began executing node model.bain_capital_analytics.stg_trades
[0m00:19:11.062140 [debug] [Thread-3 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_trades"
[0m00:19:11.063736 [debug] [Thread-3 (]: Using snowflake connection "model.bain_capital_analytics.stg_trades"
[0m00:19:11.064059 [debug] [Thread-3 (]: On model.bain_capital_analytics.stg_trades: create or replace   view DBT_DEMO.DEV.stg_trades
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT on already-unique trade_id
-- Anti-pattern: heavy casting repeated everywhere

select distinct
    trade_id,
    portfolio_id,
    instrument_id,
    counterparty_id,
    cast(trade_date as date) as trade_date,
    cast(settlement_date as date) as settlement_date,
    trade_type,
    cast(quantity as numeric(18,4)) as quantity,
    cast(price as numeric(18,6)) as price,
    cast(notional_amount as numeric(18,2)) as notional_amount,
    cast(commission as numeric(18,2)) as commission,
    currency,
    status,
    -- Anti-pattern: duplicated fiscal quarter logic
    case
        when extract(month from cast(trade_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(trade_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(trade_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(trade_date as date)) between 10 and 12 then 'Q2'
    end as trade_fiscal_quarter,
    -- Anti-pattern: PostgreSQL-specific date arithmetic
    datediff(day, cast(trade_date as date), cast(settlement_date as date)) as settlement_days
from DBT_DEMO.DEV_raw.raw_trades
where status = 'settled'
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_trades"} */;
[0m00:19:11.417000 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m00:19:11.420261 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d10cd90>]}
[0m00:19:11.427250 [info ] [Thread-2 (]: 8 of 28 OK created sql view model DEV.stg_positions ............................ [[32mSUCCESS 1[0m in 0.47s]
[0m00:19:11.428571 [debug] [Thread-2 (]: Finished running node model.bain_capital_analytics.stg_positions
[0m00:19:11.429297 [debug] [Thread-2 (]: Began running node model.bain_capital_analytics.stg_valuations
[0m00:19:11.429929 [info ] [Thread-2 (]: 10 of 28 START sql view model DEV.stg_valuations ............................... [RUN]
[0m00:19:11.430396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_positions, now model.bain_capital_analytics.stg_valuations)
[0m00:19:11.430768 [debug] [Thread-2 (]: Began compiling node model.bain_capital_analytics.stg_valuations
[0m00:19:11.433742 [debug] [Thread-2 (]: Writing injected SQL for node "model.bain_capital_analytics.stg_valuations"
[0m00:19:11.434380 [debug] [Thread-2 (]: Began executing node model.bain_capital_analytics.stg_valuations
[0m00:19:11.436828 [debug] [Thread-2 (]: Writing runtime sql for node "model.bain_capital_analytics.stg_valuations"
[0m00:19:11.438047 [debug] [Thread-2 (]: Using snowflake connection "model.bain_capital_analytics.stg_valuations"
[0m00:19:11.438340 [debug] [Thread-2 (]: On model.bain_capital_analytics.stg_valuations: create or replace   view DBT_DEMO.DEV.stg_valuations
  
  
  
  
  as (
    -- Anti-pattern: unnecessary DISTINCT
select distinct
    valuation_id,
    portfolio_id,
    cast(valuation_date as date) as valuation_date,
    cast(gross_asset_value as numeric(18,2)) as gross_asset_value,
    cast(net_asset_value as numeric(18,2)) as net_asset_value,
    cast(total_liabilities as numeric(18,2)) as total_liabilities,
    cast(unrealized_pnl as numeric(18,2)) as unrealized_pnl,
    cast(realized_pnl as numeric(18,2)) as realized_pnl,
    valuation_method,
    -- Anti-pattern: duplicated fiscal quarter logic
    case
        when extract(month from cast(valuation_date as date)) between 1 and 3 then 'Q3'
        when extract(month from cast(valuation_date as date)) between 4 and 6 then 'Q4'
        when extract(month from cast(valuation_date as date)) between 7 and 9 then 'Q1'
        when extract(month from cast(valuation_date as date)) between 10 and 12 then 'Q2'
    end as valuation_fiscal_quarter
from DBT_DEMO.DEV_raw.raw_valuations
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.stg_valuations"} */;
[0m00:19:11.591027 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m00:19:11.594204 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e323d50>]}
[0m00:19:11.594977 [info ] [Thread-3 (]: 9 of 28 OK created sql view model DEV.stg_trades ............................... [[32mSUCCESS 1[0m in 0.54s]
[0m00:19:11.595523 [debug] [Thread-3 (]: Finished running node model.bain_capital_analytics.stg_trades
[0m00:19:11.595929 [debug] [Thread-3 (]: Began running node model.bain_capital_analytics.int_cashflow_enriched
[0m00:19:11.596512 [info ] [Thread-3 (]: 11 of 28 START sql view model DEV.int_cashflow_enriched ........................ [RUN]
[0m00:19:11.596981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_trades, now model.bain_capital_analytics.int_cashflow_enriched)
[0m00:19:11.597330 [debug] [Thread-3 (]: Began compiling node model.bain_capital_analytics.int_cashflow_enriched
[0m00:19:11.602477 [debug] [Thread-3 (]: Writing injected SQL for node "model.bain_capital_analytics.int_cashflow_enriched"
[0m00:19:11.603538 [debug] [Thread-3 (]: Began executing node model.bain_capital_analytics.int_cashflow_enriched
[0m00:19:11.606784 [debug] [Thread-3 (]: Writing runtime sql for node "model.bain_capital_analytics.int_cashflow_enriched"
[0m00:19:11.609578 [debug] [Thread-3 (]: Using snowflake connection "model.bain_capital_analytics.int_cashflow_enriched"
[0m00:19:11.609993 [debug] [Thread-3 (]: On model.bain_capital_analytics.int_cashflow_enriched: create or replace   view DBT_DEMO.DEV.int_cashflow_enriched
  
  
  
  
  as (
    -- Pipeline C: Enriched cashflow data with fund and portfolio details
-- Anti-pattern: subquery for dedup instead of QUALIFY
-- Anti-pattern: joins repeated from other intermediate models

with cashflow_with_details as (
    select *
    from (
        select
            cf.*,
            p.portfolio_name,
            p.strategy,
            p.manager_name,
            fs.fund_name,
            fs.fund_type,
            fs.committed_capital,
            fs.management_fee_rate,
            fs.carry_rate,
            fs.hurdle_rate,
            -- Anti-pattern: subquery filter instead of QUALIFY
            row_number() over (
                partition by cf.cashflow_id
                order by cf.cashflow_date desc
            ) as rn
        from DBT_DEMO.DEV.stg_cashflows cf
        inner join DBT_DEMO.DEV.stg_portfolios p
            on cf.portfolio_id = p.portfolio_id
        inner join DBT_DEMO.DEV.stg_fund_structures fs
            on cf.fund_id = fs.fund_id
    ) sub
    where rn = 1
),

-- Anti-pattern: running totals computed here AND again downstream
cashflow_cumulative as (
    select
        *,
        sum(case when cashflow_type = 'capital_call' then amount else 0 end) over (
            partition by fund_id, portfolio_id
            order by cashflow_date
            rows between unbounded preceding and current row
        ) as cumulative_called,
        sum(case when cashflow_type = 'distribution' then amount else 0 end) over (
            partition by fund_id, portfolio_id
            order by cashflow_date
            rows between unbounded preceding and current row
        ) as cumulative_distributed,
        sum(amount) over (
            partition by fund_id, portfolio_id
            order by cashflow_date
            rows between unbounded preceding and current row
        ) as cumulative_net_cashflow
    from cashflow_with_details
)

select
    cashflow_id,
    fund_id,
    fund_name,
    fund_type,
    portfolio_id,
    portfolio_name,
    strategy,
    manager_name,
    cashflow_date,
    cashflow_type,
    amount,
    currency,
    description,
    investor_id,
    cashflow_fiscal_quarter,
    cashflow_year,
    committed_capital,
    management_fee_rate,
    carry_rate,
    hurdle_rate,
    cumulative_called,
    cumulative_distributed,
    cumulative_net_cashflow,
    case
        when committed_capital > 0
        then cumulative_called / committed_capital
        else 0
    end as pct_called
from cashflow_cumulative
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_cashflow_enriched"} */;
[0m00:19:11.756275 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.783 seconds
[0m00:19:11.759970 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb136d0>]}
[0m00:19:11.760866 [info ] [Thread-5 (]: 4 of 28 OK created sql view model DEV.stg_dates ................................ [[32mSUCCESS 1[0m in 1.88s]
[0m00:19:11.761421 [debug] [Thread-5 (]: Finished running node model.bain_capital_analytics.stg_dates
[0m00:19:11.761840 [debug] [Thread-5 (]: Began running node model.bain_capital_analytics.fact_portfolio_summary
[0m00:19:11.762543 [info ] [Thread-5 (]: 12 of 28 START sql view model DEV.fact_portfolio_summary ....................... [RUN]
[0m00:19:11.763016 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_dates, now model.bain_capital_analytics.fact_portfolio_summary)
[0m00:19:11.763426 [debug] [Thread-5 (]: Began compiling node model.bain_capital_analytics.fact_portfolio_summary
[0m00:19:11.768068 [debug] [Thread-5 (]: Writing injected SQL for node "model.bain_capital_analytics.fact_portfolio_summary"
[0m00:19:11.769022 [debug] [Thread-5 (]: Began executing node model.bain_capital_analytics.fact_portfolio_summary
[0m00:19:11.771973 [debug] [Thread-5 (]: Writing runtime sql for node "model.bain_capital_analytics.fact_portfolio_summary"
[0m00:19:11.773805 [debug] [Thread-5 (]: Using snowflake connection "model.bain_capital_analytics.fact_portfolio_summary"
[0m00:19:11.774140 [debug] [Thread-5 (]: On model.bain_capital_analytics.fact_portfolio_summary: create or replace   view DBT_DEMO.DEV.fact_portfolio_summary
  
  
  
  
  as (
    -- Pipeline A: FACT table - Portfolio summary with positions
-- Anti-pattern: unnecessary DISTINCT on already-unique aggregation
-- Anti-pattern: late filtering (filters at the end instead of upstream)
-- Anti-pattern: materialized as view (should be table)

select distinct
    p.portfolio_id,
    p.portfolio_name,
    p.strategy,
    p.fund_id,
    p.manager_name,
    pos.position_date,
    count(distinct pos.instrument_id) as num_positions,
    sum(pos.market_value) as total_market_value,
    sum(pos.cost_basis) as total_cost_basis,
    sum(pos.unrealized_gain_loss) as total_unrealized_pnl,
    case
        when sum(pos.cost_basis) != 0
        then sum(pos.unrealized_gain_loss) / abs(sum(pos.cost_basis))
        else 0
    end as portfolio_return_pct,
    max(pos.market_value) as largest_position_mv,
    min(pos.market_value) as smallest_position_mv
from DBT_DEMO.DEV.stg_portfolios p
inner join DBT_DEMO.DEV.stg_positions pos
    on p.portfolio_id = pos.portfolio_id
-- Anti-pattern: filter at the end instead of in staging
where p.is_active = TRUE
group by
    p.portfolio_id,
    p.portfolio_name,
    p.strategy,
    p.fund_id,
    p.manager_name,
    pos.position_date
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_portfolio_summary"} */;
[0m00:19:11.843740 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m00:19:11.846769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3c4d10>]}
[0m00:19:11.847584 [info ] [Thread-2 (]: 10 of 28 OK created sql view model DEV.stg_valuations .......................... [[32mSUCCESS 1[0m in 0.42s]
[0m00:19:11.848129 [debug] [Thread-2 (]: Finished running node model.bain_capital_analytics.stg_valuations
[0m00:19:11.848538 [debug] [Thread-2 (]: Began running node model.bain_capital_analytics.int_portfolio_attribution
[0m00:19:11.849275 [info ] [Thread-2 (]: 13 of 28 START sql view model DEV.int_portfolio_attribution .................... [RUN]
[0m00:19:11.849785 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_valuations, now model.bain_capital_analytics.int_portfolio_attribution)
[0m00:19:11.850166 [debug] [Thread-2 (]: Began compiling node model.bain_capital_analytics.int_portfolio_attribution
[0m00:19:11.855200 [debug] [Thread-2 (]: Writing injected SQL for node "model.bain_capital_analytics.int_portfolio_attribution"
[0m00:19:11.856239 [debug] [Thread-2 (]: Began executing node model.bain_capital_analytics.int_portfolio_attribution
[0m00:19:11.862166 [debug] [Thread-2 (]: Writing runtime sql for node "model.bain_capital_analytics.int_portfolio_attribution"
[0m00:19:11.864597 [debug] [Thread-2 (]: Using snowflake connection "model.bain_capital_analytics.int_portfolio_attribution"
[0m00:19:11.864999 [debug] [Thread-2 (]: On model.bain_capital_analytics.int_portfolio_attribution: create or replace   view DBT_DEMO.DEV.int_portfolio_attribution
  
  
  
  
  as (
    -- Pipeline C: Portfolio performance attribution by sector and instrument type
-- Anti-pattern: deep CTE chain, repeated joins, late aggregation
-- Anti-pattern: same position-instrument-portfolio joins as int_daily_positions

with positions_enriched as (
    -- Anti-pattern: repeating the same 3-way join as int_daily_positions
    select
        pos.position_id,
        pos.portfolio_id,
        pos.instrument_id,
        pos.position_date,
        pos.quantity,
        pos.market_value,
        pos.cost_basis,
        pos.unrealized_gain_loss,
        i.instrument_name,
        i.instrument_type,
        i.sector,
        p.portfolio_name,
        p.strategy,
        p.fund_id
    from DBT_DEMO.DEV.stg_positions pos
    inner join DBT_DEMO.DEV.stg_instruments i
        on pos.instrument_id = i.instrument_id
    inner join DBT_DEMO.DEV.stg_portfolios p
        on pos.portfolio_id = p.portfolio_id
),

-- Anti-pattern: compute portfolio totals in a separate CTE instead of a single pass
portfolio_totals as (
    select
        portfolio_id,
        position_date,
        sum(market_value) as total_portfolio_mv,
        sum(unrealized_gain_loss) as total_portfolio_ugl
    from positions_enriched
    group by portfolio_id, position_date
),

-- Anti-pattern: sector aggregation in yet another CTE
sector_attribution as (
    select
        pe.portfolio_id,
        pe.portfolio_name,
        pe.strategy,
        pe.fund_id,
        pe.position_date,
        pe.sector,
        sum(pe.market_value) as sector_mv,
        sum(pe.unrealized_gain_loss) as sector_ugl,
        count(distinct pe.instrument_id) as num_instruments
    from positions_enriched pe
    group by
        pe.portfolio_id, pe.portfolio_name, pe.strategy,
        pe.fund_id, pe.position_date, pe.sector
),

-- Anti-pattern: joining back to get weights instead of computing in one pass
attribution_with_weights as (
    select
        sa.*,
        pt.total_portfolio_mv,
        pt.total_portfolio_ugl,
        case
            when pt.total_portfolio_mv != 0
            then sa.sector_mv / pt.total_portfolio_mv
            else 0
        end as sector_weight,
        case
            when pt.total_portfolio_ugl != 0
            then sa.sector_ugl / pt.total_portfolio_ugl
            else 0
        end as sector_contribution
    from sector_attribution sa
    inner join portfolio_totals pt
        on sa.portfolio_id = pt.portfolio_id
        and sa.position_date = pt.position_date
)

select * from attribution_with_weights
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_portfolio_attribution"} */;
[0m00:19:12.023921 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.048 seconds
[0m00:19:12.027277 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e00ec50>]}
[0m00:19:12.028128 [info ] [Thread-4 (]: 3 of 28 OK created sql view model DEV.stg_counterparties ....................... [[32mSUCCESS 1[0m in 2.14s]
[0m00:19:12.028667 [debug] [Thread-4 (]: Finished running node model.bain_capital_analytics.stg_counterparties
[0m00:19:12.029072 [debug] [Thread-4 (]: Began running node model.bain_capital_analytics.int_benchmark_returns
[0m00:19:12.029722 [info ] [Thread-4 (]: 14 of 28 START sql view model DEV.int_benchmark_returns ........................ [RUN]
[0m00:19:12.030183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.stg_counterparties, now model.bain_capital_analytics.int_benchmark_returns)
[0m00:19:12.030542 [debug] [Thread-4 (]: Began compiling node model.bain_capital_analytics.int_benchmark_returns
[0m00:19:12.035581 [debug] [Thread-4 (]: Writing injected SQL for node "model.bain_capital_analytics.int_benchmark_returns"
[0m00:19:12.036495 [debug] [Thread-4 (]: Began executing node model.bain_capital_analytics.int_benchmark_returns
[0m00:19:12.039774 [debug] [Thread-4 (]: Writing runtime sql for node "model.bain_capital_analytics.int_benchmark_returns"
[0m00:19:12.042314 [debug] [Thread-4 (]: Using snowflake connection "model.bain_capital_analytics.int_benchmark_returns"
[0m00:19:12.042769 [debug] [Thread-4 (]: On model.bain_capital_analytics.int_benchmark_returns: create or replace   view DBT_DEMO.DEV.int_benchmark_returns
  
  
  
  
  as (
    -- Pipeline C: Benchmark returns with rolling calculations
-- Anti-pattern: heavy window functions that could be pre-computed

with benchmark_base as (
    select
        b.benchmark_id,
        b.benchmark_name,
        b.benchmark_date,
        b.return_daily,
        b.return_mtd,
        b.return_ytd,
        b.benchmark_level,
        b.benchmark_fiscal_quarter,
        d.fiscal_year,
        d.is_quarter_end,
        d.is_year_end
    from DBT_DEMO.DEV.stg_benchmarks b
    inner join DBT_DEMO.DEV.stg_dates d
        on b.benchmark_date = d.date_day
),

-- Anti-pattern: compute many overlapping windows
benchmark_with_rolling as (
    select
        bb.*,
        -- rolling 3-month return
        exp(sum(ln(1 + bb.return_mtd)) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 2 preceding and current row
        )) - 1 as rolling_3m_return,
        -- rolling 6-month return
        exp(sum(ln(1 + bb.return_mtd)) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 5 preceding and current row
        )) - 1 as rolling_6m_return,
        -- rolling 12-month return
        exp(sum(ln(1 + bb.return_mtd)) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 11 preceding and current row
        )) - 1 as rolling_12m_return,
        -- Anti-pattern: volatility via window (expensive)
        stddev(bb.return_mtd) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 11 preceding and current row
        ) as rolling_12m_volatility,
        avg(bb.return_mtd) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
            rows between 11 preceding and current row
        ) as rolling_12m_avg_return,
        lag(bb.benchmark_level) over (
            partition by bb.benchmark_id
            order by bb.benchmark_date
        ) as prev_benchmark_level
    from benchmark_base bb
)

select * from benchmark_with_rolling
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_benchmark_returns"} */;
[0m00:19:12.113164 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.339 seconds
[0m00:19:12.116289 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc65f90>]}
[0m00:19:12.117134 [info ] [Thread-5 (]: 12 of 28 OK created sql view model DEV.fact_portfolio_summary .................. [[32mSUCCESS 1[0m in 0.35s]
[0m00:19:12.117672 [debug] [Thread-5 (]: Finished running node model.bain_capital_analytics.fact_portfolio_summary
[0m00:19:12.118086 [debug] [Thread-5 (]: Began running node model.bain_capital_analytics.int_daily_positions
[0m00:19:12.118724 [info ] [Thread-5 (]: 15 of 28 START sql view model DEV.int_daily_positions .......................... [RUN]
[0m00:19:12.119186 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.fact_portfolio_summary, now model.bain_capital_analytics.int_daily_positions)
[0m00:19:12.119530 [debug] [Thread-5 (]: Began compiling node model.bain_capital_analytics.int_daily_positions
[0m00:19:12.124705 [debug] [Thread-5 (]: Writing injected SQL for node "model.bain_capital_analytics.int_daily_positions"
[0m00:19:12.125626 [debug] [Thread-5 (]: Began executing node model.bain_capital_analytics.int_daily_positions
[0m00:19:12.128979 [debug] [Thread-5 (]: Writing runtime sql for node "model.bain_capital_analytics.int_daily_positions"
[0m00:19:12.131467 [debug] [Thread-5 (]: Using snowflake connection "model.bain_capital_analytics.int_daily_positions"
[0m00:19:12.131905 [debug] [Thread-5 (]: On model.bain_capital_analytics.int_daily_positions: create or replace   view DBT_DEMO.DEV.int_daily_positions
  
  
  
  
  as (
    -- Pipeline B: Daily position snapshots with PnL calculations
-- Anti-pattern: deep CTE nesting
-- Anti-pattern: repeated joins to same dimension tables

with position_base as (
    select
        pos.position_id,
        pos.portfolio_id,
        pos.instrument_id,
        pos.position_date,
        pos.quantity,
        pos.market_value,
        pos.cost_basis,
        pos.unrealized_gain_loss,
        pos.unrealized_return_pct,
        pos.currency
    from DBT_DEMO.DEV.stg_positions pos
),

-- Anti-pattern: CTE level 2 - join instruments (same join as int_trade_enriched)
position_with_instruments as (
    select
        pb.*,
        i.instrument_name,
        i.instrument_type,
        i.sector,
        i.liquidity_class
    from position_base pb
    inner join DBT_DEMO.DEV.stg_instruments i
        on pb.instrument_id = i.instrument_id
),

-- Anti-pattern: CTE level 3 - join portfolios (same join as int_trade_enriched)
position_with_portfolio as (
    select
        pwi.*,
        p.portfolio_name,
        p.strategy,
        p.fund_id
    from position_with_instruments pwi
    inner join DBT_DEMO.DEV.stg_portfolios p
        on pwi.portfolio_id = p.portfolio_id
),

-- Anti-pattern: CTE level 4 - join dates
position_with_dates as (
    select
        pwp.*,
        d.is_business_day,
        d.is_month_end,
        d.is_quarter_end,
        d.fiscal_quarter,
        d.fiscal_year
    from position_with_portfolio pwp
    inner join DBT_DEMO.DEV.stg_dates d
        on pwp.position_date = d.date_day
),

-- Anti-pattern: CTE level 5 - compute window functions
position_with_analytics as (
    select
        pwd.*,
        -- Anti-pattern: multiple window functions on same partition
        lag(pwd.market_value) over (
            partition by pwd.portfolio_id, pwd.instrument_id
            order by pwd.position_date
        ) as prev_market_value,
        pwd.market_value - coalesce(
            lag(pwd.market_value) over (
                partition by pwd.portfolio_id, pwd.instrument_id
                order by pwd.position_date
            ), pwd.cost_basis
        ) as daily_pnl,
        sum(pwd.market_value) over (
            partition by pwd.portfolio_id, pwd.position_date
        ) as portfolio_total_mv,
        case
            when sum(pwd.market_value) over (partition by pwd.portfolio_id, pwd.position_date) != 0
            then pwd.market_value / sum(pwd.market_value) over (partition by pwd.portfolio_id, pwd.position_date)
            else 0
        end as weight_in_portfolio
    from position_with_dates pwd
)

select * from position_with_analytics
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_daily_positions"} */;
[0m00:19:12.133205 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m00:19:12.134702 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e322510>]}
[0m00:19:12.135361 [info ] [Thread-3 (]: 11 of 28 OK created sql view model DEV.int_cashflow_enriched ................... [[32mSUCCESS 1[0m in 0.54s]
[0m00:19:12.136015 [debug] [Thread-3 (]: Finished running node model.bain_capital_analytics.int_cashflow_enriched
[0m00:19:12.136368 [debug] [Thread-3 (]: Began running node model.bain_capital_analytics.int_fund_nav
[0m00:19:12.136759 [info ] [Thread-3 (]: 16 of 28 START sql view model DEV.int_fund_nav ................................. [RUN]
[0m00:19:12.137285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_cashflow_enriched, now model.bain_capital_analytics.int_fund_nav)
[0m00:19:12.137610 [debug] [Thread-3 (]: Began compiling node model.bain_capital_analytics.int_fund_nav
[0m00:19:12.140474 [debug] [Thread-3 (]: Writing injected SQL for node "model.bain_capital_analytics.int_fund_nav"
[0m00:19:12.140948 [debug] [Thread-3 (]: Began executing node model.bain_capital_analytics.int_fund_nav
[0m00:19:12.142996 [debug] [Thread-3 (]: Writing runtime sql for node "model.bain_capital_analytics.int_fund_nav"
[0m00:19:12.144912 [debug] [Thread-3 (]: Using snowflake connection "model.bain_capital_analytics.int_fund_nav"
[0m00:19:12.145252 [debug] [Thread-3 (]: On model.bain_capital_analytics.int_fund_nav: create or replace   view DBT_DEMO.DEV.int_fund_nav
  
  
  
  
  as (
    -- Pipeline C: Fund-level NAV calculation from portfolio valuations
-- Anti-pattern: late aggregation - joins everything then aggregates at the end
-- Anti-pattern: repeated joins to fund_structures and portfolios

with portfolio_valuations as (
    select
        v.portfolio_id,
        v.valuation_date,
        v.net_asset_value,
        v.gross_asset_value,
        v.total_liabilities,
        v.unrealized_pnl,
        v.realized_pnl,
        v.valuation_method,
        p.fund_id,
        p.portfolio_name,
        p.strategy,
        -- Anti-pattern: joining fund_structures again (already done in int_cashflow_enriched)
        fs.fund_name,
        fs.fund_type,
        fs.committed_capital,
        fs.management_fee_rate
    from DBT_DEMO.DEV.stg_valuations v
    inner join DBT_DEMO.DEV.stg_portfolios p
        on v.portfolio_id = p.portfolio_id
    inner join DBT_DEMO.DEV.stg_fund_structures fs
        on p.fund_id = fs.fund_id
),

-- Anti-pattern: aggregation happens here at the end after all joins
fund_level_nav as (
    select
        fund_id,
        fund_name,
        fund_type,
        committed_capital,
        management_fee_rate,
        valuation_date,
        sum(net_asset_value) as fund_nav,
        sum(gross_asset_value) as fund_gav,
        sum(total_liabilities) as fund_total_liabilities,
        sum(unrealized_pnl) as fund_unrealized_pnl,
        sum(realized_pnl) as fund_realized_pnl,
        count(distinct portfolio_id) as num_portfolios
    from portfolio_valuations
    group by
        fund_id, fund_name, fund_type, committed_capital,
        management_fee_rate, valuation_date
),

fund_nav_with_changes as (
    select
        fn.*,
        lag(fn.fund_nav) over (
            partition by fn.fund_id order by fn.valuation_date
        ) as prev_fund_nav,
        case
            when lag(fn.fund_nav) over (
                partition by fn.fund_id order by fn.valuation_date
            ) is not null
            and lag(fn.fund_nav) over (
                partition by fn.fund_id order by fn.valuation_date
            ) != 0
            then (fn.fund_nav - lag(fn.fund_nav) over (
                partition by fn.fund_id order by fn.valuation_date
            )) / lag(fn.fund_nav) over (
                partition by fn.fund_id order by fn.valuation_date
            )
            else null
        end as fund_nav_return,
        fn.fund_nav / nullif(fn.committed_capital, 0) as tvpi_gross
    from fund_level_nav fn
)

select * from fund_nav_with_changes
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_fund_nav"} */;
[0m00:19:12.442884 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m00:19:12.447719 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb843d0>]}
[0m00:19:12.448498 [info ] [Thread-2 (]: 13 of 28 OK created sql view model DEV.int_portfolio_attribution ............... [[32mSUCCESS 1[0m in 0.60s]
[0m00:19:12.448941 [debug] [Thread-2 (]: Finished running node model.bain_capital_analytics.int_portfolio_attribution
[0m00:19:12.449299 [debug] [Thread-2 (]: Began running node model.bain_capital_analytics.int_irr_calculations
[0m00:19:12.450095 [info ] [Thread-2 (]: 17 of 28 START sql view model DEV.int_irr_calculations ......................... [RUN]
[0m00:19:12.450555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_portfolio_attribution, now model.bain_capital_analytics.int_irr_calculations)
[0m00:19:12.450940 [debug] [Thread-2 (]: Began compiling node model.bain_capital_analytics.int_irr_calculations
[0m00:19:12.454497 [debug] [Thread-2 (]: Writing injected SQL for node "model.bain_capital_analytics.int_irr_calculations"
[0m00:19:12.455125 [debug] [Thread-2 (]: Began executing node model.bain_capital_analytics.int_irr_calculations
[0m00:19:12.459131 [debug] [Thread-2 (]: Writing runtime sql for node "model.bain_capital_analytics.int_irr_calculations"
[0m00:19:12.461947 [debug] [Thread-2 (]: Using snowflake connection "model.bain_capital_analytics.int_irr_calculations"
[0m00:19:12.462379 [debug] [Thread-2 (]: On model.bain_capital_analytics.int_irr_calculations: create or replace   view DBT_DEMO.DEV.int_irr_calculations
  
  
  
  
  as (
    -- Pipeline C: Approximate IRR calculation per fund/portfolio
-- Anti-pattern: extremely deep CTE nesting (6 levels)
-- Anti-pattern: PostgreSQL-specific date arithmetic
-- Anti-pattern: complex logic that should be a macro

with cashflow_series as (
    -- CTE level 1: get all cashflows with proper signs
    select
        cf.fund_id,
        cf.portfolio_id,
        cf.cashflow_date,
        cf.cashflow_type,
        case
            when cf.cashflow_type = 'capital_call' then -1 * abs(cf.amount)
            when cf.cashflow_type = 'distribution' then abs(cf.amount)
            when cf.cashflow_type = 'management_fee' then -1 * abs(cf.amount)
            else cf.amount
        end as signed_amount
    from DBT_DEMO.DEV.stg_cashflows cf
),

terminal_values as (
    -- CTE level 2: get latest NAV as terminal cashflow
    select
        v.portfolio_id,
        p.fund_id,
        v.valuation_date as cashflow_date,
        'terminal_value' as cashflow_type,
        v.net_asset_value as signed_amount
    from DBT_DEMO.DEV.stg_valuations v
    inner join DBT_DEMO.DEV.stg_portfolios p
        on v.portfolio_id = p.portfolio_id
    where v.valuation_date = (
        -- Anti-pattern: correlated subquery instead of window function
        select max(v2.valuation_date)
        from DBT_DEMO.DEV.stg_valuations v2
        where v2.portfolio_id = v.portfolio_id
    )
),

all_cashflows as (
    -- CTE level 3: union cashflows and terminal values
    select fund_id, portfolio_id, cashflow_date, cashflow_type, signed_amount
    from cashflow_series
    union all
    select fund_id, portfolio_id, cashflow_date, cashflow_type, signed_amount
    from terminal_values
),

cashflow_with_timing as (
    -- CTE level 4: compute time fractions
    -- Anti-pattern: PostgreSQL date subtraction
    select
        ac.*,
        min(ac.cashflow_date) over (partition by ac.fund_id, ac.portfolio_id) as first_cf_date,
        (DATEDIFF(day, min(ac.cashflow_date) over (partition by ac.fund_id, ac.portfolio_id), ac.cashflow_date)::NUMBER) / 365.25 as year_fraction
    from all_cashflows ac
),

-- CTE level 5: compute simple multiples as IRR proxy
portfolio_multiples as (
    select
        fund_id,
        portfolio_id,
        min(cashflow_date) as first_cashflow_date,
        max(cashflow_date) as last_cashflow_date,
        -- Anti-pattern: PostgreSQL date subtraction
        DATEDIFF(day, min(cashflow_date), max(cashflow_date)) as investment_days,
        (DATEDIFF(day, min(cashflow_date), max(cashflow_date))::NUMBER) / 365.25 as investment_years,
        sum(case when cashflow_type = 'capital_call' then abs(signed_amount) else 0 end) as total_invested,
        sum(case when cashflow_type = 'distribution' then signed_amount else 0 end) as total_distributed,
        sum(case when cashflow_type = 'terminal_value' then signed_amount else 0 end) as terminal_value,
        sum(signed_amount) as net_cashflow
    from cashflow_with_timing
    group by fund_id, portfolio_id
),

-- CTE level 6: compute IRR approximation
irr_approximation as (
    select
        pm.*,
        case
            when pm.total_invested > 0
            then (pm.total_distributed + pm.terminal_value) / pm.total_invested
            else null
        end as tvpi,
        case
            when pm.total_invested > 0
            then pm.total_distributed / pm.total_invested
            else null
        end as dpi,
        case
            when pm.total_invested > 0
            then pm.terminal_value / pm.total_invested
            else null
        end as rvpi,
        -- Simplified IRR approximation: (TVPI^(1/years)) - 1
        case
            when pm.total_invested > 0 and pm.investment_years > 0
            then power(
                (pm.total_distributed + pm.terminal_value) / pm.total_invested,
                1.0 / pm.investment_years
            ) - 1
            else null
        end as approx_irr
    from portfolio_multiples pm
)

select * from irr_approximation
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_irr_calculations"} */;
[0m00:19:12.465560 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m00:19:12.467046 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb69450>]}
[0m00:19:12.467490 [info ] [Thread-4 (]: 14 of 28 OK created sql view model DEV.int_benchmark_returns ................... [[32mSUCCESS 1[0m in 0.44s]
[0m00:19:12.467850 [debug] [Thread-4 (]: Finished running node model.bain_capital_analytics.int_benchmark_returns
[0m00:19:12.468115 [debug] [Thread-4 (]: Began running node model.bain_capital_analytics.int_valuation_enriched
[0m00:19:12.468409 [info ] [Thread-4 (]: 18 of 28 START sql view model DEV.int_valuation_enriched ....................... [RUN]
[0m00:19:12.468694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_benchmark_returns, now model.bain_capital_analytics.int_valuation_enriched)
[0m00:19:12.469015 [debug] [Thread-4 (]: Began compiling node model.bain_capital_analytics.int_valuation_enriched
[0m00:19:12.471750 [debug] [Thread-4 (]: Writing injected SQL for node "model.bain_capital_analytics.int_valuation_enriched"
[0m00:19:12.472318 [debug] [Thread-4 (]: Began executing node model.bain_capital_analytics.int_valuation_enriched
[0m00:19:12.474411 [debug] [Thread-4 (]: Writing runtime sql for node "model.bain_capital_analytics.int_valuation_enriched"
[0m00:19:12.476035 [debug] [Thread-4 (]: Using snowflake connection "model.bain_capital_analytics.int_valuation_enriched"
[0m00:19:12.476385 [debug] [Thread-4 (]: On model.bain_capital_analytics.int_valuation_enriched: create or replace   view DBT_DEMO.DEV.int_valuation_enriched
  
  
  
  
  as (
    -- Pipeline C: Enriched valuation data
-- Anti-pattern: subquery for dedup instead of QUALIFY
-- Anti-pattern: repeated portfolio join
-- Anti-pattern: PostgreSQL-specific date functions

with valuation_ranked as (
    select *
    from (
        select
            v.*,
            p.portfolio_name,
            p.strategy,
            p.fund_id,
            p.manager_name,
            -- Anti-pattern: subquery dedup instead of QUALIFY
            row_number() over (
                partition by v.portfolio_id, v.valuation_date
                order by v.valuation_id desc
            ) as rn
        from DBT_DEMO.DEV.stg_valuations v
        inner join DBT_DEMO.DEV.stg_portfolios p
            on v.portfolio_id = p.portfolio_id
    ) sub
    where rn = 1
),

valuation_with_changes as (
    select
        vr.*,
        lag(vr.net_asset_value) over (
            partition by vr.portfolio_id order by vr.valuation_date
        ) as prev_nav,
        case
            when lag(vr.net_asset_value) over (
                partition by vr.portfolio_id order by vr.valuation_date
            ) is not null
            and lag(vr.net_asset_value) over (
                partition by vr.portfolio_id order by vr.valuation_date
            ) != 0
            then (vr.net_asset_value - lag(vr.net_asset_value) over (
                partition by vr.portfolio_id order by vr.valuation_date
            )) / lag(vr.net_asset_value) over (
                partition by vr.portfolio_id order by vr.valuation_date
            )
            else null
        end as nav_return_pct,
        -- Anti-pattern: PostgreSQL date subtraction
        DATEDIFF(day, lag(vr.valuation_date) over (
            partition by vr.portfolio_id order by vr.valuation_date
        ), vr.valuation_date) as days_between_valuations
    from valuation_ranked vr
)

select * from valuation_with_changes
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_valuation_enriched"} */;
[0m00:19:12.641508 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.496 seconds
[0m00:19:12.645263 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce83510>]}
[0m00:19:12.646149 [info ] [Thread-3 (]: 16 of 28 OK created sql view model DEV.int_fund_nav ............................ [[32mSUCCESS 1[0m in 0.51s]
[0m00:19:12.646697 [debug] [Thread-3 (]: Finished running node model.bain_capital_analytics.int_fund_nav
[0m00:19:12.647105 [debug] [Thread-3 (]: Began running node model.bain_capital_analytics.fact_trade_activity
[0m00:19:12.647658 [info ] [Thread-3 (]: 19 of 28 START sql view model DEV.fact_trade_activity .......................... [RUN]
[0m00:19:12.648144 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_fund_nav, now model.bain_capital_analytics.fact_trade_activity)
[0m00:19:12.648513 [debug] [Thread-3 (]: Began compiling node model.bain_capital_analytics.fact_trade_activity
[0m00:19:12.654325 [debug] [Thread-3 (]: Writing injected SQL for node "model.bain_capital_analytics.fact_trade_activity"
[0m00:19:12.655204 [debug] [Thread-3 (]: Began executing node model.bain_capital_analytics.fact_trade_activity
[0m00:19:12.658327 [debug] [Thread-3 (]: Writing runtime sql for node "model.bain_capital_analytics.fact_trade_activity"
[0m00:19:12.660905 [debug] [Thread-3 (]: Using snowflake connection "model.bain_capital_analytics.fact_trade_activity"
[0m00:19:12.661455 [debug] [Thread-3 (]: On model.bain_capital_analytics.fact_trade_activity: create or replace   view DBT_DEMO.DEV.fact_trade_activity
  
  
  
  
  as (
    -- Pipeline B: FACT table - Trade activity detail
-- Anti-pattern: repeats the SAME 3-table join as fact_portfolio_pnl and int_trade_enriched
-- Anti-pattern: could use int_trade_enriched but re-does everything

select
    t.trade_id,
    t.portfolio_id,
    t.instrument_id,
    t.counterparty_id,
    t.trade_date,
    t.settlement_date,
    t.trade_type,
    t.quantity,
    t.price,
    t.notional_amount,
    t.commission,
    t.currency,
    t.settlement_days,
    -- Anti-pattern: re-joining instruments (done in int_trade_enriched)
    i.instrument_name,
    i.instrument_type,
    i.sector,
    i.liquidity_class,
    -- Anti-pattern: re-joining counterparties (done in int_trade_enriched)
    c.counterparty_name,
    c.counterparty_type,
    c.credit_rating,
    -- Anti-pattern: re-joining portfolios (done in int_trade_enriched)
    p.portfolio_name,
    p.strategy,
    p.fund_id,
    p.manager_name,
    -- Anti-pattern: re-joining dates
    d.fiscal_quarter,
    d.fiscal_year,
    d.is_month_end,
    -- Anti-pattern: duplicated fiscal quarter logic
    case
        when extract(month from t.trade_date) between 1 and 3 then 'Q3'
        when extract(month from t.trade_date) between 4 and 6 then 'Q4'
        when extract(month from t.trade_date) between 7 and 9 then 'Q1'
        when extract(month from t.trade_date) between 10 and 12 then 'Q2'
    end as computed_fiscal_quarter,
    -- Anti-pattern: window functions recomputed (already in int_trade_enriched)
    sum(t.notional_amount) over (
        partition by t.portfolio_id
        order by t.trade_date
        rows between unbounded preceding and current row
    ) as running_notional,
    count(*) over (
        partition by t.portfolio_id, date_trunc('month', t.trade_date)
    ) as monthly_trade_count,
    sum(t.commission) over (
        partition by t.portfolio_id, date_trunc('month', t.trade_date)
    ) as monthly_commissions
from DBT_DEMO.DEV.stg_trades t
inner join DBT_DEMO.DEV.stg_instruments i
    on t.instrument_id = i.instrument_id
inner join DBT_DEMO.DEV.stg_counterparties c
    on t.counterparty_id = c.counterparty_id
inner join DBT_DEMO.DEV.stg_portfolios p
    on t.portfolio_id = p.portfolio_id
inner join DBT_DEMO.DEV.stg_dates d
    on t.trade_date = d.date_day
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_trade_activity"} */;
[0m00:19:12.910685 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m00:19:12.914955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3cb490>]}
[0m00:19:12.915869 [info ] [Thread-2 (]: 17 of 28 OK created sql view model DEV.int_irr_calculations .................... [[32mSUCCESS 1[0m in 0.46s]
[0m00:19:12.916443 [debug] [Thread-2 (]: Finished running node model.bain_capital_analytics.int_irr_calculations
[0m00:19:12.916869 [debug] [Thread-2 (]: Began running node model.bain_capital_analytics.int_trade_enriched
[0m00:19:12.917461 [info ] [Thread-2 (]: 20 of 28 START sql view model DEV.int_trade_enriched ........................... [RUN]
[0m00:19:12.918084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_irr_calculations, now model.bain_capital_analytics.int_trade_enriched)
[0m00:19:12.918447 [debug] [Thread-2 (]: Began compiling node model.bain_capital_analytics.int_trade_enriched
[0m00:19:12.924227 [debug] [Thread-2 (]: Writing injected SQL for node "model.bain_capital_analytics.int_trade_enriched"
[0m00:19:12.925154 [debug] [Thread-2 (]: Began executing node model.bain_capital_analytics.int_trade_enriched
[0m00:19:12.928435 [debug] [Thread-2 (]: Writing runtime sql for node "model.bain_capital_analytics.int_trade_enriched"
[0m00:19:12.931077 [debug] [Thread-2 (]: Using snowflake connection "model.bain_capital_analytics.int_trade_enriched"
[0m00:19:12.931738 [debug] [Thread-2 (]: On model.bain_capital_analytics.int_trade_enriched: create or replace   view DBT_DEMO.DEV.int_trade_enriched
  
  
  
  
  as (
    -- Pipeline B: Enriched trade data with instrument and counterparty details
-- Anti-pattern: subquery for dedup instead of QUALIFY (Snowflake)
-- Anti-pattern: heavy join that will be repeated in multiple downstream models

with latest_trades as (
    -- Anti-pattern: subquery to filter row_number instead of QUALIFY
    select *
    from (
        select
            t.*,
            i.instrument_name,
            i.instrument_type,
            i.sector,
            i.liquidity_class,
            c.counterparty_name,
            c.counterparty_type,
            c.credit_rating,
            p.portfolio_name,
            p.strategy,
            p.manager_name,
            -- Anti-pattern: duplicated fiscal quarter logic AGAIN
            case
                when extract(month from t.trade_date) between 1 and 3 then 'Q3'
                when extract(month from t.trade_date) between 4 and 6 then 'Q4'
                when extract(month from t.trade_date) between 7 and 9 then 'Q1'
                when extract(month from t.trade_date) between 10 and 12 then 'Q2'
            end as fiscal_quarter,
            row_number() over (
                partition by t.portfolio_id, t.instrument_id, t.trade_date
                order by t.trade_id desc
            ) as rn
        from DBT_DEMO.DEV.stg_trades t
        -- Anti-pattern: these 3 joins are repeated in fact_portfolio_pnl and fact_trade_activity
        inner join DBT_DEMO.DEV.stg_instruments i
            on t.instrument_id = i.instrument_id
        inner join DBT_DEMO.DEV.stg_counterparties c
            on t.counterparty_id = c.counterparty_id
        inner join DBT_DEMO.DEV.stg_portfolios p
            on t.portfolio_id = p.portfolio_id
    ) sub
    where rn = 1
)

select
    trade_id,
    portfolio_id,
    portfolio_name,
    strategy,
    manager_name,
    instrument_id,
    instrument_name,
    instrument_type,
    sector,
    liquidity_class,
    counterparty_id,
    counterparty_name,
    counterparty_type,
    credit_rating,
    trade_date,
    settlement_date,
    trade_type,
    quantity,
    price,
    notional_amount,
    commission,
    currency,
    fiscal_quarter,
    settlement_days,
    -- Anti-pattern: running total computed here AND again in downstream models
    sum(notional_amount) over (
        partition by portfolio_id
        order by trade_date
        rows between unbounded preceding and current row
    ) as cumulative_notional
from latest_trades
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.int_trade_enriched"} */;
[0m00:19:12.978106 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m00:19:12.980953 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e395350>]}
[0m00:19:12.981634 [info ] [Thread-4 (]: 18 of 28 OK created sql view model DEV.int_valuation_enriched .................. [[32mSUCCESS 1[0m in 0.51s]
[0m00:19:12.982113 [debug] [Thread-4 (]: Finished running node model.bain_capital_analytics.int_valuation_enriched
[0m00:19:12.982492 [debug] [Thread-4 (]: Began running node model.bain_capital_analytics.report_portfolio_overview
[0m00:19:12.982939 [info ] [Thread-4 (]: 21 of 28 START sql view model DEV.report_portfolio_overview .................... [RUN]
[0m00:19:12.983306 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_valuation_enriched, now model.bain_capital_analytics.report_portfolio_overview)
[0m00:19:12.983579 [debug] [Thread-4 (]: Began compiling node model.bain_capital_analytics.report_portfolio_overview
[0m00:19:12.989296 [debug] [Thread-4 (]: Writing injected SQL for node "model.bain_capital_analytics.report_portfolio_overview"
[0m00:19:12.990033 [debug] [Thread-4 (]: Began executing node model.bain_capital_analytics.report_portfolio_overview
[0m00:19:12.992738 [debug] [Thread-4 (]: Writing runtime sql for node "model.bain_capital_analytics.report_portfolio_overview"
[0m00:19:12.994188 [debug] [Thread-4 (]: Using snowflake connection "model.bain_capital_analytics.report_portfolio_overview"
[0m00:19:12.994505 [debug] [Thread-4 (]: On model.bain_capital_analytics.report_portfolio_overview: create or replace   view DBT_DEMO.DEV.report_portfolio_overview
  
  
  
  
  as (
    -- Pipeline A: REPORT table - Portfolio overview for management reporting
-- Anti-pattern: re-aggregates from fact instead of using fact directly in some cases
-- Anti-pattern: subquery instead of QUALIFY for latest date

select
    fps.portfolio_id,
    fps.portfolio_name,
    fps.strategy,
    fps.manager_name,
    fps.position_date as reporting_date,
    fps.num_positions,
    fps.total_market_value,
    fps.total_cost_basis,
    fps.total_unrealized_pnl,
    fps.portfolio_return_pct,
    fps.largest_position_mv,
    fps.smallest_position_mv,
    -- Anti-pattern: duplicated fiscal quarter logic AGAIN
    case
        when extract(month from fps.position_date) between 1 and 3 then 'Q3'
        when extract(month from fps.position_date) between 4 and 6 then 'Q4'
        when extract(month from fps.position_date) between 7 and 9 then 'Q1'
        when extract(month from fps.position_date) between 10 and 12 then 'Q2'
    end as fiscal_quarter,
    case
        when extract(month from fps.position_date) >= 7
        then extract(year from fps.position_date) + 1
        else extract(year from fps.position_date)
    end as fiscal_year
from DBT_DEMO.DEV.fact_portfolio_summary fps
where fps.position_date = (
    -- Anti-pattern: correlated subquery instead of window function / QUALIFY
    select max(fps2.position_date)
    from DBT_DEMO.DEV.fact_portfolio_summary fps2
    where fps2.portfolio_id = fps.portfolio_id
)
order by fps.total_market_value desc
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_portfolio_overview"} */;
[0m00:19:13.071074 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.938 seconds
[0m00:19:13.074044 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e315210>]}
[0m00:19:13.074853 [info ] [Thread-5 (]: 15 of 28 OK created sql view model DEV.int_daily_positions ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m00:19:13.075324 [debug] [Thread-5 (]: Finished running node model.bain_capital_analytics.int_daily_positions
[0m00:19:13.075707 [debug] [Thread-5 (]: Began running node model.bain_capital_analytics.fact_cashflow_waterfall
[0m00:19:13.076290 [info ] [Thread-5 (]: 22 of 28 START sql view model DEV.fact_cashflow_waterfall ...................... [RUN]
[0m00:19:13.076711 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_daily_positions, now model.bain_capital_analytics.fact_cashflow_waterfall)
[0m00:19:13.077020 [debug] [Thread-5 (]: Began compiling node model.bain_capital_analytics.fact_cashflow_waterfall
[0m00:19:13.081949 [debug] [Thread-5 (]: Writing injected SQL for node "model.bain_capital_analytics.fact_cashflow_waterfall"
[0m00:19:13.082678 [debug] [Thread-5 (]: Began executing node model.bain_capital_analytics.fact_cashflow_waterfall
[0m00:19:13.085675 [debug] [Thread-5 (]: Writing runtime sql for node "model.bain_capital_analytics.fact_cashflow_waterfall"
[0m00:19:13.088098 [debug] [Thread-5 (]: Using snowflake connection "model.bain_capital_analytics.fact_cashflow_waterfall"
[0m00:19:13.088514 [debug] [Thread-5 (]: On model.bain_capital_analytics.fact_cashflow_waterfall: create or replace   view DBT_DEMO.DEV.fact_cashflow_waterfall
  
  
  
  
  as (
    -- Pipeline C: FACT table - Cashflow waterfall for PE/fund reporting
-- Anti-pattern: deep CTEs, repeated joins, late aggregation
-- Anti-pattern: PostgreSQL-specific date functions

with enriched_cashflows as (
    select
        ce.cashflow_id,
        ce.fund_id,
        ce.fund_name,
        ce.fund_type,
        ce.portfolio_id,
        ce.portfolio_name,
        ce.cashflow_date,
        ce.cashflow_type,
        ce.amount,
        ce.investor_id,
        ce.committed_capital,
        ce.management_fee_rate,
        ce.carry_rate,
        ce.hurdle_rate,
        ce.cumulative_called,
        ce.cumulative_distributed,
        ce.cumulative_net_cashflow,
        ce.pct_called,
        -- Anti-pattern: duplicated fiscal quarter logic
        case
            when extract(month from ce.cashflow_date) between 1 and 3 then 'Q3'
            when extract(month from ce.cashflow_date) between 4 and 6 then 'Q4'
            when extract(month from ce.cashflow_date) between 7 and 9 then 'Q1'
            when extract(month from ce.cashflow_date) between 10 and 12 then 'Q2'
        end as fiscal_quarter,
        -- Anti-pattern: PostgreSQL extract
        extract(year from ce.cashflow_date) as calendar_year
    from DBT_DEMO.DEV.int_cashflow_enriched ce
),

-- Anti-pattern: re-joining valuations when int_valuation_enriched already has this
waterfall_with_nav as (
    select
        ecf.*,
        v.net_asset_value,
        v.gross_asset_value,
        v.unrealized_pnl as nav_unrealized_pnl,
        v.realized_pnl as nav_realized_pnl
    from enriched_cashflows ecf
    left join DBT_DEMO.DEV.stg_valuations v
        on ecf.portfolio_id = v.portfolio_id
        and ecf.cashflow_date = v.valuation_date
),

-- Anti-pattern: computing carry/waterfall in a CTE chain instead of a macro
waterfall_calculations as (
    select
        wn.*,
        -- Simplified carry calculation
        case
            when wn.cumulative_distributed > wn.cumulative_called * (1 + wn.hurdle_rate)
            then (wn.cumulative_distributed - wn.cumulative_called * (1 + wn.hurdle_rate)) * wn.carry_rate
            else 0
        end as estimated_carry,
        wn.cumulative_called * wn.management_fee_rate as annual_mgmt_fee,
        case
            when wn.cumulative_called > 0
            then wn.cumulative_distributed / wn.cumulative_called
            else 0
        end as dpi,
        case
            when wn.cumulative_called > 0 and wn.net_asset_value is not null
            then (wn.cumulative_distributed + wn.net_asset_value) / wn.cumulative_called
            else null
        end as tvpi
    from waterfall_with_nav wn
)

select * from waterfall_calculations
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_cashflow_waterfall"} */;
[0m00:19:13.151431 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m00:19:13.154429 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd66010>]}
[0m00:19:13.155256 [info ] [Thread-3 (]: 19 of 28 OK created sql view model DEV.fact_trade_activity ..................... [[32mSUCCESS 1[0m in 0.51s]
[0m00:19:13.155747 [debug] [Thread-3 (]: Finished running node model.bain_capital_analytics.fact_trade_activity
[0m00:19:13.156119 [debug] [Thread-3 (]: Began running node model.bain_capital_analytics.fact_portfolio_attribution
[0m00:19:13.156600 [info ] [Thread-3 (]: 23 of 28 START sql view model DEV.fact_portfolio_attribution ................... [RUN]
[0m00:19:13.157030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.fact_trade_activity, now model.bain_capital_analytics.fact_portfolio_attribution)
[0m00:19:13.157344 [debug] [Thread-3 (]: Began compiling node model.bain_capital_analytics.fact_portfolio_attribution
[0m00:19:13.161982 [debug] [Thread-3 (]: Writing injected SQL for node "model.bain_capital_analytics.fact_portfolio_attribution"
[0m00:19:13.162666 [debug] [Thread-3 (]: Began executing node model.bain_capital_analytics.fact_portfolio_attribution
[0m00:19:13.165654 [debug] [Thread-3 (]: Writing runtime sql for node "model.bain_capital_analytics.fact_portfolio_attribution"
[0m00:19:13.167397 [debug] [Thread-3 (]: Using snowflake connection "model.bain_capital_analytics.fact_portfolio_attribution"
[0m00:19:13.167756 [debug] [Thread-3 (]: On model.bain_capital_analytics.fact_portfolio_attribution: create or replace   view DBT_DEMO.DEV.fact_portfolio_attribution
  
  
  
  
  as (
    -- Pipeline C: FACT table - Portfolio attribution with benchmark comparison
-- Anti-pattern: re-joins data that's already in intermediate models
-- Anti-pattern: repeated computation of sector weights

with attribution as (
    select
        pa.portfolio_id,
        pa.portfolio_name,
        pa.strategy,
        pa.fund_id,
        pa.position_date,
        pa.sector,
        pa.sector_mv,
        pa.sector_ugl,
        pa.num_instruments,
        pa.total_portfolio_mv,
        pa.total_portfolio_ugl,
        pa.sector_weight,
        pa.sector_contribution
    from DBT_DEMO.DEV.int_portfolio_attribution pa
),

-- Anti-pattern: re-joining benchmarks (could be done in intermediate)
attribution_with_benchmark as (
    select
        a.*,
        bm.benchmark_name,
        bm.return_mtd as benchmark_return,
        bm.rolling_3m_return as benchmark_3m_return,
        bm.rolling_12m_return as benchmark_12m_return
    from attribution a
    left join DBT_DEMO.DEV.int_benchmark_returns bm
        on a.position_date = bm.benchmark_date
        and bm.benchmark_id = 'BM_SP500'
),

-- Anti-pattern: computing alpha in yet another CTE
attribution_with_alpha as (
    select
        ab.*,
        -- Simplified active return
        case
            when ab.total_portfolio_mv != 0
            then (ab.sector_ugl / ab.total_portfolio_mv) - coalesce(ab.benchmark_return, 0) * ab.sector_weight
            else 0
        end as sector_active_return,
        -- Anti-pattern: re-computing portfolio-level return here
        case
            when ab.total_portfolio_mv != 0
            then ab.total_portfolio_ugl / ab.total_portfolio_mv
            else 0
        end as portfolio_return
    from attribution_with_benchmark ab
)

select * from attribution_with_alpha
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_portfolio_attribution"} */;
[0m00:19:13.488158 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m00:19:13.491111 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3aa390>]}
[0m00:19:13.491817 [info ] [Thread-4 (]: 21 of 28 OK created sql view model DEV.report_portfolio_overview ............... [[32mSUCCESS 1[0m in 0.51s]
[0m00:19:13.492323 [debug] [Thread-4 (]: Finished running node model.bain_capital_analytics.report_portfolio_overview
[0m00:19:13.492699 [debug] [Thread-4 (]: Began running node model.bain_capital_analytics.fact_fund_performance
[0m00:19:13.493152 [info ] [Thread-4 (]: 24 of 28 START sql view model DEV.fact_fund_performance ........................ [RUN]
[0m00:19:13.493530 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.report_portfolio_overview, now model.bain_capital_analytics.fact_fund_performance)
[0m00:19:13.493808 [debug] [Thread-4 (]: Began compiling node model.bain_capital_analytics.fact_fund_performance
[0m00:19:13.498530 [debug] [Thread-4 (]: Writing injected SQL for node "model.bain_capital_analytics.fact_fund_performance"
[0m00:19:13.499255 [debug] [Thread-4 (]: Began executing node model.bain_capital_analytics.fact_fund_performance
[0m00:19:13.501857 [debug] [Thread-4 (]: Writing runtime sql for node "model.bain_capital_analytics.fact_fund_performance"
[0m00:19:13.504369 [debug] [Thread-4 (]: Using snowflake connection "model.bain_capital_analytics.fact_fund_performance"
[0m00:19:13.504789 [debug] [Thread-4 (]: On model.bain_capital_analytics.fact_fund_performance: create or replace   view DBT_DEMO.DEV.fact_fund_performance
  
  
  
  
  as (
    -- Pipeline C: FACT table - Fund-level performance metrics
-- Anti-pattern: late aggregation - joins everything then aggregates
-- Anti-pattern: re-joins fund_structures (already in int_fund_nav, int_cashflow_enriched)
-- Anti-pattern: materialized as view (should be table)

with fund_nav_data as (
    select
        fn.fund_id,
        fn.fund_name,
        fn.fund_type,
        fn.committed_capital,
        fn.valuation_date,
        fn.fund_nav,
        fn.fund_gav,
        fn.fund_total_liabilities,
        fn.fund_unrealized_pnl,
        fn.fund_realized_pnl,
        fn.fund_nav_return,
        fn.tvpi_gross,
        fn.num_portfolios
    from DBT_DEMO.DEV.int_fund_nav fn
),

fund_cashflows as (
    -- Anti-pattern: re-aggregating cashflows that are already in int_cashflow_enriched
    select
        cf.fund_id,
        cf.cashflow_date,
        sum(case when cf.cashflow_type = 'capital_call' then cf.amount else 0 end) as period_calls,
        sum(case when cf.cashflow_type = 'distribution' then cf.amount else 0 end) as period_distributions,
        sum(case when cf.cashflow_type = 'management_fee' then cf.amount else 0 end) as period_fees,
        sum(cf.amount) as period_net_cashflow
    from DBT_DEMO.DEV.stg_cashflows cf
    group by cf.fund_id, cf.cashflow_date
),

fund_irr as (
    select
        irr.fund_id,
        sum(irr.total_invested) as fund_total_invested,
        sum(irr.total_distributed) as fund_total_distributed,
        sum(irr.terminal_value) as fund_terminal_value,
        -- Anti-pattern: averaging portfolio IRRs as proxy for fund IRR (incorrect but intentional)
        avg(irr.approx_irr) as fund_approx_irr,
        avg(irr.tvpi) as fund_tvpi,
        avg(irr.dpi) as fund_dpi
    from DBT_DEMO.DEV.int_irr_calculations irr
    group by irr.fund_id
),

-- Anti-pattern: joining everything together at the end
combined as (
    select
        fn.fund_id,
        fn.fund_name,
        fn.fund_type,
        fn.committed_capital,
        fn.valuation_date,
        fn.fund_nav,
        fn.fund_gav,
        fn.fund_total_liabilities,
        fn.fund_unrealized_pnl,
        fn.fund_realized_pnl,
        fn.fund_nav_return,
        fn.tvpi_gross,
        fn.num_portfolios,
        coalesce(fc.period_calls, 0) as period_calls,
        coalesce(fc.period_distributions, 0) as period_distributions,
        coalesce(fc.period_fees, 0) as period_fees,
        coalesce(fc.period_net_cashflow, 0) as period_net_cashflow,
        fi.fund_total_invested,
        fi.fund_total_distributed,
        fi.fund_approx_irr,
        fi.fund_tvpi,
        fi.fund_dpi
    from fund_nav_data fn
    left join fund_cashflows fc
        on fn.fund_id = fc.fund_id
        and fn.valuation_date = fc.cashflow_date
    left join fund_irr fi
        on fn.fund_id = fi.fund_id
)

select * from combined
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_fund_performance"} */;
[0m00:19:13.544015 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m00:19:13.545834 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3c5a10>]}
[0m00:19:13.546358 [info ] [Thread-2 (]: 20 of 28 OK created sql view model DEV.int_trade_enriched ...................... [[32mSUCCESS 1[0m in 0.63s]
[0m00:19:13.546784 [debug] [Thread-2 (]: Finished running node model.bain_capital_analytics.int_trade_enriched
[0m00:19:13.547097 [debug] [Thread-2 (]: Began running node model.bain_capital_analytics.report_lp_quarterly
[0m00:19:13.547502 [info ] [Thread-2 (]: 25 of 28 START sql view model DEV.report_lp_quarterly .......................... [RUN]
[0m00:19:13.547854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.int_trade_enriched, now model.bain_capital_analytics.report_lp_quarterly)
[0m00:19:13.548133 [debug] [Thread-2 (]: Began compiling node model.bain_capital_analytics.report_lp_quarterly
[0m00:19:13.553310 [debug] [Thread-2 (]: Writing injected SQL for node "model.bain_capital_analytics.report_lp_quarterly"
[0m00:19:13.553874 [debug] [Thread-2 (]: Began executing node model.bain_capital_analytics.report_lp_quarterly
[0m00:19:13.555901 [debug] [Thread-2 (]: Writing runtime sql for node "model.bain_capital_analytics.report_lp_quarterly"
[0m00:19:13.558862 [debug] [Thread-2 (]: Using snowflake connection "model.bain_capital_analytics.report_lp_quarterly"
[0m00:19:13.559285 [debug] [Thread-2 (]: On model.bain_capital_analytics.report_lp_quarterly: create or replace   view DBT_DEMO.DEV.report_lp_quarterly
  
  
  
  
  as (
    -- Pipeline C: REPORT table - LP quarterly reporting
-- Anti-pattern: massive query, duplicated logic, no reuse of intermediates
-- Anti-pattern: PostgreSQL-specific date_trunc
-- Anti-pattern: re-aggregation of data already aggregated upstream

with quarterly_cashflows as (
    -- Anti-pattern: re-aggregating cashflows by quarter (already in int_cashflow_enriched)
    select
        cf.fund_id,
        cf.portfolio_id,
        -- Anti-pattern: PostgreSQL-specific date_trunc
        DATE_TRUNC('QUARTER', cf.cashflow_date) as quarter_start,
        cf.cashflow_fiscal_quarter as fiscal_quarter,
        cf.cashflow_year,
        sum(case when cf.cashflow_type = 'capital_call' then cf.amount else 0 end) as quarter_calls,
        sum(case when cf.cashflow_type = 'distribution' then cf.amount else 0 end) as quarter_distributions,
        sum(case when cf.cashflow_type = 'management_fee' then cf.amount else 0 end) as quarter_fees,
        sum(cf.amount) as quarter_net
    from DBT_DEMO.DEV.stg_cashflows cf
    group by
        cf.fund_id, cf.portfolio_id,
        DATE_TRUNC('QUARTER', cf.cashflow_date),
        cf.cashflow_fiscal_quarter, cf.cashflow_year
),

quarterly_valuations as (
    -- Anti-pattern: re-querying valuations with subquery for quarter-end
    select *
    from (
        select
            v.portfolio_id,
            v.valuation_date,
            v.net_asset_value,
            v.gross_asset_value,
            v.unrealized_pnl,
            v.realized_pnl,
            v.valuation_method,
            -- Anti-pattern: subquery dedup instead of QUALIFY
            row_number() over (
                partition by v.portfolio_id, DATE_TRUNC('QUARTER', v.valuation_date)
                order by v.valuation_date desc
            ) as rn
        from DBT_DEMO.DEV.stg_valuations v
    ) sub
    where rn = 1
),

-- Anti-pattern: re-joining fund structures (done in multiple places)
fund_details as (
    select
        fs.fund_id,
        fs.fund_name,
        fs.fund_type,
        fs.committed_capital,
        fs.management_fee_rate,
        fs.carry_rate,
        fs.hurdle_rate,
        fs.vintage_year,
        fs.gp_commitment_pct
    from DBT_DEMO.DEV.stg_fund_structures fs
),

-- Anti-pattern: joining everything at the end
lp_report as (
    select
        fd.fund_id,
        fd.fund_name,
        fd.fund_type,
        fd.vintage_year,
        fd.committed_capital,
        fd.management_fee_rate,
        fd.carry_rate,
        fd.hurdle_rate,
        fd.gp_commitment_pct,
        qc.portfolio_id,
        p.portfolio_name,
        p.strategy,
        qc.quarter_start,
        qc.fiscal_quarter,
        qc.cashflow_year,
        qc.quarter_calls,
        qc.quarter_distributions,
        qc.quarter_fees,
        qc.quarter_net,
        qv.net_asset_value as quarter_end_nav,
        qv.gross_asset_value as quarter_end_gav,
        qv.unrealized_pnl,
        qv.realized_pnl,
        qv.valuation_method,
        -- Anti-pattern: IRR re-joined from separate calculation
        irr.approx_irr,
        irr.tvpi,
        irr.dpi,
        irr.rvpi
    from quarterly_cashflows qc
    inner join fund_details fd
        on qc.fund_id = fd.fund_id
    inner join DBT_DEMO.DEV.stg_portfolios p
        on qc.portfolio_id = p.portfolio_id
    left join quarterly_valuations qv
        on qc.portfolio_id = qv.portfolio_id
        and DATE_TRUNC('QUARTER', qv.valuation_date) = qc.quarter_start
    left join DBT_DEMO.DEV.int_irr_calculations irr
        on qc.fund_id = irr.fund_id
        and qc.portfolio_id = irr.portfolio_id
)

select
    *,
    -- Anti-pattern: computed columns in final select
    case
        when committed_capital > 0
        then quarter_calls / committed_capital
        else 0
    end as quarterly_drawdown_rate,
    case
        when quarter_end_nav is not null and committed_capital > 0
        then quarter_end_nav / committed_capital
        else null
    end as nav_to_commitment_ratio
from lp_report
order by fund_id, portfolio_id, quarter_start
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_lp_quarterly"} */;
[0m00:19:13.663809 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m00:19:13.666817 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ca010>]}
[0m00:19:13.667623 [info ] [Thread-5 (]: 22 of 28 OK created sql view model DEV.fact_cashflow_waterfall ................. [[32mSUCCESS 1[0m in 0.59s]
[0m00:19:13.668170 [debug] [Thread-5 (]: Finished running node model.bain_capital_analytics.fact_cashflow_waterfall
[0m00:19:13.668553 [debug] [Thread-5 (]: Began running node model.bain_capital_analytics.fact_portfolio_pnl
[0m00:19:13.669071 [info ] [Thread-5 (]: 26 of 28 START sql view model DEV.fact_portfolio_pnl ........................... [RUN]
[0m00:19:13.669631 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.fact_cashflow_waterfall, now model.bain_capital_analytics.fact_portfolio_pnl)
[0m00:19:13.670008 [debug] [Thread-5 (]: Began compiling node model.bain_capital_analytics.fact_portfolio_pnl
[0m00:19:13.675609 [debug] [Thread-5 (]: Writing injected SQL for node "model.bain_capital_analytics.fact_portfolio_pnl"
[0m00:19:13.676283 [debug] [Thread-5 (]: Began executing node model.bain_capital_analytics.fact_portfolio_pnl
[0m00:19:13.679134 [debug] [Thread-5 (]: Writing runtime sql for node "model.bain_capital_analytics.fact_portfolio_pnl"
[0m00:19:13.681632 [debug] [Thread-5 (]: Using snowflake connection "model.bain_capital_analytics.fact_portfolio_pnl"
[0m00:19:13.682050 [debug] [Thread-5 (]: On model.bain_capital_analytics.fact_portfolio_pnl: create or replace   view DBT_DEMO.DEV.fact_portfolio_pnl
  
  
  
  
  as (
    -- Pipeline B: FACT table - Portfolio PnL by date
-- Anti-pattern: repeats the same heavy 3-table join as int_trade_enriched
-- Anti-pattern: late aggregation after expensive joins
-- Anti-pattern: materialized as view (should be table/incremental)

with trade_pnl as (
    -- Anti-pattern: re-joining trades to instruments and portfolios
    -- (same join already done in int_trade_enriched)
    select
        t.portfolio_id,
        t.trade_date,
        t.instrument_id,
        t.trade_type,
        t.notional_amount,
        t.commission,
        i.instrument_name,
        i.instrument_type,
        i.sector,
        p.portfolio_name,
        p.strategy,
        p.fund_id,
        d.fiscal_quarter,
        d.fiscal_year,
        d.is_month_end,
        d.is_quarter_end
    from DBT_DEMO.DEV.stg_trades t
    inner join DBT_DEMO.DEV.stg_instruments i
        on t.instrument_id = i.instrument_id
    inner join DBT_DEMO.DEV.stg_portfolios p
        on t.portfolio_id = p.portfolio_id
    inner join DBT_DEMO.DEV.stg_dates d
        on t.trade_date = d.date_day
),

position_pnl as (
    select
        dp.portfolio_id,
        dp.position_date,
        dp.portfolio_name,
        dp.strategy,
        dp.fund_id,
        dp.fiscal_quarter,
        dp.fiscal_year,
        sum(dp.daily_pnl) as position_daily_pnl,
        sum(dp.market_value) as total_market_value,
        count(distinct dp.instrument_id) as num_positions
    from DBT_DEMO.DEV.int_daily_positions dp
    group by
        dp.portfolio_id, dp.position_date, dp.portfolio_name,
        dp.strategy, dp.fund_id, dp.fiscal_quarter, dp.fiscal_year
),

-- Anti-pattern: aggregating trades separately then joining back
trade_activity as (
    select
        portfolio_id,
        trade_date,
        sum(notional_amount) as total_traded_notional,
        sum(commission) as total_commissions,
        count(*) as num_trades
    from trade_pnl
    group by portfolio_id, trade_date
)

select
    pp.portfolio_id,
    pp.portfolio_name,
    pp.strategy,
    pp.fund_id,
    pp.position_date as pnl_date,
    pp.fiscal_quarter,
    pp.fiscal_year,
    pp.position_daily_pnl,
    pp.total_market_value,
    pp.num_positions,
    coalesce(ta.total_traded_notional, 0) as total_traded_notional,
    coalesce(ta.total_commissions, 0) as total_commissions,
    coalesce(ta.num_trades, 0) as num_trades,
    -- Anti-pattern: running total recomputed here (already in int_trade_enriched)
    sum(pp.position_daily_pnl) over (
        partition by pp.portfolio_id
        order by pp.position_date
        rows between unbounded preceding and current row
    ) as cumulative_pnl
from position_pnl pp
left join trade_activity ta
    on pp.portfolio_id = ta.portfolio_id
    and pp.position_date = ta.trade_date
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.fact_portfolio_pnl"} */;
[0m00:19:13.845880 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m00:19:13.850542 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3fe710>]}
[0m00:19:14.238783 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m00:19:14.241965 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e446dd0>]}
[0m00:19:14.331312 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.826 seconds
[0m00:19:14.335058 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcdd010>]}
[0m00:19:14.377004 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m00:19:14.380087 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d10bc50>]}
[0m00:19:15.460120 [debug] [Thread-3 (]: An error was encountered while trying to send an event
[0m00:19:15.461413 [info ] [Thread-2 (]: 25 of 28 OK created sql view model DEV.report_lp_quarterly ..................... [[32mSUCCESS 1[0m in 0.69s]
[0m00:19:15.462073 [info ] [Thread-4 (]: 24 of 28 OK created sql view model DEV.fact_fund_performance ................... [[32mSUCCESS 1[0m in 0.84s]
[0m00:19:15.462695 [info ] [Thread-5 (]: 26 of 28 OK created sql view model DEV.fact_portfolio_pnl ...................... [[32mSUCCESS 1[0m in 0.71s]
[0m00:19:15.464991 [info ] [Thread-3 (]: 23 of 28 OK created sql view model DEV.fact_portfolio_attribution .............. [[32mSUCCESS 1[0m in 0.69s]
[0m00:19:15.465580 [debug] [Thread-2 (]: Finished running node model.bain_capital_analytics.report_lp_quarterly
[0m00:19:15.466089 [debug] [Thread-4 (]: Finished running node model.bain_capital_analytics.fact_fund_performance
[0m00:19:15.466533 [debug] [Thread-5 (]: Finished running node model.bain_capital_analytics.fact_portfolio_pnl
[0m00:19:15.466975 [debug] [Thread-3 (]: Finished running node model.bain_capital_analytics.fact_portfolio_attribution
[0m00:19:15.467798 [debug] [Thread-5 (]: Began running node model.bain_capital_analytics.report_ic_dashboard
[0m00:19:15.468334 [debug] [Thread-4 (]: Began running node model.bain_capital_analytics.report_daily_pnl
[0m00:19:15.468791 [info ] [Thread-5 (]: 27 of 28 START sql view model DEV.report_ic_dashboard .......................... [RUN]
[0m00:19:15.469308 [info ] [Thread-4 (]: 28 of 28 START sql view model DEV.report_daily_pnl ............................. [RUN]
[0m00:19:15.469936 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.fact_portfolio_pnl, now model.bain_capital_analytics.report_ic_dashboard)
[0m00:19:15.470322 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bain_capital_analytics.fact_fund_performance, now model.bain_capital_analytics.report_daily_pnl)
[0m00:19:15.470668 [debug] [Thread-5 (]: Began compiling node model.bain_capital_analytics.report_ic_dashboard
[0m00:19:15.470942 [debug] [Thread-4 (]: Began compiling node model.bain_capital_analytics.report_daily_pnl
[0m00:19:15.476650 [debug] [Thread-5 (]: Writing injected SQL for node "model.bain_capital_analytics.report_ic_dashboard"
[0m00:19:15.480578 [debug] [Thread-4 (]: Writing injected SQL for node "model.bain_capital_analytics.report_daily_pnl"
[0m00:19:15.481286 [debug] [Thread-5 (]: Began executing node model.bain_capital_analytics.report_ic_dashboard
[0m00:19:15.481591 [debug] [Thread-4 (]: Began executing node model.bain_capital_analytics.report_daily_pnl
[0m00:19:15.484261 [debug] [Thread-5 (]: Writing runtime sql for node "model.bain_capital_analytics.report_ic_dashboard"
[0m00:19:15.487974 [debug] [Thread-4 (]: Writing runtime sql for node "model.bain_capital_analytics.report_daily_pnl"
[0m00:19:15.490677 [debug] [Thread-5 (]: Using snowflake connection "model.bain_capital_analytics.report_ic_dashboard"
[0m00:19:15.491819 [debug] [Thread-4 (]: Using snowflake connection "model.bain_capital_analytics.report_daily_pnl"
[0m00:19:15.492201 [debug] [Thread-5 (]: On model.bain_capital_analytics.report_ic_dashboard: create or replace   view DBT_DEMO.DEV.report_ic_dashboard
  
  
  
  
  as (
    -- Pipeline C: REPORT table - Investment Committee dashboard
-- Anti-pattern: massive query joining many sources, no intermediate reuse
-- Anti-pattern: subquery for latest records instead of QUALIFY
-- Anti-pattern: duplicated logic from other reports

with latest_fund_performance as (
    select *
    from (
        select
            fp.*,
            -- Anti-pattern: subquery dedup instead of QUALIFY
            row_number() over (
                partition by fp.fund_id
                order by fp.valuation_date desc
            ) as rn
        from DBT_DEMO.DEV.fact_fund_performance fp
    ) sub
    where rn = 1
),

latest_portfolio_summary as (
    select *
    from (
        select
            ps.*,
            row_number() over (
                partition by ps.portfolio_id
                order by ps.position_date desc
            ) as rn
        from DBT_DEMO.DEV.fact_portfolio_summary ps
    ) sub
    where rn = 1
),

-- Anti-pattern: re-joining fund structures (already in fact_fund_performance)
fund_overview as (
    select
        lfp.fund_id,
        lfp.fund_name,
        lfp.fund_type,
        lfp.committed_capital,
        lfp.valuation_date as latest_valuation_date,
        lfp.fund_nav,
        lfp.fund_gav,
        lfp.fund_nav_return as latest_nav_return,
        lfp.tvpi_gross,
        lfp.fund_approx_irr,
        lfp.fund_tvpi,
        lfp.fund_dpi,
        lfp.num_portfolios,
        lfp.fund_total_invested,
        lfp.fund_total_distributed,
        -- Anti-pattern: re-joining fund structures
        fs.management_fee_rate,
        fs.carry_rate,
        fs.hurdle_rate,
        fs.vintage_year
    from latest_fund_performance lfp
    inner join DBT_DEMO.DEV.stg_fund_structures fs
        on lfp.fund_id = fs.fund_id
),

portfolio_details as (
    select
        lps.portfolio_id,
        lps.portfolio_name,
        lps.strategy,
        lps.fund_id,
        lps.total_market_value,
        lps.total_unrealized_pnl,
        lps.portfolio_return_pct,
        lps.num_positions,
        -- Anti-pattern: re-computing fiscal quarter
        case
            when extract(month from lps.position_date) between 1 and 3 then 'Q3'
            when extract(month from lps.position_date) between 4 and 6 then 'Q4'
            when extract(month from lps.position_date) between 7 and 9 then 'Q1'
            when extract(month from lps.position_date) between 10 and 12 then 'Q2'
        end as reporting_fiscal_quarter
    from latest_portfolio_summary lps
)

select
    fo.fund_id,
    fo.fund_name,
    fo.fund_type,
    fo.vintage_year,
    fo.committed_capital,
    fo.latest_valuation_date,
    fo.fund_nav,
    fo.fund_gav,
    fo.latest_nav_return,
    fo.tvpi_gross,
    fo.fund_approx_irr,
    fo.fund_tvpi,
    fo.fund_dpi,
    fo.num_portfolios,
    fo.fund_total_invested,
    fo.fund_total_distributed,
    fo.management_fee_rate,
    fo.carry_rate,
    fo.hurdle_rate,
    pd.portfolio_id,
    pd.portfolio_name,
    pd.strategy,
    pd.total_market_value as portfolio_mv,
    pd.total_unrealized_pnl as portfolio_unrealized_pnl,
    pd.portfolio_return_pct,
    pd.num_positions as portfolio_num_positions,
    pd.reporting_fiscal_quarter
from fund_overview fo
inner join portfolio_details pd
    on fo.fund_id = pd.fund_id
order by fo.fund_nav desc, pd.total_market_value desc
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_ic_dashboard"} */;
[0m00:19:15.492686 [debug] [Thread-4 (]: On model.bain_capital_analytics.report_daily_pnl: create or replace   view DBT_DEMO.DEV.report_daily_pnl
  
  
  
  
  as (
    -- Pipeline B: REPORT table - Daily PnL report for portfolio managers
-- Anti-pattern: subquery for latest-only instead of QUALIFY
-- Anti-pattern: re-aggregation from fact that's already aggregated

with latest_pnl as (
    select *
    from (
        select
            fpnl.*,
            -- Anti-pattern: subquery dedup instead of QUALIFY
            row_number() over (
                partition by fpnl.portfolio_id
                order by fpnl.pnl_date desc
            ) as rn
        from DBT_DEMO.DEV.fact_portfolio_pnl fpnl
    ) sub
    where rn <= 5  -- last 5 dates per portfolio
),

-- Anti-pattern: re-joining to get benchmark data that should be part of the pipeline
pnl_with_benchmark as (
    select
        lp.*,
        bm.return_mtd as benchmark_return_mtd,
        bm.return_ytd as benchmark_return_ytd,
        bm.benchmark_name
    from latest_pnl lp
    left join DBT_DEMO.DEV.stg_benchmarks bm
        on lp.pnl_date = bm.benchmark_date
        and bm.benchmark_id = 'BM_SP500'
)

select
    portfolio_id,
    portfolio_name,
    strategy,
    pnl_date,
    fiscal_quarter,
    position_daily_pnl,
    cumulative_pnl,
    total_market_value,
    num_positions,
    total_traded_notional,
    total_commissions,
    num_trades,
    benchmark_name,
    benchmark_return_mtd,
    benchmark_return_ytd,
    -- Anti-pattern: computing return inline instead of upstream
    case
        when total_market_value != 0
        then position_daily_pnl / total_market_value
        else 0
    end as daily_return_pct
from pnl_with_benchmark
order by portfolio_id, pnl_date desc
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "model.bain_capital_analytics.report_daily_pnl"} */;
[0m00:19:16.376727 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.883 seconds
[0m00:19:16.378013 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.885 seconds
[0m00:19:16.380760 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e51f550>]}
[0m00:19:16.382365 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0060742-5b3a-4d7d-9bff-3f8682648269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5093d0>]}
[0m00:19:16.383107 [info ] [Thread-5 (]: 27 of 28 OK created sql view model DEV.report_ic_dashboard ..................... [[32mSUCCESS 1[0m in 0.91s]
[0m00:19:16.383551 [info ] [Thread-4 (]: 28 of 28 OK created sql view model DEV.report_daily_pnl ........................ [[32mSUCCESS 1[0m in 0.91s]
[0m00:19:16.384233 [debug] [Thread-5 (]: Finished running node model.bain_capital_analytics.report_ic_dashboard
[0m00:19:16.384691 [debug] [Thread-4 (]: Finished running node model.bain_capital_analytics.report_daily_pnl
[0m00:19:16.386397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:16.386674 [debug] [MainThread]: Connection 'model.bain_capital_analytics.report_lp_quarterly' was left open.
[0m00:19:16.386930 [debug] [MainThread]: On model.bain_capital_analytics.report_lp_quarterly: Close
[0m00:19:16.687359 [debug] [MainThread]: Connection 'model.bain_capital_analytics.fact_portfolio_attribution' was left open.
[0m00:19:16.688446 [debug] [MainThread]: On model.bain_capital_analytics.fact_portfolio_attribution: Close
[0m00:19:16.977633 [debug] [MainThread]: Connection 'model.bain_capital_analytics.report_daily_pnl' was left open.
[0m00:19:16.978731 [debug] [MainThread]: On model.bain_capital_analytics.report_daily_pnl: Close
[0m00:19:17.308076 [debug] [MainThread]: Connection 'model.bain_capital_analytics.report_ic_dashboard' was left open.
[0m00:19:17.308700 [debug] [MainThread]: On model.bain_capital_analytics.report_ic_dashboard: Close
[0m00:19:17.620073 [info ] [MainThread]: 
[0m00:19:17.620897 [info ] [MainThread]: Finished running 28 view models in 0 hours 0 minutes and 10.86 seconds (10.86s).
[0m00:19:17.624798 [debug] [MainThread]: Command end result
[0m00:19:17.663330 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m00:19:17.664898 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m00:19:17.670283 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m00:19:17.670521 [info ] [MainThread]: 
[0m00:19:17.670778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:19:17.671001 [info ] [MainThread]: 
[0m00:19:17.671214 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=28
[0m00:19:17.674346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.865832, "process_in_blocks": "0", "process_kernel_time": 0.42496, "process_mem_max_rss": "175800320", "process_out_blocks": "0", "process_user_time": 2.671028}
[0m00:19:17.674720 [debug] [MainThread]: Command `dbt run` succeeded at 00:19:17.674650 after 11.87 seconds
[0m00:19:17.675003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b223d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb8c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f3110>]}
[0m00:19:17.675262 [debug] [MainThread]: Flushing usage events
[0m00:19:18.657177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:37.203648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d515810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1bff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5893d0>]}


============================== 00:19:37.206909 | e685c0d5-ef61-4e71-8ac7-47701e9cfd8a ==============================
[0m00:19:37.206909 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:19:37.207377 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'no_print': 'None', 'indirect_selection': 'eager', 'log_path': 'logs', 'use_colors': 'True', 'invocation_command': 'dbt test --profiles-dir . --project-dir .', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'version_check': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'debug': 'False'}
[0m00:19:37.442008 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m00:19:37.442575 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m00:19:37.442888 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m00:19:37.581793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e685c0d5-ef61-4e71-8ac7-47701e9cfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d555350>]}
[0m00:19:37.625346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e685c0d5-ef61-4e71-8ac7-47701e9cfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6d6b10>]}
[0m00:19:37.626353 [info ] [MainThread]: Registered adapter: snowflake=1.11.1
[0m00:19:37.734840 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m00:19:37.869254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:19:37.873034 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m00:19:37.873515 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:19:37.944218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e685c0d5-ef61-4e71-8ac7-47701e9cfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7f0c50>]}
[0m00:19:38.076270 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m00:19:38.078744 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m00:19:38.103558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e685c0d5-ef61-4e71-8ac7-47701e9cfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f56fdd0>]}
[0m00:19:38.104129 [info ] [MainThread]: Found 28 models, 53 data tests, 10 seeds, 644 macros
[0m00:19:38.104383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e685c0d5-ef61-4e71-8ac7-47701e9cfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e64e090>]}
[0m00:19:38.107696 [info ] [MainThread]: 
[0m00:19:38.107939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:19:38.108122 [info ] [MainThread]: 
[0m00:19:38.108485 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:19:38.113388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO_DEV'
[0m00:19:38.113903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_DEMO_DEV_raw'
[0m00:19:38.169972 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV_raw"
[0m00:19:38.170444 [debug] [ThreadPool]: Using snowflake connection "list_DBT_DEMO_DEV"
[0m00:19:38.170773 [debug] [ThreadPool]: On list_DBT_DEMO_DEV_raw: show objects in DBT_DEMO.DEV_raw
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV_raw"} */;
[0m00:19:38.170993 [debug] [ThreadPool]: On list_DBT_DEMO_DEV: show objects in DBT_DEMO.DEV
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "connection_name": "list_DBT_DEMO_DEV"} */;
[0m00:19:38.171202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:38.171387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:39.731728 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.560 seconds
[0m00:19:39.739320 [debug] [ThreadPool]: SQL status: SUCCESS 45 in 1.568 seconds
[0m00:19:39.748239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e685c0d5-ef61-4e71-8ac7-47701e9cfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a84ca50>]}
[0m00:19:39.753626 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.assert_pnl_balanced
[0m00:19:39.754042 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486
[0m00:19:39.754366 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4
[0m00:19:39.754648 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62
[0m00:19:39.755041 [info ] [Thread-2 (]: 1 of 53 START test assert_pnl_balanced ......................................... [RUN]
[0m00:19:39.755428 [info ] [Thread-3 (]: 2 of 53 START test not_null_fact_cashflow_waterfall_cashflow_id ................ [RUN]
[0m00:19:39.755758 [info ] [Thread-4 (]: 3 of 53 START test not_null_fact_fund_performance_fund_id ...................... [RUN]
[0m00:19:39.756052 [info ] [Thread-5 (]: 4 of 53 START test not_null_fact_portfolio_attribution_portfolio_id ............ [RUN]
[0m00:19:39.756454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV, now test.bain_capital_analytics.assert_pnl_balanced)
[0m00:19:39.756754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_DBT_DEMO_DEV_raw, now test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486)
[0m00:19:39.757063 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4'
[0m00:19:39.757345 [debug] [Thread-5 (]: Acquiring new snowflake connection 'test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62'
[0m00:19:39.757577 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.assert_pnl_balanced
[0m00:19:39.757790 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486
[0m00:19:39.757999 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4
[0m00:19:39.758205 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62
[0m00:19:39.835576 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.assert_pnl_balanced"
[0m00:19:39.844023 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486"
[0m00:19:39.846693 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4"
[0m00:19:39.849383 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62"
[0m00:19:39.850222 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.assert_pnl_balanced
[0m00:19:39.850602 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4
[0m00:19:39.850834 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486
[0m00:19:39.856198 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62
[0m00:19:39.867689 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4"
[0m00:19:39.868726 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.assert_pnl_balanced"
[0m00:19:39.870474 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486"
[0m00:19:39.873295 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62"
[0m00:19:39.874330 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.assert_pnl_balanced"
[0m00:19:39.874806 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4"
[0m00:19:39.875294 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62"
[0m00:19:39.875738 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486"
[0m00:19:39.875984 [debug] [Thread-2 (]: On test.bain_capital_analytics.assert_pnl_balanced: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Custom test: Ensure total PnL across all portfolios is reasonable
-- (not wildly negative, which would indicate a data or logic error)

select
    pnl_date,
    sum(position_daily_pnl) as total_daily_pnl
from DBT_DEMO.DEV.fact_portfolio_pnl
group by pnl_date
having sum(position_daily_pnl) < -100000000  -- flag if total daily loss exceeds $100M
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.assert_pnl_balanced"} */
[0m00:19:39.876296 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fund_id
from DBT_DEMO.DEV.fact_fund_performance
where fund_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4"} */
[0m00:19:39.876630 [debug] [Thread-5 (]: On test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.fact_portfolio_attribution
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62"} */
[0m00:19:39.876922 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cashflow_id
from DBT_DEMO.DEV.fact_cashflow_waterfall
where cashflow_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486"} */
[0m00:19:39.877433 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:19:39.877849 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:19:41.751152 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.873 seconds
[0m00:19:41.761849 [info ] [Thread-3 (]: 2 of 53 PASS not_null_fact_cashflow_waterfall_cashflow_id ...................... [[32mPASS[0m in 2.00s]
[0m00:19:41.762508 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486
[0m00:19:41.762879 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4
[0m00:19:41.763325 [info ] [Thread-3 (]: 5 of 53 START test not_null_fact_portfolio_pnl_pnl_date ........................ [RUN]
[0m00:19:41.763787 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_fact_cashflow_waterfall_cashflow_id.7aafd60486, now test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4)
[0m00:19:41.764116 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4
[0m00:19:41.770099 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4"
[0m00:19:41.770986 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4
[0m00:19:41.773251 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4"
[0m00:19:41.774135 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4"
[0m00:19:41.774439 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pnl_date
from DBT_DEMO.DEV.fact_portfolio_pnl
where pnl_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4"} */
[0m00:19:42.612307 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.735 seconds
[0m00:19:42.615859 [info ] [Thread-2 (]: 1 of 53 PASS assert_pnl_balanced ............................................... [[32mPASS[0m in 2.86s]
[0m00:19:42.616549 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.assert_pnl_balanced
[0m00:19:42.616986 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4
[0m00:19:42.617476 [info ] [Thread-2 (]: 6 of 53 START test not_null_fact_portfolio_pnl_portfolio_id .................... [RUN]
[0m00:19:42.617997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.assert_pnl_balanced, now test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4)
[0m00:19:42.618363 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4
[0m00:19:42.624510 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4"
[0m00:19:42.625580 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4
[0m00:19:42.628213 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4"
[0m00:19:42.629478 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4"
[0m00:19:42.629980 [debug] [Thread-2 (]: On test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.fact_portfolio_pnl
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4"} */
[0m00:19:42.853597 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 2.975 seconds
[0m00:19:42.858350 [info ] [Thread-5 (]: 4 of 53 PASS not_null_fact_portfolio_attribution_portfolio_id .................. [[32mPASS[0m in 3.10s]
[0m00:19:42.859480 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62
[0m00:19:42.859964 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523
[0m00:19:42.860462 [info ] [Thread-5 (]: 7 of 53 START test not_null_fact_portfolio_summary_portfolio_id ................ [RUN]
[0m00:19:42.860937 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_fact_portfolio_attribution_portfolio_id.f676c7df62, now test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523)
[0m00:19:42.861273 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523
[0m00:19:42.865572 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523"
[0m00:19:42.866381 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523
[0m00:19:42.868342 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523"
[0m00:19:42.869078 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523"
[0m00:19:42.869339 [debug] [Thread-5 (]: On test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.fact_portfolio_summary
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523"} */
[0m00:19:43.427067 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.549 seconds
[0m00:19:43.431148 [info ] [Thread-4 (]: 3 of 53 PASS not_null_fact_fund_performance_fund_id ............................ [[32mPASS[0m in 3.67s]
[0m00:19:43.431787 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4
[0m00:19:43.432180 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961
[0m00:19:43.432639 [info ] [Thread-4 (]: 8 of 53 START test not_null_fact_portfolio_summary_position_date ............... [RUN]
[0m00:19:43.433123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_fact_fund_performance_fund_id.738d6489c4, now test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961)
[0m00:19:43.433492 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961
[0m00:19:43.439668 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961"
[0m00:19:43.440451 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961
[0m00:19:43.442385 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961"
[0m00:19:43.443161 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961"
[0m00:19:43.443434 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select position_date
from DBT_DEMO.DEV.fact_portfolio_summary
where position_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961"} */
[0m00:19:43.465990 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m00:19:43.467671 [info ] [Thread-5 (]: 7 of 53 PASS not_null_fact_portfolio_summary_portfolio_id ...................... [[32mPASS[0m in 0.61s]
[0m00:19:43.468124 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523
[0m00:19:43.468427 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45
[0m00:19:43.468758 [info ] [Thread-5 (]: 9 of 53 START test not_null_fact_trade_activity_trade_id ....................... [RUN]
[0m00:19:43.469056 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_fact_portfolio_summary_portfolio_id.98891ba523, now test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45)
[0m00:19:43.469294 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45
[0m00:19:43.472486 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45"
[0m00:19:43.473013 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45
[0m00:19:43.474749 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45"
[0m00:19:43.475394 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45"
[0m00:19:43.475641 [debug] [Thread-5 (]: On test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_id
from DBT_DEMO.DEV.fact_trade_activity
where trade_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45"} */
[0m00:19:43.518163 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.888 seconds
[0m00:19:43.519758 [info ] [Thread-2 (]: 6 of 53 PASS not_null_fact_portfolio_pnl_portfolio_id .......................... [[32mPASS[0m in 0.90s]
[0m00:19:43.520222 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4
[0m00:19:43.520528 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44
[0m00:19:43.520807 [info ] [Thread-2 (]: 10 of 53 START test not_null_int_benchmark_returns_benchmark_id ................ [RUN]
[0m00:19:43.521120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_fact_portfolio_pnl_portfolio_id.f71baa71b4, now test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44)
[0m00:19:43.521465 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44
[0m00:19:43.524828 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44"
[0m00:19:43.525487 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44
[0m00:19:43.527189 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44"
[0m00:19:43.527950 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44"
[0m00:19:43.528201 [debug] [Thread-2 (]: On test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select benchmark_id
from DBT_DEMO.DEV.int_benchmark_returns
where benchmark_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44"} */
[0m00:19:43.554237 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.779 seconds
[0m00:19:43.555688 [info ] [Thread-3 (]: 5 of 53 PASS not_null_fact_portfolio_pnl_pnl_date .............................. [[32mPASS[0m in 1.79s]
[0m00:19:43.556070 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4
[0m00:19:43.556330 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d
[0m00:19:43.556629 [info ] [Thread-3 (]: 11 of 53 START test not_null_int_cashflow_enriched_cashflow_id ................. [RUN]
[0m00:19:43.556914 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_fact_portfolio_pnl_pnl_date.1a8f6bfde4, now test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d)
[0m00:19:43.557151 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d
[0m00:19:43.560287 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d"
[0m00:19:43.560810 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d
[0m00:19:43.562535 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d"
[0m00:19:43.563184 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d"
[0m00:19:43.563429 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cashflow_id
from DBT_DEMO.DEV.int_cashflow_enriched
where cashflow_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d"} */
[0m00:19:43.713977 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m00:19:43.718658 [info ] [Thread-4 (]: 8 of 53 PASS not_null_fact_portfolio_summary_position_date ..................... [[32mPASS[0m in 0.29s]
[0m00:19:43.719505 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961
[0m00:19:43.719820 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6
[0m00:19:43.720154 [info ] [Thread-4 (]: 12 of 53 START test not_null_int_daily_positions_position_id ................... [RUN]
[0m00:19:43.720518 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_fact_portfolio_summary_position_date.f6861b4961, now test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6)
[0m00:19:43.720775 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6
[0m00:19:43.725965 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6"
[0m00:19:43.726624 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6
[0m00:19:43.728511 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6"
[0m00:19:43.729264 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6"
[0m00:19:43.729521 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select position_id
from DBT_DEMO.DEV.int_daily_positions
where position_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6"} */
[0m00:19:44.217959 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m00:19:44.222628 [info ] [Thread-2 (]: 10 of 53 PASS not_null_int_benchmark_returns_benchmark_id ...................... [[32mPASS[0m in 0.70s]
[0m00:19:44.223651 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44
[0m00:19:44.224024 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99
[0m00:19:44.224401 [info ] [Thread-2 (]: 13 of 53 START test not_null_int_fund_nav_fund_id .............................. [RUN]
[0m00:19:44.224823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_int_benchmark_returns_benchmark_id.fa96f53b44, now test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99)
[0m00:19:44.225114 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99
[0m00:19:44.228832 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99"
[0m00:19:44.229542 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99
[0m00:19:44.231410 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99"
[0m00:19:44.232139 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99"
[0m00:19:44.232390 [debug] [Thread-2 (]: On test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fund_id
from DBT_DEMO.DEV.int_fund_nav
where fund_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99"} */
[0m00:19:44.360657 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.797 seconds
[0m00:19:44.364573 [info ] [Thread-3 (]: 11 of 53 PASS not_null_int_cashflow_enriched_cashflow_id ....................... [[32mPASS[0m in 0.81s]
[0m00:19:44.365122 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d
[0m00:19:44.365460 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3
[0m00:19:44.365897 [info ] [Thread-3 (]: 14 of 53 START test not_null_int_irr_calculations_fund_id ...................... [RUN]
[0m00:19:44.366366 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_int_cashflow_enriched_cashflow_id.8460e9066d, now test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3)
[0m00:19:44.366706 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3
[0m00:19:44.370335 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3"
[0m00:19:44.370901 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3
[0m00:19:44.372876 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3"
[0m00:19:44.373632 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3"
[0m00:19:44.373887 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fund_id
from DBT_DEMO.DEV.int_irr_calculations
where fund_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3"} */
[0m00:19:44.580532 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m00:19:44.585332 [info ] [Thread-5 (]: 9 of 53 PASS not_null_fact_trade_activity_trade_id ............................. [[32mPASS[0m in 1.12s]
[0m00:19:44.586338 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45
[0m00:19:44.586740 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d
[0m00:19:44.587174 [info ] [Thread-5 (]: 15 of 53 START test not_null_int_irr_calculations_portfolio_id ................. [RUN]
[0m00:19:44.587680 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_fact_trade_activity_trade_id.6ec5fc5e45, now test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d)
[0m00:19:44.588038 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d
[0m00:19:44.592361 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d"
[0m00:19:44.593037 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d
[0m00:19:44.595241 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d"
[0m00:19:44.596035 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d"
[0m00:19:44.596294 [debug] [Thread-5 (]: On test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.int_irr_calculations
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d"} */
[0m00:19:44.921768 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m00:19:44.930363 [info ] [Thread-3 (]: 14 of 53 PASS not_null_int_irr_calculations_fund_id ............................ [[32mPASS[0m in 0.56s]
[0m00:19:44.930968 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3
[0m00:19:44.931384 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210
[0m00:19:44.931843 [info ] [Thread-3 (]: 16 of 53 START test not_null_int_portfolio_attribution_portfolio_id ............ [RUN]
[0m00:19:44.932269 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_int_irr_calculations_fund_id.35702f5be3, now test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210)
[0m00:19:44.932611 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210
[0m00:19:44.936461 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210"
[0m00:19:44.937040 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210
[0m00:19:44.939121 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210"
[0m00:19:44.939877 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210"
[0m00:19:44.940182 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.int_portfolio_attribution
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210"} */
[0m00:19:44.941875 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.212 seconds
[0m00:19:44.943539 [info ] [Thread-4 (]: 12 of 53 PASS not_null_int_daily_positions_position_id ......................... [[32mPASS[0m in 1.22s]
[0m00:19:44.944024 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6
[0m00:19:44.944439 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8
[0m00:19:44.944842 [info ] [Thread-4 (]: 17 of 53 START test not_null_int_trade_enriched_trade_id ....................... [RUN]
[0m00:19:44.945308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_int_daily_positions_position_id.198d23a5e6, now test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8)
[0m00:19:44.945595 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8
[0m00:19:44.948588 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8"
[0m00:19:44.949137 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8
[0m00:19:44.951028 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8"
[0m00:19:44.951752 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8"
[0m00:19:44.952003 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_id
from DBT_DEMO.DEV.int_trade_enriched
where trade_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8"} */
[0m00:19:45.212899 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m00:19:45.216256 [info ] [Thread-2 (]: 13 of 53 PASS not_null_int_fund_nav_fund_id .................................... [[32mPASS[0m in 0.99s]
[0m00:19:45.216910 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99
[0m00:19:45.217310 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a
[0m00:19:45.217784 [info ] [Thread-2 (]: 18 of 53 START test not_null_int_valuation_enriched_valuation_id ............... [RUN]
[0m00:19:45.218264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_int_fund_nav_fund_id.ebf0b6cc99, now test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a)
[0m00:19:45.218626 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a
[0m00:19:45.224474 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a"
[0m00:19:45.225463 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a
[0m00:19:45.228118 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a"
[0m00:19:45.229370 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a"
[0m00:19:45.229900 [debug] [Thread-2 (]: On test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valuation_id
from DBT_DEMO.DEV.int_valuation_enriched
where valuation_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a"} */
[0m00:19:45.417649 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m00:19:45.422056 [info ] [Thread-3 (]: 16 of 53 PASS not_null_int_portfolio_attribution_portfolio_id .................. [[32mPASS[0m in 0.49s]
[0m00:19:45.422580 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210
[0m00:19:45.422912 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b
[0m00:19:45.423290 [info ] [Thread-3 (]: 19 of 53 START test not_null_report_daily_pnl_portfolio_id ..................... [RUN]
[0m00:19:45.423722 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_int_portfolio_attribution_portfolio_id.3e04b7c210, now test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b)
[0m00:19:45.424039 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b
[0m00:19:45.427859 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b"
[0m00:19:45.428534 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b
[0m00:19:45.430455 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b"
[0m00:19:45.432787 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b"
[0m00:19:45.433076 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.report_daily_pnl
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b"} */
[0m00:19:45.534613 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.938 seconds
[0m00:19:45.537559 [info ] [Thread-5 (]: 15 of 53 PASS not_null_int_irr_calculations_portfolio_id ....................... [[32mPASS[0m in 0.95s]
[0m00:19:45.538175 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d
[0m00:19:45.538575 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84
[0m00:19:45.539083 [info ] [Thread-5 (]: 20 of 53 START test not_null_report_ic_dashboard_fund_id ....................... [RUN]
[0m00:19:45.540533 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_int_irr_calculations_portfolio_id.5530046e4d, now test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84)
[0m00:19:45.543976 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84
[0m00:19:45.548612 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84"
[0m00:19:45.552471 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84
[0m00:19:45.555583 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84"
[0m00:19:45.556666 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84"
[0m00:19:45.557089 [debug] [Thread-5 (]: On test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fund_id
from DBT_DEMO.DEV.report_ic_dashboard
where fund_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84"} */
[0m00:19:45.907229 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m00:19:45.910160 [info ] [Thread-2 (]: 18 of 53 PASS not_null_int_valuation_enriched_valuation_id ..................... [[32mPASS[0m in 0.69s]
[0m00:19:45.910784 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a
[0m00:19:45.911192 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583
[0m00:19:45.911668 [info ] [Thread-2 (]: 21 of 53 START test not_null_report_lp_quarterly_fund_id ....................... [RUN]
[0m00:19:45.912167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_int_valuation_enriched_valuation_id.048a7ba03a, now test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583)
[0m00:19:45.912531 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583
[0m00:19:45.918275 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583"
[0m00:19:45.919193 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583
[0m00:19:45.921708 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583"
[0m00:19:45.922606 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583"
[0m00:19:45.923173 [debug] [Thread-2 (]: On test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fund_id
from DBT_DEMO.DEV.report_lp_quarterly
where fund_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583"} */
[0m00:19:46.274852 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.323 seconds
[0m00:19:46.277226 [info ] [Thread-4 (]: 17 of 53 PASS not_null_int_trade_enriched_trade_id ............................. [[32mPASS[0m in 1.33s]
[0m00:19:46.277843 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8
[0m00:19:46.278229 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f
[0m00:19:46.278638 [info ] [Thread-4 (]: 22 of 53 START test not_null_report_portfolio_overview_portfolio_id ............ [RUN]
[0m00:19:46.279064 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_int_trade_enriched_trade_id.020f969dc8, now test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f)
[0m00:19:46.279393 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f
[0m00:19:46.283796 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f"
[0m00:19:46.285042 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m00:19:46.286641 [info ] [Thread-3 (]: 19 of 53 PASS not_null_report_daily_pnl_portfolio_id ........................... [[32mPASS[0m in 0.86s]
[0m00:19:46.287102 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b
[0m00:19:46.287380 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f
[0m00:19:46.287696 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e
[0m00:19:46.290268 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f"
[0m00:19:46.290552 [info ] [Thread-3 (]: 23 of 53 START test not_null_stg_benchmarks_benchmark_date ..................... [RUN]
[0m00:19:46.290917 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_report_daily_pnl_portfolio_id.37974cbf9b, now test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e)
[0m00:19:46.291179 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e
[0m00:19:46.294564 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e"
[0m00:19:46.295198 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f"
[0m00:19:46.295718 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.report_portfolio_overview
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f"} */
[0m00:19:46.296643 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e
[0m00:19:46.299284 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e"
[0m00:19:46.300475 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e"
[0m00:19:46.302414 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select benchmark_date
from DBT_DEMO.DEV.stg_benchmarks
where benchmark_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e"} */
[0m00:19:46.478970 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m00:19:46.482307 [info ] [Thread-2 (]: 21 of 53 PASS not_null_report_lp_quarterly_fund_id ............................. [[32mPASS[0m in 0.57s]
[0m00:19:46.483023 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583
[0m00:19:46.483424 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58
[0m00:19:46.483902 [info ] [Thread-2 (]: 24 of 53 START test not_null_stg_benchmarks_benchmark_id ....................... [RUN]
[0m00:19:46.484422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_report_lp_quarterly_fund_id.aa355f6583, now test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58)
[0m00:19:46.484789 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58
[0m00:19:46.490842 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58"
[0m00:19:46.491862 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58
[0m00:19:46.494851 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58"
[0m00:19:46.496064 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58"
[0m00:19:46.496570 [debug] [Thread-2 (]: On test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select benchmark_id
from DBT_DEMO.DEV.stg_benchmarks
where benchmark_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58"} */
[0m00:19:46.809166 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m00:19:46.812213 [info ] [Thread-3 (]: 23 of 53 PASS not_null_stg_benchmarks_benchmark_date ........................... [[32mPASS[0m in 0.52s]
[0m00:19:46.812919 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e
[0m00:19:46.813344 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898
[0m00:19:46.813766 [info ] [Thread-3 (]: 25 of 53 START test not_null_stg_cashflows_cashflow_id ......................... [RUN]
[0m00:19:46.814203 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_date.d5c8f88f3e, now test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898)
[0m00:19:46.814529 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898
[0m00:19:46.819905 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898"
[0m00:19:46.820987 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898
[0m00:19:46.824697 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898"
[0m00:19:46.826139 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898"
[0m00:19:46.826479 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cashflow_id
from DBT_DEMO.DEV.stg_cashflows
where cashflow_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898"} */
[0m00:19:46.870880 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m00:19:46.873468 [info ] [Thread-4 (]: 22 of 53 PASS not_null_report_portfolio_overview_portfolio_id .................. [[32mPASS[0m in 0.59s]
[0m00:19:46.874099 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f
[0m00:19:46.874467 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde
[0m00:19:46.874880 [info ] [Thread-4 (]: 26 of 53 START test not_null_stg_cashflows_fund_id ............................. [RUN]
[0m00:19:46.875347 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_report_portfolio_overview_portfolio_id.4930122a4f, now test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde)
[0m00:19:46.875670 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde
[0m00:19:46.879463 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde"
[0m00:19:46.880272 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde
[0m00:19:46.882644 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde"
[0m00:19:46.883396 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde"
[0m00:19:46.883684 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fund_id
from DBT_DEMO.DEV.stg_cashflows
where fund_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde"} */
[0m00:19:46.972891 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m00:19:46.976602 [info ] [Thread-2 (]: 24 of 53 PASS not_null_stg_benchmarks_benchmark_id ............................. [[32mPASS[0m in 0.49s]
[0m00:19:46.977379 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58
[0m00:19:46.977798 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57
[0m00:19:46.978202 [info ] [Thread-2 (]: 27 of 53 START test not_null_stg_cashflows_portfolio_id ........................ [RUN]
[0m00:19:46.978605 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_benchmarks_benchmark_id.ec87e4ee58, now test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57)
[0m00:19:46.978914 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57
[0m00:19:46.984429 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57"
[0m00:19:46.985392 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57
[0m00:19:46.988117 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57"
[0m00:19:46.989088 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57"
[0m00:19:46.992045 [debug] [Thread-2 (]: On test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.stg_cashflows
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57"} */
[0m00:19:47.057844 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m00:19:47.061014 [info ] [Thread-3 (]: 25 of 53 PASS not_null_stg_cashflows_cashflow_id ............................... [[32mPASS[0m in 0.25s]
[0m00:19:47.061691 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898
[0m00:19:47.062124 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940
[0m00:19:47.062582 [info ] [Thread-3 (]: 28 of 53 START test not_null_stg_counterparties_counterparty_id ................ [RUN]
[0m00:19:47.063074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_cashflows_cashflow_id.4176024898, now test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940)
[0m00:19:47.063447 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940
[0m00:19:47.069458 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940"
[0m00:19:47.070429 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940
[0m00:19:47.073160 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940"
[0m00:19:47.074315 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940"
[0m00:19:47.074693 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select counterparty_id
from DBT_DEMO.DEV.stg_counterparties
where counterparty_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940"} */
[0m00:19:47.092244 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m00:19:47.094309 [info ] [Thread-4 (]: 26 of 53 PASS not_null_stg_cashflows_fund_id ................................... [[32mPASS[0m in 0.22s]
[0m00:19:47.094870 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde
[0m00:19:47.095249 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188
[0m00:19:47.095649 [info ] [Thread-4 (]: 29 of 53 START test not_null_stg_dates_date_day ................................ [RUN]
[0m00:19:47.096027 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_cashflows_fund_id.7ff8a45dde, now test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188)
[0m00:19:47.096353 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188
[0m00:19:47.100102 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188"
[0m00:19:47.100715 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188
[0m00:19:47.102525 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188"
[0m00:19:47.103236 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188"
[0m00:19:47.103492 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from DBT_DEMO.DEV.stg_dates
where date_day is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188"} */
[0m00:19:47.236428 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m00:19:47.240279 [info ] [Thread-2 (]: 27 of 53 PASS not_null_stg_cashflows_portfolio_id .............................. [[32mPASS[0m in 0.26s]
[0m00:19:47.240969 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57
[0m00:19:47.241390 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31
[0m00:19:47.241843 [info ] [Thread-2 (]: 30 of 53 START test not_null_stg_fund_structures_fund_id ....................... [RUN]
[0m00:19:47.242339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_cashflows_portfolio_id.cbd1d93e57, now test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31)
[0m00:19:47.242747 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31
[0m00:19:47.248436 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31"
[0m00:19:47.249411 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31
[0m00:19:47.252260 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31"
[0m00:19:47.253367 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31"
[0m00:19:47.253750 [debug] [Thread-2 (]: On test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fund_id
from DBT_DEMO.DEV.stg_fund_structures
where fund_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31"} */
[0m00:19:47.318556 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m00:19:47.321656 [info ] [Thread-3 (]: 28 of 53 PASS not_null_stg_counterparties_counterparty_id ...................... [[32mPASS[0m in 0.26s]
[0m00:19:47.322515 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940
[0m00:19:47.323124 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe
[0m00:19:47.323734 [info ] [Thread-3 (]: 31 of 53 START test not_null_stg_instruments_instrument_id ..................... [RUN]
[0m00:19:47.324583 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_counterparties_counterparty_id.4754302940, now test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe)
[0m00:19:47.324969 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe
[0m00:19:47.330332 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe"
[0m00:19:47.331160 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe
[0m00:19:47.333945 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe"
[0m00:19:47.334939 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe"
[0m00:19:47.335249 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select instrument_id
from DBT_DEMO.DEV.stg_instruments
where instrument_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe"} */
[0m00:19:47.410625 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.853 seconds
[0m00:19:47.412408 [info ] [Thread-5 (]: 20 of 53 PASS not_null_report_ic_dashboard_fund_id ............................. [[32mPASS[0m in 1.87s]
[0m00:19:47.416981 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84
[0m00:19:47.415718 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m00:19:47.417571 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd
[0m00:19:47.423748 [info ] [Thread-5 (]: 32 of 53 START test not_null_stg_portfolios_fund_id ............................ [RUN]
[0m00:19:47.424221 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_report_ic_dashboard_fund_id.e430aafd84, now test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd)
[0m00:19:47.424562 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd
[0m00:19:47.420822 [info ] [Thread-4 (]: 29 of 53 PASS not_null_stg_dates_date_day ...................................... [[32mPASS[0m in 0.32s]
[0m00:19:47.430918 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd"
[0m00:19:47.431726 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188
[0m00:19:47.432258 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec
[0m00:19:47.432633 [info ] [Thread-4 (]: 33 of 53 START test not_null_stg_portfolios_portfolio_id ....................... [RUN]
[0m00:19:47.433087 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_dates_date_day.f3ec4da188, now test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec)
[0m00:19:47.433590 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd
[0m00:19:47.433843 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec
[0m00:19:47.437009 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd"
[0m00:19:47.440461 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec"
[0m00:19:47.441107 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec
[0m00:19:47.443184 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec"
[0m00:19:47.443746 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd"
[0m00:19:47.444075 [debug] [Thread-5 (]: On test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fund_id
from DBT_DEMO.DEV.stg_portfolios
where fund_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd"} */
[0m00:19:47.444904 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec"
[0m00:19:47.445245 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.stg_portfolios
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec"} */
[0m00:19:47.572931 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m00:19:47.575355 [info ] [Thread-3 (]: 31 of 53 PASS not_null_stg_instruments_instrument_id ........................... [[32mPASS[0m in 0.25s]
[0m00:19:47.575907 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe
[0m00:19:47.576200 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c
[0m00:19:47.576500 [info ] [Thread-3 (]: 34 of 53 START test not_null_stg_positions_portfolio_id ........................ [RUN]
[0m00:19:47.576881 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_instruments_instrument_id.18bdfd2ebe, now test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c)
[0m00:19:47.577204 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c
[0m00:19:47.581359 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c"
[0m00:19:47.582075 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c
[0m00:19:47.584390 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c"
[0m00:19:47.585146 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c"
[0m00:19:47.585417 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.stg_positions
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c"} */
[0m00:19:47.677868 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m00:19:47.679689 [info ] [Thread-5 (]: 32 of 53 PASS not_null_stg_portfolios_fund_id .................................. [[32mPASS[0m in 0.26s]
[0m00:19:47.680652 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd
[0m00:19:47.681180 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1
[0m00:19:47.681754 [info ] [Thread-5 (]: 35 of 53 START test not_null_stg_positions_position_id ......................... [RUN]
[0m00:19:47.683037 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_portfolios_fund_id.70b04d82bd, now test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1)
[0m00:19:47.684329 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m00:19:47.684780 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1
[0m00:19:47.687086 [info ] [Thread-4 (]: 33 of 53 PASS not_null_stg_portfolios_portfolio_id ............................. [[32mPASS[0m in 0.25s]
[0m00:19:47.692804 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1"
[0m00:19:47.693563 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec
[0m00:19:47.694129 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72
[0m00:19:47.694660 [info ] [Thread-4 (]: 36 of 53 START test not_null_stg_trades_instrument_id .......................... [RUN]
[0m00:19:47.695123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_portfolios_portfolio_id.7126a480ec, now test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72)
[0m00:19:47.695437 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1
[0m00:19:47.695752 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72
[0m00:19:47.698577 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1"
[0m00:19:47.703859 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72"
[0m00:19:47.704734 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1"
[0m00:19:47.705015 [debug] [Thread-5 (]: On test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select position_id
from DBT_DEMO.DEV.stg_positions
where position_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1"} */
[0m00:19:47.705675 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72
[0m00:19:47.707819 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72"
[0m00:19:47.708787 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72"
[0m00:19:47.709073 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select instrument_id
from DBT_DEMO.DEV.stg_trades
where instrument_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72"} */
[0m00:19:47.721852 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m00:19:47.723223 [info ] [Thread-2 (]: 30 of 53 PASS not_null_stg_fund_structures_fund_id ............................. [[32mPASS[0m in 0.48s]
[0m00:19:47.723586 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31
[0m00:19:47.723841 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b
[0m00:19:47.724099 [info ] [Thread-2 (]: 37 of 53 START test not_null_stg_trades_portfolio_id ........................... [RUN]
[0m00:19:47.724358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_fund_structures_fund_id.a284274f31, now test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b)
[0m00:19:47.724585 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b
[0m00:19:47.727372 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b"
[0m00:19:47.727802 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b
[0m00:19:47.729509 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b"
[0m00:19:47.730117 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b"
[0m00:19:47.730362 [debug] [Thread-2 (]: On test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.stg_trades
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b"} */
[0m00:19:47.928802 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m00:19:47.931830 [info ] [Thread-5 (]: 35 of 53 PASS not_null_stg_positions_position_id ............................... [[32mPASS[0m in 0.25s]
[0m00:19:47.932618 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1
[0m00:19:47.933087 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b
[0m00:19:47.933553 [info ] [Thread-5 (]: 38 of 53 START test not_null_stg_trades_trade_id ............................... [RUN]
[0m00:19:47.933985 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_positions_position_id.931382b0a1, now test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b)
[0m00:19:47.934359 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b
[0m00:19:47.938376 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b"
[0m00:19:47.939136 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b
[0m00:19:47.941792 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b"
[0m00:19:47.942603 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b"
[0m00:19:47.942868 [debug] [Thread-5 (]: On test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trade_id
from DBT_DEMO.DEV.stg_trades
where trade_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b"} */
[0m00:19:47.961012 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m00:19:47.962846 [info ] [Thread-4 (]: 36 of 53 PASS not_null_stg_trades_instrument_id ................................ [[32mPASS[0m in 0.27s]
[0m00:19:47.963321 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72
[0m00:19:47.963633 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188
[0m00:19:47.963987 [info ] [Thread-4 (]: 39 of 53 START test not_null_stg_valuations_portfolio_id ....................... [RUN]
[0m00:19:47.964373 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_trades_instrument_id.15cdc65a72, now test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188)
[0m00:19:47.964660 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188
[0m00:19:47.968722 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188"
[0m00:19:47.969649 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188
[0m00:19:47.971627 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188"
[0m00:19:47.972358 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188"
[0m00:19:47.974264 [debug] [Thread-4 (]: On test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select portfolio_id
from DBT_DEMO.DEV.stg_valuations
where portfolio_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188"} */
[0m00:19:47.986578 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m00:19:47.988199 [info ] [Thread-3 (]: 34 of 53 PASS not_null_stg_positions_portfolio_id .............................. [[32mPASS[0m in 0.41s]
[0m00:19:47.988672 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c
[0m00:19:47.988985 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d
[0m00:19:47.989339 [info ] [Thread-3 (]: 40 of 53 START test not_null_stg_valuations_valuation_id ....................... [RUN]
[0m00:19:47.989742 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_positions_portfolio_id.281f76311c, now test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d)
[0m00:19:47.989987 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d
[0m00:19:47.993260 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d"
[0m00:19:47.993833 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d
[0m00:19:47.995650 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d"
[0m00:19:47.996328 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d"
[0m00:19:47.996577 [debug] [Thread-3 (]: On test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valuation_id
from DBT_DEMO.DEV.stg_valuations
where valuation_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d"} */
[0m00:19:48.093546 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m00:19:48.096881 [info ] [Thread-2 (]: 37 of 53 PASS not_null_stg_trades_portfolio_id ................................. [[32mPASS[0m in 0.37s]
[0m00:19:48.097567 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b
[0m00:19:48.097994 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709
[0m00:19:48.098477 [info ] [Thread-2 (]: 41 of 53 START test relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_  [RUN]
[0m00:19:48.098995 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_trades_portfolio_id.2becbd2a0b, now test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709)
[0m00:19:48.099382 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709
[0m00:19:48.108693 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709"
[0m00:19:48.109608 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709
[0m00:19:48.112542 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709"
[0m00:19:48.113920 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709"
[0m00:19:48.114267 [debug] [Thread-2 (]: On test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select portfolio_id as from_field
    from DBT_DEMO.DEV.stg_positions
    where portfolio_id is not null
),

parent as (
    select portfolio_id as to_field
    from DBT_DEMO.DEV.stg_portfolios
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709"} */
[0m00:19:48.169081 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.226 seconds
[0m00:19:48.171221 [info ] [Thread-5 (]: 38 of 53 PASS not_null_stg_trades_trade_id ..................................... [[32mPASS[0m in 0.24s]
[0m00:19:48.171719 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b
[0m00:19:48.172032 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00
[0m00:19:48.172385 [info ] [Thread-5 (]: 42 of 53 START test unique_fact_trade_activity_trade_id ........................ [RUN]
[0m00:19:48.172783 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_trades_trade_id.f81937320b, now test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00)
[0m00:19:48.173076 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00
[0m00:19:48.178472 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00"
[0m00:19:48.179136 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00
[0m00:19:48.181074 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00"
[0m00:19:48.181853 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00"
[0m00:19:48.182115 [debug] [Thread-5 (]: On test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trade_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.fact_trade_activity
where trade_id is not null
group by trade_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00"} */
[0m00:19:48.219456 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m00:19:48.221094 [info ] [Thread-4 (]: 39 of 53 PASS not_null_stg_valuations_portfolio_id ............................. [[32mPASS[0m in 0.26s]
[0m00:19:48.221539 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188
[0m00:19:48.221853 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17
[0m00:19:48.222185 [info ] [Thread-4 (]: 43 of 53 START test unique_int_cashflow_enriched_cashflow_id ................... [RUN]
[0m00:19:48.222530 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_valuations_portfolio_id.d5af3e5188, now test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17)
[0m00:19:48.222808 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17
[0m00:19:48.226043 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17"
[0m00:19:48.226562 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17
[0m00:19:48.230147 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17"
[0m00:19:48.230980 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17"
[0m00:19:48.231245 [debug] [Thread-4 (]: On test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cashflow_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.int_cashflow_enriched
where cashflow_id is not null
group by cashflow_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17"} */
[0m00:19:48.273603 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.277 seconds
[0m00:19:48.275169 [info ] [Thread-3 (]: 40 of 53 PASS not_null_stg_valuations_valuation_id ............................. [[32mPASS[0m in 0.29s]
[0m00:19:48.275587 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d
[0m00:19:48.275883 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a
[0m00:19:48.276158 [info ] [Thread-3 (]: 44 of 53 START test unique_int_trade_enriched_trade_id ......................... [RUN]
[0m00:19:48.276535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.not_null_stg_valuations_valuation_id.88ca70781d, now test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a)
[0m00:19:48.276818 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a
[0m00:19:48.280169 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a"
[0m00:19:48.280709 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a
[0m00:19:48.282500 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a"
[0m00:19:48.283223 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a"
[0m00:19:48.283480 [debug] [Thread-3 (]: On test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trade_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.int_trade_enriched
where trade_id is not null
group by trade_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a"} */
[0m00:19:48.409672 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m00:19:48.413123 [info ] [Thread-2 (]: 41 of 53 PASS relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_  [[32mPASS[0m in 0.31s]
[0m00:19:48.413838 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709
[0m00:19:48.414274 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704
[0m00:19:48.414751 [info ] [Thread-2 (]: 45 of 53 START test unique_stg_cashflows_cashflow_id ........................... [RUN]
[0m00:19:48.415256 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.relationships_stg_positions_portfolio_id__portfolio_id__ref_stg_portfolios_.2823f12709, now test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704)
[0m00:19:48.415675 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704
[0m00:19:48.421496 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704"
[0m00:19:48.422442 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704
[0m00:19:48.425063 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704"
[0m00:19:48.426213 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704"
[0m00:19:48.426631 [debug] [Thread-2 (]: On test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cashflow_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.stg_cashflows
where cashflow_id is not null
group by cashflow_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704"} */
[0m00:19:48.989605 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m00:19:48.992380 [info ] [Thread-2 (]: 45 of 53 PASS unique_stg_cashflows_cashflow_id ................................. [[32mPASS[0m in 0.58s]
[0m00:19:48.993101 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704
[0m00:19:48.993489 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057
[0m00:19:48.993930 [info ] [Thread-2 (]: 46 of 53 START test unique_stg_counterparties_counterparty_id .................. [RUN]
[0m00:19:48.994391 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.unique_stg_cashflows_cashflow_id.359e4f4704, now test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057)
[0m00:19:48.994741 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057
[0m00:19:48.999858 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057"
[0m00:19:49.000927 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057
[0m00:19:49.003819 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057"
[0m00:19:49.005457 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m00:19:49.006200 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057"
[0m00:19:49.008314 [info ] [Thread-4 (]: 43 of 53 PASS unique_int_cashflow_enriched_cashflow_id ......................... [[32mPASS[0m in 0.79s]
[0m00:19:49.008918 [debug] [Thread-2 (]: On test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    counterparty_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.stg_counterparties
where counterparty_id is not null
group by counterparty_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057"} */
[0m00:19:49.009394 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17
[0m00:19:49.010127 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28
[0m00:19:49.010659 [info ] [Thread-4 (]: 47 of 53 START test unique_stg_dates_date_day .................................. [RUN]
[0m00:19:49.011326 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.unique_int_cashflow_enriched_cashflow_id.6944893c17, now test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28)
[0m00:19:49.012209 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28
[0m00:19:49.016111 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28"
[0m00:19:49.017064 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28
[0m00:19:49.019041 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28"
[0m00:19:49.019928 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28"
[0m00:19:49.020207 [debug] [Thread-4 (]: On test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.stg_dates
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28"} */
[0m00:19:49.046166 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.864 seconds
[0m00:19:49.047776 [info ] [Thread-5 (]: 42 of 53 PASS unique_fact_trade_activity_trade_id .............................. [[32mPASS[0m in 0.87s]
[0m00:19:49.048203 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00
[0m00:19:49.048488 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab
[0m00:19:49.048791 [info ] [Thread-5 (]: 48 of 53 START test unique_stg_fund_structures_fund_id ......................... [RUN]
[0m00:19:49.049074 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.unique_fact_trade_activity_trade_id.e03d2f9a00, now test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab)
[0m00:19:49.049308 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab
[0m00:19:49.052408 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab"
[0m00:19:49.053003 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab
[0m00:19:49.054795 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab"
[0m00:19:49.055525 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab"
[0m00:19:49.055777 [debug] [Thread-5 (]: On test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    fund_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.stg_fund_structures
where fund_id is not null
group by fund_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab"} */
[0m00:19:49.257013 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m00:19:49.260825 [info ] [Thread-4 (]: 47 of 53 PASS unique_stg_dates_date_day ........................................ [[32mPASS[0m in 0.25s]
[0m00:19:49.261506 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28
[0m00:19:49.261916 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34
[0m00:19:49.262389 [info ] [Thread-4 (]: 49 of 53 START test unique_stg_instruments_instrument_id ....................... [RUN]
[0m00:19:49.262880 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.unique_stg_dates_date_day.e062be8e28, now test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34)
[0m00:19:49.263246 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34
[0m00:19:49.268873 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34"
[0m00:19:49.269826 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34
[0m00:19:49.272398 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34"
[0m00:19:49.273543 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34"
[0m00:19:49.274086 [debug] [Thread-4 (]: On test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    instrument_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.stg_instruments
where instrument_id is not null
group by instrument_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34"} */
[0m00:19:49.347987 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m00:19:49.352232 [info ] [Thread-2 (]: 46 of 53 PASS unique_stg_counterparties_counterparty_id ........................ [[32mPASS[0m in 0.36s]
[0m00:19:49.352959 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057
[0m00:19:49.353386 [debug] [Thread-2 (]: Began running node test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658
[0m00:19:49.353857 [info ] [Thread-2 (]: 50 of 53 START test unique_stg_portfolios_portfolio_id ......................... [RUN]
[0m00:19:49.354367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.unique_stg_counterparties_counterparty_id.d712ebd057, now test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658)
[0m00:19:49.354740 [debug] [Thread-2 (]: Began compiling node test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658
[0m00:19:49.360897 [debug] [Thread-2 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658"
[0m00:19:49.362315 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m00:19:49.364545 [info ] [Thread-5 (]: 48 of 53 PASS unique_stg_fund_structures_fund_id ............................... [[32mPASS[0m in 0.32s]
[0m00:19:49.365065 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab
[0m00:19:49.365390 [debug] [Thread-5 (]: Began running node test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f
[0m00:19:49.365823 [debug] [Thread-2 (]: Began executing node test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658
[0m00:19:49.366253 [info ] [Thread-5 (]: 51 of 53 START test unique_stg_positions_position_id ........................... [RUN]
[0m00:19:49.369345 [debug] [Thread-2 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658"
[0m00:19:49.369760 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.unique_stg_fund_structures_fund_id.bb9fec42ab, now test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f)
[0m00:19:49.370164 [debug] [Thread-5 (]: Began compiling node test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f
[0m00:19:49.373730 [debug] [Thread-5 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f"
[0m00:19:49.374409 [debug] [Thread-2 (]: Using snowflake connection "test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658"
[0m00:19:49.374712 [debug] [Thread-2 (]: On test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    portfolio_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.stg_portfolios
where portfolio_id is not null
group by portfolio_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658"} */
[0m00:19:49.375049 [debug] [Thread-5 (]: Began executing node test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f
[0m00:19:49.377012 [debug] [Thread-5 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f"
[0m00:19:49.378220 [debug] [Thread-5 (]: Using snowflake connection "test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f"
[0m00:19:49.378575 [debug] [Thread-5 (]: On test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    position_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.stg_positions
where position_id is not null
group by position_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f"} */
[0m00:19:49.512851 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.229 seconds
[0m00:19:49.515872 [info ] [Thread-3 (]: 44 of 53 PASS unique_int_trade_enriched_trade_id ............................... [[32mPASS[0m in 1.24s]
[0m00:19:49.516576 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a
[0m00:19:49.517001 [debug] [Thread-3 (]: Began running node test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd
[0m00:19:49.517427 [info ] [Thread-3 (]: 52 of 53 START test unique_stg_trades_trade_id ................................. [RUN]
[0m00:19:49.517874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.unique_int_trade_enriched_trade_id.9cdb3dc82a, now test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd)
[0m00:19:49.518189 [debug] [Thread-3 (]: Began compiling node test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd
[0m00:19:49.590637 [debug] [Thread-3 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd"
[0m00:19:49.591317 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.317 seconds
[0m00:19:49.592558 [info ] [Thread-4 (]: 49 of 53 PASS unique_stg_instruments_instrument_id ............................. [[32mPASS[0m in 0.33s]
[0m00:19:49.592983 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34
[0m00:19:49.593247 [debug] [Thread-4 (]: Began running node test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5
[0m00:19:49.593471 [debug] [Thread-3 (]: Began executing node test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd
[0m00:19:49.593752 [info ] [Thread-4 (]: 53 of 53 START test unique_stg_valuations_valuation_id ......................... [RUN]
[0m00:19:49.595656 [debug] [Thread-3 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd"
[0m00:19:49.595920 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.bain_capital_analytics.unique_stg_instruments_instrument_id.0e70adcd34, now test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5)
[0m00:19:49.596215 [debug] [Thread-4 (]: Began compiling node test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5
[0m00:19:49.598883 [debug] [Thread-4 (]: Writing injected SQL for node "test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5"
[0m00:19:49.599507 [debug] [Thread-3 (]: Using snowflake connection "test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd"
[0m00:19:49.599805 [debug] [Thread-3 (]: On test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trade_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.stg_trades
where trade_id is not null
group by trade_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd"} */
[0m00:19:49.600109 [debug] [Thread-4 (]: Began executing node test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5
[0m00:19:49.602124 [debug] [Thread-4 (]: Writing runtime sql for node "test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5"
[0m00:19:49.603157 [debug] [Thread-4 (]: Using snowflake connection "test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5"
[0m00:19:49.603520 [debug] [Thread-4 (]: On test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    valuation_id as unique_field,
    count(*) as n_records

from DBT_DEMO.DEV.stg_valuations
where valuation_id is not null
group by valuation_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "bain_capital_analytics", "target_name": "dev", "node_id": "test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5"} */
[0m00:19:49.659064 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m00:19:49.660289 [info ] [Thread-5 (]: 51 of 53 PASS unique_stg_positions_position_id ................................. [[32mPASS[0m in 0.29s]
[0m00:19:49.660649 [debug] [Thread-5 (]: Finished running node test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f
[0m00:19:49.695530 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m00:19:49.696631 [info ] [Thread-2 (]: 50 of 53 PASS unique_stg_portfolios_portfolio_id ............................... [[32mPASS[0m in 0.34s]
[0m00:19:49.696981 [debug] [Thread-2 (]: Finished running node test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658
[0m00:19:49.888133 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m00:19:49.891701 [info ] [Thread-3 (]: 52 of 53 PASS unique_stg_trades_trade_id ....................................... [[32mPASS[0m in 0.37s]
[0m00:19:49.892492 [debug] [Thread-3 (]: Finished running node test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd
[0m00:19:50.027830 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m00:19:50.030822 [info ] [Thread-4 (]: 53 of 53 PASS unique_stg_valuations_valuation_id ............................... [[32mPASS[0m in 0.43s]
[0m00:19:50.031458 [debug] [Thread-4 (]: Finished running node test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5
[0m00:19:50.033433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:50.033759 [debug] [MainThread]: Connection 'test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658' was left open.
[0m00:19:50.034058 [debug] [MainThread]: On test.bain_capital_analytics.unique_stg_portfolios_portfolio_id.aa125b6658: Close
[0m00:19:50.338271 [debug] [MainThread]: Connection 'test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd' was left open.
[0m00:19:50.339046 [debug] [MainThread]: On test.bain_capital_analytics.unique_stg_trades_trade_id.f973ed6ffd: Close
[0m00:19:50.643670 [debug] [MainThread]: Connection 'test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5' was left open.
[0m00:19:50.644552 [debug] [MainThread]: On test.bain_capital_analytics.unique_stg_valuations_valuation_id.fce7eb13b5: Close
[0m00:19:50.941820 [debug] [MainThread]: Connection 'test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f' was left open.
[0m00:19:50.943122 [debug] [MainThread]: On test.bain_capital_analytics.unique_stg_positions_position_id.b28d4a237f: Close
[0m00:19:51.254053 [info ] [MainThread]: 
[0m00:19:51.254929 [info ] [MainThread]: Finished running 53 data tests in 0 hours 0 minutes and 13.15 seconds (13.15s).
[0m00:19:51.261574 [debug] [MainThread]: Command end result
[0m00:19:51.302554 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m00:19:51.304210 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m00:19:51.310431 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m00:19:51.310690 [info ] [MainThread]: 
[0m00:19:51.310959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:19:51.311215 [info ] [MainThread]: 
[0m00:19:51.311435 [info ] [MainThread]: Done. PASS=53 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=53
[0m00:19:51.313702 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.181544, "process_in_blocks": "0", "process_kernel_time": 0.456473, "process_mem_max_rss": "177553408", "process_out_blocks": "0", "process_user_time": 3.251517}
[0m00:19:51.314007 [debug] [MainThread]: Command `dbt test` succeeded at 00:19:51.313951 after 14.18 seconds
[0m00:19:51.314274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d578150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1bf350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048863d0>]}
[0m00:19:51.314542 [debug] [MainThread]: Flushing usage events
[0m00:19:52.220243 [debug] [MainThread]: An error was encountered while trying to flush usage events
